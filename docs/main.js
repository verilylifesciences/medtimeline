(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["main"],{

/***/ "./node_modules/moment/locale sync recursive ^\\.\\/.*$":
/*!**************************************************!*\
  !*** ./node_modules/moment/locale sync ^\.\/.*$ ***!
  \**************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var map = {
	"./af": "./node_modules/moment/locale/af.js",
	"./af.js": "./node_modules/moment/locale/af.js",
	"./ar": "./node_modules/moment/locale/ar.js",
	"./ar-dz": "./node_modules/moment/locale/ar-dz.js",
	"./ar-dz.js": "./node_modules/moment/locale/ar-dz.js",
	"./ar-kw": "./node_modules/moment/locale/ar-kw.js",
	"./ar-kw.js": "./node_modules/moment/locale/ar-kw.js",
	"./ar-ly": "./node_modules/moment/locale/ar-ly.js",
	"./ar-ly.js": "./node_modules/moment/locale/ar-ly.js",
	"./ar-ma": "./node_modules/moment/locale/ar-ma.js",
	"./ar-ma.js": "./node_modules/moment/locale/ar-ma.js",
	"./ar-sa": "./node_modules/moment/locale/ar-sa.js",
	"./ar-sa.js": "./node_modules/moment/locale/ar-sa.js",
	"./ar-tn": "./node_modules/moment/locale/ar-tn.js",
	"./ar-tn.js": "./node_modules/moment/locale/ar-tn.js",
	"./ar.js": "./node_modules/moment/locale/ar.js",
	"./az": "./node_modules/moment/locale/az.js",
	"./az.js": "./node_modules/moment/locale/az.js",
	"./be": "./node_modules/moment/locale/be.js",
	"./be.js": "./node_modules/moment/locale/be.js",
	"./bg": "./node_modules/moment/locale/bg.js",
	"./bg.js": "./node_modules/moment/locale/bg.js",
	"./bm": "./node_modules/moment/locale/bm.js",
	"./bm.js": "./node_modules/moment/locale/bm.js",
	"./bn": "./node_modules/moment/locale/bn.js",
	"./bn.js": "./node_modules/moment/locale/bn.js",
	"./bo": "./node_modules/moment/locale/bo.js",
	"./bo.js": "./node_modules/moment/locale/bo.js",
	"./br": "./node_modules/moment/locale/br.js",
	"./br.js": "./node_modules/moment/locale/br.js",
	"./bs": "./node_modules/moment/locale/bs.js",
	"./bs.js": "./node_modules/moment/locale/bs.js",
	"./ca": "./node_modules/moment/locale/ca.js",
	"./ca.js": "./node_modules/moment/locale/ca.js",
	"./cs": "./node_modules/moment/locale/cs.js",
	"./cs.js": "./node_modules/moment/locale/cs.js",
	"./cv": "./node_modules/moment/locale/cv.js",
	"./cv.js": "./node_modules/moment/locale/cv.js",
	"./cy": "./node_modules/moment/locale/cy.js",
	"./cy.js": "./node_modules/moment/locale/cy.js",
	"./da": "./node_modules/moment/locale/da.js",
	"./da.js": "./node_modules/moment/locale/da.js",
	"./de": "./node_modules/moment/locale/de.js",
	"./de-at": "./node_modules/moment/locale/de-at.js",
	"./de-at.js": "./node_modules/moment/locale/de-at.js",
	"./de-ch": "./node_modules/moment/locale/de-ch.js",
	"./de-ch.js": "./node_modules/moment/locale/de-ch.js",
	"./de.js": "./node_modules/moment/locale/de.js",
	"./dv": "./node_modules/moment/locale/dv.js",
	"./dv.js": "./node_modules/moment/locale/dv.js",
	"./el": "./node_modules/moment/locale/el.js",
	"./el.js": "./node_modules/moment/locale/el.js",
	"./en-au": "./node_modules/moment/locale/en-au.js",
	"./en-au.js": "./node_modules/moment/locale/en-au.js",
	"./en-ca": "./node_modules/moment/locale/en-ca.js",
	"./en-ca.js": "./node_modules/moment/locale/en-ca.js",
	"./en-gb": "./node_modules/moment/locale/en-gb.js",
	"./en-gb.js": "./node_modules/moment/locale/en-gb.js",
	"./en-ie": "./node_modules/moment/locale/en-ie.js",
	"./en-ie.js": "./node_modules/moment/locale/en-ie.js",
	"./en-il": "./node_modules/moment/locale/en-il.js",
	"./en-il.js": "./node_modules/moment/locale/en-il.js",
	"./en-nz": "./node_modules/moment/locale/en-nz.js",
	"./en-nz.js": "./node_modules/moment/locale/en-nz.js",
	"./eo": "./node_modules/moment/locale/eo.js",
	"./eo.js": "./node_modules/moment/locale/eo.js",
	"./es": "./node_modules/moment/locale/es.js",
	"./es-do": "./node_modules/moment/locale/es-do.js",
	"./es-do.js": "./node_modules/moment/locale/es-do.js",
	"./es-us": "./node_modules/moment/locale/es-us.js",
	"./es-us.js": "./node_modules/moment/locale/es-us.js",
	"./es.js": "./node_modules/moment/locale/es.js",
	"./et": "./node_modules/moment/locale/et.js",
	"./et.js": "./node_modules/moment/locale/et.js",
	"./eu": "./node_modules/moment/locale/eu.js",
	"./eu.js": "./node_modules/moment/locale/eu.js",
	"./fa": "./node_modules/moment/locale/fa.js",
	"./fa.js": "./node_modules/moment/locale/fa.js",
	"./fi": "./node_modules/moment/locale/fi.js",
	"./fi.js": "./node_modules/moment/locale/fi.js",
	"./fo": "./node_modules/moment/locale/fo.js",
	"./fo.js": "./node_modules/moment/locale/fo.js",
	"./fr": "./node_modules/moment/locale/fr.js",
	"./fr-ca": "./node_modules/moment/locale/fr-ca.js",
	"./fr-ca.js": "./node_modules/moment/locale/fr-ca.js",
	"./fr-ch": "./node_modules/moment/locale/fr-ch.js",
	"./fr-ch.js": "./node_modules/moment/locale/fr-ch.js",
	"./fr.js": "./node_modules/moment/locale/fr.js",
	"./fy": "./node_modules/moment/locale/fy.js",
	"./fy.js": "./node_modules/moment/locale/fy.js",
	"./gd": "./node_modules/moment/locale/gd.js",
	"./gd.js": "./node_modules/moment/locale/gd.js",
	"./gl": "./node_modules/moment/locale/gl.js",
	"./gl.js": "./node_modules/moment/locale/gl.js",
	"./gom-latn": "./node_modules/moment/locale/gom-latn.js",
	"./gom-latn.js": "./node_modules/moment/locale/gom-latn.js",
	"./gu": "./node_modules/moment/locale/gu.js",
	"./gu.js": "./node_modules/moment/locale/gu.js",
	"./he": "./node_modules/moment/locale/he.js",
	"./he.js": "./node_modules/moment/locale/he.js",
	"./hi": "./node_modules/moment/locale/hi.js",
	"./hi.js": "./node_modules/moment/locale/hi.js",
	"./hr": "./node_modules/moment/locale/hr.js",
	"./hr.js": "./node_modules/moment/locale/hr.js",
	"./hu": "./node_modules/moment/locale/hu.js",
	"./hu.js": "./node_modules/moment/locale/hu.js",
	"./hy-am": "./node_modules/moment/locale/hy-am.js",
	"./hy-am.js": "./node_modules/moment/locale/hy-am.js",
	"./id": "./node_modules/moment/locale/id.js",
	"./id.js": "./node_modules/moment/locale/id.js",
	"./is": "./node_modules/moment/locale/is.js",
	"./is.js": "./node_modules/moment/locale/is.js",
	"./it": "./node_modules/moment/locale/it.js",
	"./it.js": "./node_modules/moment/locale/it.js",
	"./ja": "./node_modules/moment/locale/ja.js",
	"./ja.js": "./node_modules/moment/locale/ja.js",
	"./jv": "./node_modules/moment/locale/jv.js",
	"./jv.js": "./node_modules/moment/locale/jv.js",
	"./ka": "./node_modules/moment/locale/ka.js",
	"./ka.js": "./node_modules/moment/locale/ka.js",
	"./kk": "./node_modules/moment/locale/kk.js",
	"./kk.js": "./node_modules/moment/locale/kk.js",
	"./km": "./node_modules/moment/locale/km.js",
	"./km.js": "./node_modules/moment/locale/km.js",
	"./kn": "./node_modules/moment/locale/kn.js",
	"./kn.js": "./node_modules/moment/locale/kn.js",
	"./ko": "./node_modules/moment/locale/ko.js",
	"./ko.js": "./node_modules/moment/locale/ko.js",
	"./ku": "./node_modules/moment/locale/ku.js",
	"./ku.js": "./node_modules/moment/locale/ku.js",
	"./ky": "./node_modules/moment/locale/ky.js",
	"./ky.js": "./node_modules/moment/locale/ky.js",
	"./lb": "./node_modules/moment/locale/lb.js",
	"./lb.js": "./node_modules/moment/locale/lb.js",
	"./lo": "./node_modules/moment/locale/lo.js",
	"./lo.js": "./node_modules/moment/locale/lo.js",
	"./lt": "./node_modules/moment/locale/lt.js",
	"./lt.js": "./node_modules/moment/locale/lt.js",
	"./lv": "./node_modules/moment/locale/lv.js",
	"./lv.js": "./node_modules/moment/locale/lv.js",
	"./me": "./node_modules/moment/locale/me.js",
	"./me.js": "./node_modules/moment/locale/me.js",
	"./mi": "./node_modules/moment/locale/mi.js",
	"./mi.js": "./node_modules/moment/locale/mi.js",
	"./mk": "./node_modules/moment/locale/mk.js",
	"./mk.js": "./node_modules/moment/locale/mk.js",
	"./ml": "./node_modules/moment/locale/ml.js",
	"./ml.js": "./node_modules/moment/locale/ml.js",
	"./mn": "./node_modules/moment/locale/mn.js",
	"./mn.js": "./node_modules/moment/locale/mn.js",
	"./mr": "./node_modules/moment/locale/mr.js",
	"./mr.js": "./node_modules/moment/locale/mr.js",
	"./ms": "./node_modules/moment/locale/ms.js",
	"./ms-my": "./node_modules/moment/locale/ms-my.js",
	"./ms-my.js": "./node_modules/moment/locale/ms-my.js",
	"./ms.js": "./node_modules/moment/locale/ms.js",
	"./mt": "./node_modules/moment/locale/mt.js",
	"./mt.js": "./node_modules/moment/locale/mt.js",
	"./my": "./node_modules/moment/locale/my.js",
	"./my.js": "./node_modules/moment/locale/my.js",
	"./nb": "./node_modules/moment/locale/nb.js",
	"./nb.js": "./node_modules/moment/locale/nb.js",
	"./ne": "./node_modules/moment/locale/ne.js",
	"./ne.js": "./node_modules/moment/locale/ne.js",
	"./nl": "./node_modules/moment/locale/nl.js",
	"./nl-be": "./node_modules/moment/locale/nl-be.js",
	"./nl-be.js": "./node_modules/moment/locale/nl-be.js",
	"./nl.js": "./node_modules/moment/locale/nl.js",
	"./nn": "./node_modules/moment/locale/nn.js",
	"./nn.js": "./node_modules/moment/locale/nn.js",
	"./pa-in": "./node_modules/moment/locale/pa-in.js",
	"./pa-in.js": "./node_modules/moment/locale/pa-in.js",
	"./pl": "./node_modules/moment/locale/pl.js",
	"./pl.js": "./node_modules/moment/locale/pl.js",
	"./pt": "./node_modules/moment/locale/pt.js",
	"./pt-br": "./node_modules/moment/locale/pt-br.js",
	"./pt-br.js": "./node_modules/moment/locale/pt-br.js",
	"./pt.js": "./node_modules/moment/locale/pt.js",
	"./ro": "./node_modules/moment/locale/ro.js",
	"./ro.js": "./node_modules/moment/locale/ro.js",
	"./ru": "./node_modules/moment/locale/ru.js",
	"./ru.js": "./node_modules/moment/locale/ru.js",
	"./sd": "./node_modules/moment/locale/sd.js",
	"./sd.js": "./node_modules/moment/locale/sd.js",
	"./se": "./node_modules/moment/locale/se.js",
	"./se.js": "./node_modules/moment/locale/se.js",
	"./si": "./node_modules/moment/locale/si.js",
	"./si.js": "./node_modules/moment/locale/si.js",
	"./sk": "./node_modules/moment/locale/sk.js",
	"./sk.js": "./node_modules/moment/locale/sk.js",
	"./sl": "./node_modules/moment/locale/sl.js",
	"./sl.js": "./node_modules/moment/locale/sl.js",
	"./sq": "./node_modules/moment/locale/sq.js",
	"./sq.js": "./node_modules/moment/locale/sq.js",
	"./sr": "./node_modules/moment/locale/sr.js",
	"./sr-cyrl": "./node_modules/moment/locale/sr-cyrl.js",
	"./sr-cyrl.js": "./node_modules/moment/locale/sr-cyrl.js",
	"./sr.js": "./node_modules/moment/locale/sr.js",
	"./ss": "./node_modules/moment/locale/ss.js",
	"./ss.js": "./node_modules/moment/locale/ss.js",
	"./sv": "./node_modules/moment/locale/sv.js",
	"./sv.js": "./node_modules/moment/locale/sv.js",
	"./sw": "./node_modules/moment/locale/sw.js",
	"./sw.js": "./node_modules/moment/locale/sw.js",
	"./ta": "./node_modules/moment/locale/ta.js",
	"./ta.js": "./node_modules/moment/locale/ta.js",
	"./te": "./node_modules/moment/locale/te.js",
	"./te.js": "./node_modules/moment/locale/te.js",
	"./tet": "./node_modules/moment/locale/tet.js",
	"./tet.js": "./node_modules/moment/locale/tet.js",
	"./tg": "./node_modules/moment/locale/tg.js",
	"./tg.js": "./node_modules/moment/locale/tg.js",
	"./th": "./node_modules/moment/locale/th.js",
	"./th.js": "./node_modules/moment/locale/th.js",
	"./tl-ph": "./node_modules/moment/locale/tl-ph.js",
	"./tl-ph.js": "./node_modules/moment/locale/tl-ph.js",
	"./tlh": "./node_modules/moment/locale/tlh.js",
	"./tlh.js": "./node_modules/moment/locale/tlh.js",
	"./tr": "./node_modules/moment/locale/tr.js",
	"./tr.js": "./node_modules/moment/locale/tr.js",
	"./tzl": "./node_modules/moment/locale/tzl.js",
	"./tzl.js": "./node_modules/moment/locale/tzl.js",
	"./tzm": "./node_modules/moment/locale/tzm.js",
	"./tzm-latn": "./node_modules/moment/locale/tzm-latn.js",
	"./tzm-latn.js": "./node_modules/moment/locale/tzm-latn.js",
	"./tzm.js": "./node_modules/moment/locale/tzm.js",
	"./ug-cn": "./node_modules/moment/locale/ug-cn.js",
	"./ug-cn.js": "./node_modules/moment/locale/ug-cn.js",
	"./uk": "./node_modules/moment/locale/uk.js",
	"./uk.js": "./node_modules/moment/locale/uk.js",
	"./ur": "./node_modules/moment/locale/ur.js",
	"./ur.js": "./node_modules/moment/locale/ur.js",
	"./uz": "./node_modules/moment/locale/uz.js",
	"./uz-latn": "./node_modules/moment/locale/uz-latn.js",
	"./uz-latn.js": "./node_modules/moment/locale/uz-latn.js",
	"./uz.js": "./node_modules/moment/locale/uz.js",
	"./vi": "./node_modules/moment/locale/vi.js",
	"./vi.js": "./node_modules/moment/locale/vi.js",
	"./x-pseudo": "./node_modules/moment/locale/x-pseudo.js",
	"./x-pseudo.js": "./node_modules/moment/locale/x-pseudo.js",
	"./yo": "./node_modules/moment/locale/yo.js",
	"./yo.js": "./node_modules/moment/locale/yo.js",
	"./zh-cn": "./node_modules/moment/locale/zh-cn.js",
	"./zh-cn.js": "./node_modules/moment/locale/zh-cn.js",
	"./zh-hk": "./node_modules/moment/locale/zh-hk.js",
	"./zh-hk.js": "./node_modules/moment/locale/zh-hk.js",
	"./zh-tw": "./node_modules/moment/locale/zh-tw.js",
	"./zh-tw.js": "./node_modules/moment/locale/zh-tw.js"
};


function webpackContext(req) {
	var id = webpackContextResolve(req);
	var module = __webpack_require__(id);
	return module;
}
function webpackContextResolve(req) {
	var id = map[req];
	if(!(id + 1)) { // check for number or string
		var e = new Error('Cannot find module "' + req + '".');
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	}
	return id;
}
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "./node_modules/moment/locale sync recursive ^\\.\\/.*$";

/***/ }),

/***/ "./src/$$_lazy_route_resource lazy recursive":
/*!**********************************************************!*\
  !*** ./src/$$_lazy_route_resource lazy namespace object ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function webpackEmptyAsyncContext(req) {
	// Here Promise.resolve().then() is used instead of new Promise() to prevent
	// uncaught exception popping up in devtools
	return Promise.resolve().then(function() {
		var e = new Error('Cannot find module "' + req + '".');
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	});
}
webpackEmptyAsyncContext.keys = function() { return []; };
webpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;
module.exports = webpackEmptyAsyncContext;
webpackEmptyAsyncContext.id = "./src/$$_lazy_route_resource lazy recursive";

/***/ }),

/***/ "./src/app/app-routing.module.ts":
/*!***************************************!*\
  !*** ./src/app/app-routing.module.ts ***!
  \***************************************/
/*! exports provided: AppRoutingModule */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AppRoutingModule", function() { return AppRoutingModule; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/router */ "./node_modules/@angular/router/fesm5/router.js");
/* harmony import */ var _cardcontainer_cardcontainer_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./cardcontainer/cardcontainer.component */ "./src/app/cardcontainer/cardcontainer.component.ts");
/* harmony import */ var _fhir_launch_fhir_launch_component__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./fhir-launch/fhir-launch.component */ "./src/app/fhir-launch/fhir-launch.component.ts");
/* harmony import */ var _setup_setup_component__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./setup/setup.component */ "./src/app/setup/setup.component.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};





/* On their end, it's locked down so that the only acceptable redirect
URL is localhost:8000/. So, we have to do a different path for
authentication. */
var routes = [
    { path: 'main', component: _cardcontainer_cardcontainer_component__WEBPACK_IMPORTED_MODULE_2__["CardcontainerComponent"] },
    { path: '', component: _setup_setup_component__WEBPACK_IMPORTED_MODULE_4__["SetupComponent"] },
    { path: 'auth', component: _fhir_launch_fhir_launch_component__WEBPACK_IMPORTED_MODULE_3__["FhirLaunchComponent"] }, { path: '**', redirectTo: '' }
];
var AppRoutingModule = /** @class */ (function () {
    function AppRoutingModule() {
    }
    AppRoutingModule = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["NgModule"])({ exports: [_angular_router__WEBPACK_IMPORTED_MODULE_1__["RouterModule"]], imports: [_angular_router__WEBPACK_IMPORTED_MODULE_1__["RouterModule"].forRoot(routes)] })
    ], AppRoutingModule);
    return AppRoutingModule;
}());



/***/ }),

/***/ "./src/app/app.component.css":
/*!***********************************!*\
  !*** ./src/app/app.component.css ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = ""

/***/ }),

/***/ "./src/app/app.component.html":
/*!************************************!*\
  !*** ./src/app/app.component.html ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<router-outlet></router-outlet>"

/***/ }),

/***/ "./src/app/app.component.ts":
/*!**********************************!*\
  !*** ./src/app/app.component.ts ***!
  \**********************************/
/*! exports provided: AppComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AppComponent", function() { return AppComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};

var AppComponent = /** @class */ (function () {
    function AppComponent() {
        this.title = 'app';
    }
    AppComponent = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Component"])({
            selector: 'app-root',
            template: __webpack_require__(/*! ./app.component.html */ "./src/app/app.component.html"),
            styles: [__webpack_require__(/*! ./app.component.css */ "./src/app/app.component.css")]
        })
    ], AppComponent);
    return AppComponent;
}());



/***/ }),

/***/ "./src/app/app.module.ts":
/*!*******************************!*\
  !*** ./src/app/app.module.ts ***!
  \*******************************/
/*! exports provided: AppModule */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AppModule", function() { return AppModule; });
/* harmony import */ var fhirclient__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fhirclient */ "./node_modules/fhirclient/fhir-client.js");
/* harmony import */ var fhirclient__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fhirclient__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _angular_common_http__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/common/http */ "./node_modules/@angular/common/fesm5/http.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_flex_layout__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/flex-layout */ "./node_modules/@angular/flex-layout/esm5/flex-layout.es5.js");
/* harmony import */ var _angular_forms__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @angular/forms */ "./node_modules/@angular/forms/fesm5/forms.js");
/* harmony import */ var _angular_material__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @angular/material */ "./node_modules/@angular/material/esm5/material.es5.js");
/* harmony import */ var _angular_material_card__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @angular/material/card */ "./node_modules/@angular/material/esm5/card.es5.js");
/* harmony import */ var _angular_material_icon__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @angular/material/icon */ "./node_modules/@angular/material/esm5/icon.es5.js");
/* harmony import */ var _angular_material_input__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @angular/material/input */ "./node_modules/@angular/material/esm5/input.es5.js");
/* harmony import */ var _angular_platform_browser__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @angular/platform-browser */ "./node_modules/@angular/platform-browser/fesm5/platform-browser.js");
/* harmony import */ var _angular_platform_browser_animations__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @angular/platform-browser/animations */ "./node_modules/@angular/platform-browser/fesm5/animations.js");
/* harmony import */ var ng2_dragula__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ng2-dragula */ "./node_modules/ng2-dragula/dist/fesm5/ng2-dragula.js");
/* harmony import */ var ngx_daterangepicker_material__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ngx-daterangepicker-material */ "./node_modules/ngx-daterangepicker-material/esm5/ngx-daterangepicker-material.js");
/* harmony import */ var _environments_environment__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../environments/environment */ "./src/environments/environment.ts");
/* harmony import */ var _app_routing_module__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./app-routing.module */ "./src/app/app-routing.module.ts");
/* harmony import */ var _app_component__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./app.component */ "./src/app/app.component.ts");
/* harmony import */ var _cardcontainer_cardcontainer_component__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./cardcontainer/cardcontainer.component */ "./src/app/cardcontainer/cardcontainer.component.ts");
/* harmony import */ var _cardtypes_card_card_component__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./cardtypes/card/card.component */ "./src/app/cardtypes/card/card.component.ts");
/* harmony import */ var _cardtypes_customizable_timeline_customizable_timeline_dialog_customizable_timeline_dialog_component__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./cardtypes/customizable-timeline/customizable-timeline-dialog/customizable-timeline-dialog.component */ "./src/app/cardtypes/customizable-timeline/customizable-timeline-dialog/customizable-timeline-dialog.component.ts");
/* harmony import */ var _cardtypes_customizable_timeline_customizable_timeline_component__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./cardtypes/customizable-timeline/customizable-timeline.component */ "./src/app/cardtypes/customizable-timeline/customizable-timeline.component.ts");
/* harmony import */ var _cardtypes_multigraphcard_multigraphcard_component__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./cardtypes/multigraphcard/multigraphcard.component */ "./src/app/cardtypes/multigraphcard/multigraphcard.component.ts");
/* harmony import */ var _cardtypes_textboxcard_textboxcard_component__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./cardtypes/textboxcard/textboxcard.component */ "./src/app/cardtypes/textboxcard/textboxcard.component.ts");
/* harmony import */ var _clinicalconcepts_resource_code_manager__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./clinicalconcepts/resource-code-manager */ "./src/app/clinicalconcepts/resource-code-manager.ts");
/* harmony import */ var _data_selector_element_data_selector_element_component__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./data-selector-element/data-selector-element.component */ "./src/app/data-selector-element/data-selector-element.component.ts");
/* harmony import */ var _data_selector_menu_data_selector_menu_component__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./data-selector-menu/data-selector-menu.component */ "./src/app/data-selector-menu/data-selector-menu.component.ts");
/* harmony import */ var _debugger_debugger_component__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./debugger/debugger.component */ "./src/app/debugger/debugger.component.ts");
/* harmony import */ var _delete_dialog_delete_dialog_component__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./delete-dialog/delete-dialog.component */ "./src/app/delete-dialog/delete-dialog.component.ts");
/* harmony import */ var _fhir_http_service__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./fhir-http.service */ "./src/app/fhir-http.service.ts");
/* harmony import */ var _fhir_launch_fhir_launch_component__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./fhir-launch/fhir-launch.component */ "./src/app/fhir-launch/fhir-launch.component.ts");
/* harmony import */ var _fhir_service__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./fhir.service */ "./src/app/fhir.service.ts");
/* harmony import */ var _graphtypes_customizable_graph_customizable_graph_component__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./graphtypes/customizable-graph/customizable-graph.component */ "./src/app/graphtypes/customizable-graph/customizable-graph.component.ts");
/* harmony import */ var _graphtypes_linegraph_linegraph_component__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./graphtypes/linegraph/linegraph.component */ "./src/app/graphtypes/linegraph/linegraph.component.ts");
/* harmony import */ var _graphtypes_microbio_graph_microbio_graph_component__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./graphtypes/microbio-graph/microbio-graph.component */ "./src/app/graphtypes/microbio-graph/microbio-graph.component.ts");
/* harmony import */ var _graphtypes_scatterplot_scatterplot_component__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./graphtypes/scatterplot/scatterplot.component */ "./src/app/graphtypes/scatterplot/scatterplot.component.ts");
/* harmony import */ var _graphtypes_stepgraph_stepgraph_component__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./graphtypes/stepgraph/stepgraph.component */ "./src/app/graphtypes/stepgraph/stepgraph.component.ts");
/* harmony import */ var _help_dialog_help_dialog_component__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./help-dialog/help-dialog.component */ "./src/app/help-dialog/help-dialog.component.ts");
/* harmony import */ var _mock_fhir_service__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ./mock-fhir.service */ "./src/app/mock-fhir.service.ts");
/* harmony import */ var _setup_setup_component__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ./setup/setup.component */ "./src/app/setup/setup.component.ts");
/* harmony import */ var _smart_on_fhir_client__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ./smart-on-fhir-client */ "./src/app/smart-on-fhir-client.ts");
/* harmony import */ var _timeline_controller_timeline_controller_component__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ./timeline-controller/timeline-controller.component */ "./src/app/timeline-controller/timeline-controller.component.ts");
/* harmony import */ var _timeline_toolbar_timeline_toolbar_component__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ./timeline-toolbar/timeline-toolbar.component */ "./src/app/timeline-toolbar/timeline-toolbar.component.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};





// tslint:disable-next-line:max-line-length













// tslint:disable-next-line:max-line-length























var AppModule = /** @class */ (function () {
    function AppModule() {
    }
    AppModule = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["NgModule"])({
            declarations: [
                _app_component__WEBPACK_IMPORTED_MODULE_15__["AppComponent"],
                _fhir_launch_fhir_launch_component__WEBPACK_IMPORTED_MODULE_28__["FhirLaunchComponent"],
                _cardcontainer_cardcontainer_component__WEBPACK_IMPORTED_MODULE_16__["CardcontainerComponent"],
                _cardtypes_textboxcard_textboxcard_component__WEBPACK_IMPORTED_MODULE_21__["TextboxcardComponent"],
                _graphtypes_linegraph_linegraph_component__WEBPACK_IMPORTED_MODULE_31__["LineGraphComponent"],
                _graphtypes_scatterplot_scatterplot_component__WEBPACK_IMPORTED_MODULE_33__["ScatterplotComponent"],
                _graphtypes_stepgraph_stepgraph_component__WEBPACK_IMPORTED_MODULE_34__["StepGraphComponent"],
                _cardtypes_multigraphcard_multigraphcard_component__WEBPACK_IMPORTED_MODULE_20__["MultiGraphCardComponent"],
                _timeline_controller_timeline_controller_component__WEBPACK_IMPORTED_MODULE_39__["TimelineControllerComponent"],
                _cardtypes_customizable_timeline_customizable_timeline_component__WEBPACK_IMPORTED_MODULE_19__["CustomizableTimelineComponent"],
                _graphtypes_customizable_graph_customizable_graph_component__WEBPACK_IMPORTED_MODULE_30__["CustomizableGraphComponent"],
                _cardtypes_customizable_timeline_customizable_timeline_dialog_customizable_timeline_dialog_component__WEBPACK_IMPORTED_MODULE_18__["CustomizableTimelineDialogComponent"],
                _graphtypes_microbio_graph_microbio_graph_component__WEBPACK_IMPORTED_MODULE_32__["MicrobioGraphComponent"],
                _timeline_toolbar_timeline_toolbar_component__WEBPACK_IMPORTED_MODULE_40__["TimelineToolbarComponent"],
                _data_selector_element_data_selector_element_component__WEBPACK_IMPORTED_MODULE_23__["DataSelectorElementComponent"],
                _data_selector_menu_data_selector_menu_component__WEBPACK_IMPORTED_MODULE_24__["DataSelectorMenuComponent"],
                _help_dialog_help_dialog_component__WEBPACK_IMPORTED_MODULE_35__["HelpDialogComponent"],
                _cardtypes_card_card_component__WEBPACK_IMPORTED_MODULE_17__["CardComponent"],
                _delete_dialog_delete_dialog_component__WEBPACK_IMPORTED_MODULE_26__["DeleteDialogComponent"],
                _debugger_debugger_component__WEBPACK_IMPORTED_MODULE_25__["DebuggerComponent"],
                _setup_setup_component__WEBPACK_IMPORTED_MODULE_37__["SetupComponent"],
            ],
            imports: [
                _angular_platform_browser__WEBPACK_IMPORTED_MODULE_9__["BrowserModule"],
                _angular_material_card__WEBPACK_IMPORTED_MODULE_6__["MatCardModule"],
                _angular_common_http__WEBPACK_IMPORTED_MODULE_1__["HttpClientModule"],
                _angular_material__WEBPACK_IMPORTED_MODULE_5__["MatListModule"],
                _angular_material__WEBPACK_IMPORTED_MODULE_5__["MatDividerModule"],
                _angular_material_icon__WEBPACK_IMPORTED_MODULE_7__["MatIconModule"],
                _angular_platform_browser_animations__WEBPACK_IMPORTED_MODULE_10__["NoopAnimationsModule"],
                _angular_forms__WEBPACK_IMPORTED_MODULE_4__["FormsModule"],
                _angular_forms__WEBPACK_IMPORTED_MODULE_4__["ReactiveFormsModule"],
                _angular_material_input__WEBPACK_IMPORTED_MODULE_8__["MatInputModule"],
                _angular_material__WEBPACK_IMPORTED_MODULE_5__["MatProgressSpinnerModule"],
                _angular_material__WEBPACK_IMPORTED_MODULE_5__["MatButtonModule"],
                _angular_material__WEBPACK_IMPORTED_MODULE_5__["MatAutocompleteModule"],
                _angular_material__WEBPACK_IMPORTED_MODULE_5__["MatMenuModule"],
                _angular_material__WEBPACK_IMPORTED_MODULE_5__["MatTooltipModule"],
                _angular_flex_layout__WEBPACK_IMPORTED_MODULE_3__["FlexLayoutModule"].withConfig({ useColumnBasisZero: false }),
                _angular_material__WEBPACK_IMPORTED_MODULE_5__["MatDialogModule"],
                _angular_material__WEBPACK_IMPORTED_MODULE_5__["MatStepperModule"],
                _angular_material__WEBPACK_IMPORTED_MODULE_5__["MatToolbarModule"],
                _angular_material__WEBPACK_IMPORTED_MODULE_5__["MatSnackBarModule"],
                _angular_material__WEBPACK_IMPORTED_MODULE_5__["MatDatepickerModule"],
                ngx_daterangepicker_material__WEBPACK_IMPORTED_MODULE_12__["NgxDaterangepickerMd"].forRoot({}),
                _angular_material__WEBPACK_IMPORTED_MODULE_5__["MatButtonToggleModule"],
                _angular_material__WEBPACK_IMPORTED_MODULE_5__["MatNativeDateModule"],
                _angular_material__WEBPACK_IMPORTED_MODULE_5__["MatCheckboxModule"],
                ng2_dragula__WEBPACK_IMPORTED_MODULE_11__["DragulaModule"].forRoot(),
                _app_routing_module__WEBPACK_IMPORTED_MODULE_14__["AppRoutingModule"]
            ],
            providers: [
                // This sets up a provider for the smart on fhir client defined by
                // assets/fhir-client.min.js (defined as symbol `FHIR`) so that it can be
                // injected into the service that uses it to allow for easier testing.
                { provide: _smart_on_fhir_client__WEBPACK_IMPORTED_MODULE_38__["SMART_ON_FHIR_CLIENT"], useValue: FHIR }, {
                    provide: _fhir_service__WEBPACK_IMPORTED_MODULE_29__["FhirService"],
                    useClass: _environments_environment__WEBPACK_IMPORTED_MODULE_13__["environment"].useMockServer ? _mock_fhir_service__WEBPACK_IMPORTED_MODULE_36__["MockFhirService"] : _fhir_http_service__WEBPACK_IMPORTED_MODULE_27__["FhirHttpService"]
                },
                { provide: _clinicalconcepts_resource_code_manager__WEBPACK_IMPORTED_MODULE_22__["ResourceCodeManager"], useClass: _clinicalconcepts_resource_code_manager__WEBPACK_IMPORTED_MODULE_22__["ResourceCodeManager"] }
            ],
            bootstrap: [_app_component__WEBPACK_IMPORTED_MODULE_15__["AppComponent"]],
            entryComponents: [
                _cardtypes_customizable_timeline_customizable_timeline_dialog_customizable_timeline_dialog_component__WEBPACK_IMPORTED_MODULE_18__["CustomizableTimelineDialogComponent"], _help_dialog_help_dialog_component__WEBPACK_IMPORTED_MODULE_35__["HelpDialogComponent"],
                _delete_dialog_delete_dialog_component__WEBPACK_IMPORTED_MODULE_26__["DeleteDialogComponent"]
            ]
        })
    ], AppModule);
    return AppModule;
}());



/***/ }),

/***/ "./src/app/cardcontainer/cardcontainer.component.css":
/*!***********************************************************!*\
  !*** ./src/app/cardcontainer/cardcontainer.component.css ***!
  \***********************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = ".cardContainer {\n  background-color: #002356; /* PRIMARY_COLOR */\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  padding: 15px;\n  width: 100%;\n  min-height: 100%;\n  /* Disable selecting/highlighting on the page. */\n  -webkit-touch-callout: none; /* iOS Safari */\n  -webkit-user-select: none; /* Safari */\n     -moz-user-select: none; /* Firefox */\n      -ms-user-select: none; /* Internet Explorer/Edge */\n          user-select: none; /* Chrome and Opera */\n}\n\n.mat-toolbar {\n  background-color: #00002d; /* PRIMARY_COLOR, dark variant */\n}\n\n::ng-deep .gu-unselectable app-data-selector-menu {\n  /* Hide the data selector menus while a card is being dragged. */\n  opacity: 0 !important;\n}\n\n.makeGutters {\n  padding-right: 100px;\n  padding-left: 100px;\n}\n\n::ng-deep .mat-toolbar-single-row {\n  white-space: unset !important;\n}\n"

/***/ }),

/***/ "./src/app/cardcontainer/cardcontainer.component.html":
/*!************************************************************!*\
  !*** ./src/app/cardcontainer/cardcontainer.component.html ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<mat-toolbar color=\"primary\" class=\"toolbar\">\n  <app-timeline-controller (changeDateRange)=\"changeDateRange($event)\"></app-timeline-controller>\n  <!--Push the buttons to the right and left sides.-->\n  <div fxFlex></div>\n  <app-timeline-toolbar (saveSnapshot)=\"snapshot()\" (addTextbox)=\"addTextbox()\"></app-timeline-toolbar>\n</mat-toolbar>\n<div *ngIf=\"useDebugger\">\n  <app-debugger></app-debugger>\n</div>\n<div fxLayout=\"column\" class=\"cardContainer makeGutters\" fxLayoutAlign=\"start\">\n  <app-data-selector-menu (addCard)=\"addConceptCard($event)\" (addTextbox)=\"addTextbox()\"\n    (addCustomTimeline)=\"addCustomTimeline()\"></app-data-selector-menu>\n  <div fxLayout=\"column\" dragula=\"graphcards\" class=\"draggable\">\n    <div *ngFor=\"let element of displayedConcepts\" [attr.data-index]=\"element['id']\" class=\"displayedConcept\">\n      <app-textboxcard *ngIf=\"element['concept'] ==='textbox'\" [id]=\"element['id']\" [noteString]=\"element['value']\"\n        (removeEvent)=\"removeDisplayedCard($event)\"></app-textboxcard>\n      <app-customizable-timeline *ngIf=\"element['concept']==='customTimeline'\" [id]=\"element['id']\"\n        [dateRange]=\"dateRange\" [deletedData]=\"element['value']\" (updateEventLines)=\"updateEventLines($event)\"\n        (removeEvent)=\"removeDisplayedCard($event)\">\n      </app-customizable-timeline>\n      <app-multigraphcard *ngIf=\"element['concept'] !=='textbox' && element['concept'] !== 'customTimeline'\"\n        [resourceCodeGroups]=\"element['concept']\" [dateRange]=\"dateRange\" [eventlines]=\"eventlines\" [id]=\"element['id']\"\n        (removeEvent)=\"removeDisplayedCard($event)\">\n      </app-multigraphcard>\n      <app-data-selector-menu (addCard)=\"addConceptCard($event, element['id'])\" (addTextbox)=\"addTextbox(element['id'])\"\n        (addCustomTimeline)=\"addCustomTimeline(element['id'])\"></app-data-selector-menu>\n    </div>\n  </div>\n</div>"

/***/ }),

/***/ "./src/app/cardcontainer/cardcontainer.component.ts":
/*!**********************************************************!*\
  !*** ./src/app/cardcontainer/cardcontainer.component.ts ***!
  \**********************************************************/
/*! exports provided: CardcontainerComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CardcontainerComponent", function() { return CardcontainerComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_material__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/material */ "./node_modules/@angular/material/esm5/material.es5.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! luxon */ "./node_modules/luxon/build/cjs-browser/luxon.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(luxon__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var ng2_dragula__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ng2-dragula */ "./node_modules/ng2-dragula/dist/fesm5/ng2-dragula.js");
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rxjs */ "./node_modules/rxjs/_esm5/index.js");
/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! uuid */ "./node_modules/uuid/index.js");
/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(uuid__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _environments_environment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../environments/environment */ "./src/environments/environment.ts");
/* harmony import */ var _cardtypes_card_card_component__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../cardtypes/card/card.component */ "./src/app/cardtypes/card/card.component.ts");
/* harmony import */ var _clinicalconcepts_resource_code_manager__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../clinicalconcepts/resource-code-manager */ "./src/app/clinicalconcepts/resource-code-manager.ts");
/* harmony import */ var _delete_dialog_delete_dialog_component__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../delete-dialog/delete-dialog.component */ "./src/app/delete-dialog/delete-dialog.component.ts");
/* harmony import */ var _fhir_service__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../fhir.service */ "./src/app/fhir.service.ts");
/* harmony import */ var _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../graphtypes/graph/graph.component */ "./src/app/graphtypes/graph/graph.component.ts");
/* harmony import */ var _setup_data_service__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../setup-data.service */ "./src/app/setup-data.service.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};













var CardcontainerComponent = /** @class */ (function () {
    // TODO(b/119251288): Extract out the constants to somewhere shared between
    // the ts files and html files.
    function CardcontainerComponent(dragulaService, fhirService, resourceCodeManager, snackBar, deleteDialog, setupDataService) {
        this.fhirService = fhirService;
        this.snackBar = snackBar;
        this.deleteDialog = deleteDialog;
        this.setupDataService = setupDataService;
        // How long to display the snack bar for.
        this.DISPLAY_TIME = 6000;
        // Whether or not to display the debugger.
        this.useDebugger = _environments_environment__WEBPACK_IMPORTED_MODULE_6__["environment"].useDebugger;
        // The format of each object in the array is an object representing a line
        // drawn on the chart, that has a value, text, and class field. The value
        // field represents the x-position of the line to be drawn, while the class
        // represents the class name, and the text represents the text displayed near
        // the line.
        this.eventlines = [];
        // The concepts that are actually being displayed on the page.
        // We keep track of unique ids for each displayed card, to allow removal on
        // clicking the trashcan icon.
        this.displayedConcepts = [];
        // Hold an instance of this enum so that the HTML template can access it.
        this.chartType = _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_11__["ChartType"];
        // Holds a subscription to the observable sequence of events emitted by the
        // Dragula Service.
        this.subs = new rxjs__WEBPACK_IMPORTED_MODULE_4__["Subscription"]();
        // A map of custom timeline id to the event lines corresponding to that
        // timeline.
        this.eventsForCustomTimelines = new Map();
        var displayGroups = resourceCodeManager.getDisplayGroupMapping();
        /* Load in the concepts to display, flattening them all into a
         * single-depth array. */
        this.originalConcepts = Array.from(displayGroups.values())
            .reduce(function (acc, val) { return acc.concat(val); }, []);
        this.setUpCards();
        this.setUpDrag(dragulaService);
        console.warn(_environments_environment__WEBPACK_IMPORTED_MODULE_6__["environment"].useDebugger);
    }
    CardcontainerComponent.prototype.setUpCards = function () {
        // Add a textbox at the top of the card list.
        this.addTextbox();
        // Add a custom timeline to the top of the card list.
        this.addCustomTimeline();
        // Add all cards selected at the set-up screen.
        for (var _i = 0, _a = this.setupDataService.selectedConcepts; _i < _a.length; _i++) {
            var concept = _a[_i];
            this.displayedConcepts.push({ 'id': Object(uuid__WEBPACK_IMPORTED_MODULE_5__["v4"])(), 'concept': concept });
        }
    };
    // Ensures that the order of displayed concepts is updated as the user drags
    // cards around.
    CardcontainerComponent.prototype.setUpDrag = function (dragulaService) {
        var _this = this;
        this.subs.add(dragulaService.drop('graphcards').subscribe(function (value) {
            // Rearrange the order of this.displayedConcepts if graph/textbox
            // cards are reordered. We do not use dragulaModel since we cannot use
            // it for separate lists on the configuration panel.
            var originalIndex = _this.displayedConcepts.map(function (x) { return x.id; }).indexOf(value.el.getAttribute('data-index'));
            var siblingIndex = _this.getSiblingIdx(value);
            var elementDisplayed = _this.displayedConcepts[originalIndex];
            // Add the element to its new position.
            _this.displayedConcepts.splice(siblingIndex, 0, elementDisplayed);
            // Adjust the original position if needed.
            if (siblingIndex < originalIndex) {
                originalIndex++;
            }
            _this.displayedConcepts.splice(originalIndex, 1);
        }));
    };
    /**
     * Gets the index of the card below a dragged-and-dropped card's new place.
     */
    CardcontainerComponent.prototype.getSiblingIdx = function (value) {
        var siblingIndex;
        if (value.sibling === null) {
            // Dragged to bottom of list
            siblingIndex = this.displayedConcepts.length;
        }
        else {
            var siblingId = value.sibling.getAttribute('data-index');
            siblingIndex = this.displayedConcepts.map(function (x) { return x.id; }).indexOf(siblingId);
        }
        return siblingIndex;
    };
    /**
     * Adds a new annotation box to the card panel.
     * @param id: The id of the card above the position of the new annotation box.
     */
    CardcontainerComponent.prototype.addTextbox = function (id) {
        var index = id ? (this.displayedConcepts.map(function (x) { return x.id; }).indexOf(id) + 1) : 0;
        this.displayedConcepts.splice(index, 0, { id: Object(uuid__WEBPACK_IMPORTED_MODULE_5__["v4"])(), concept: 'textbox' });
    };
    /**
     * Adds a new custom timeline to the card panel.
     * @param id: The id of the card above the position of the new annotation box.
     */
    CardcontainerComponent.prototype.addCustomTimeline = function (id) {
        var index = id ? (this.displayedConcepts.map(function (x) { return x.id; }).indexOf(id) + 1) : 0;
        this.displayedConcepts.splice(index, 0, { id: Object(uuid__WEBPACK_IMPORTED_MODULE_5__["v4"])(), concept: 'customTimeline' });
    };
    // Listen for an event indicating that the date range has been changed on the
    // UI, and update the date range.
    CardcontainerComponent.prototype.changeDateRange = function ($event) {
        this.dateRange = $event;
    };
    // Saves a snapshot of the graph drawer HTML to the EHR using a FhirService.
    CardcontainerComponent.prototype.snapshot = function () {
        this.fhirService.saveStaticNote(document.getElementsByClassName('cardContainer')[0].innerHTML, luxon__WEBPACK_IMPORTED_MODULE_2__["DateTime"].fromJSDate(new Date()).toISO());
    };
    // Listen for an event indicating that a "delete" button has been clicked on a
    // card currently displayed, and update the displayed concepts
    // accordingly after asking for confirmation of deletion.
    CardcontainerComponent.prototype.removeDisplayedCard = function ($event) {
        var _this = this;
        var index = this.displayedConcepts.map(function (x) { return x.id; }).indexOf($event.id);
        var concept = this.displayedConcepts[index];
        concept.value = $event.value;
        this.deleteDialogRef = this.deleteDialog.open(_delete_dialog_delete_dialog_component__WEBPACK_IMPORTED_MODULE_9__["DeleteDialogComponent"]);
        this.deleteDialogRef.afterClosed().subscribe(function (result) {
            // The user wishes to delete the card.
            if (result) {
                _this.displayedConcepts.splice(index, 1);
                _this.recentlyRemoved = [index, concept];
                _this.openSnackBar();
                if (_this.eventsForCustomTimelines.get($event.id)) {
                    // We only remove the event lines for this CustomTimeline if the user
                    // confirms the deletion of the card.
                    _this.updateEventLines({ id: $event.id });
                }
            }
        });
    };
    // Open a snack bar allowing for the user to potentially reverse the removal
    // of cards from the page. Only one snack bar can be opened at a time.
    CardcontainerComponent.prototype.openSnackBar = function () {
        var _this = this;
        var message = 'Card removed.';
        var snackBarRef = this.snackBar.open(message, 'Undo', {
            duration: this.DISPLAY_TIME,
        });
        // Undo the most recent deletion according to what is stored in
        // recentlyRemoved.
        snackBarRef.onAction().subscribe(function () {
            _this.displayedConcepts.splice(0, 0, _this.recentlyRemoved[1]);
            if (_this.displayedConcepts[0].concept === 'customTimeline') {
                _this.updateEventLines({
                    id: _this.displayedConcepts[0].id,
                    data: _this.displayedConcepts[0].value
                });
            }
        });
    };
    /**
     * Listens for an event indicating that the user has selected to add the
     * concept card from the top toolbar. The card is added at the top of the
     * page, or, if the id of the closest card is specified, below the closest
     * card.
     * @param label The label of the new concept to add.
     * @param id The id of the card below which to add the new concept.
     */
    CardcontainerComponent.prototype.addConceptCard = function (label, id) {
        var graphCardValue = this.originalConcepts.find(function (obj) { return (obj.label === label); });
        // Insert the card at the top of the page
        // Insert after the closest card rather than before the card.
        var index = id ? (this.displayedConcepts.map(function (x) { return x.id; }).indexOf(id) + 1) : 0;
        this.displayedConcepts.splice(index, 0, { id: Object(uuid__WEBPACK_IMPORTED_MODULE_5__["v4"])(), concept: graphCardValue });
    };
    /**
     * Listens for an event indicating that the user has edited the points on a
     * custom timeline, and updates the x-axis eventlines displayed on all other
     * charts.
     * @param $event The updated CustomizableData from which we calculate event
     *     lines for each chart to display, along with the id of the updated.
     *
     */
    CardcontainerComponent.prototype.updateEventLines = function ($event) {
        var times = [];
        if ($event.data) {
            times = Array.from($event.data.annotations.keys())
                .map(function (x) { return Number(x); })
                .sort(function (a, b) { return a - b; });
        }
        // Remove the first point (with the earliest possible date) that was added
        // in order to display the x-axis.
        times.shift();
        var eventlines = times.map(function (x) {
            return {
                value: x,
                text: $event.data.annotations.get(x).title,
                class: 'color' +
                    $event.data.annotations.get(x).color.hex().replace('#', '')
            };
        });
        this.eventsForCustomTimelines.set($event.id, eventlines);
        // Consolidate all event lines from all custom timelines.
        var allEvents = [];
        for (var _i = 0, _a = Array.from(this.eventsForCustomTimelines.values()); _i < _a.length; _i++) {
            var events = _a[_i];
            allEvents = allEvents.concat(events);
        }
        this.eventlines = allEvents;
    };
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ViewChildren"])(_cardtypes_card_card_component__WEBPACK_IMPORTED_MODULE_7__["CardComponent"]),
        __metadata("design:type", _angular_core__WEBPACK_IMPORTED_MODULE_0__["QueryList"])
    ], CardcontainerComponent.prototype, "containedCards", void 0);
    CardcontainerComponent = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Component"])({
            selector: 'app-cardcontainer',
            template: __webpack_require__(/*! ./cardcontainer.component.html */ "./src/app/cardcontainer/cardcontainer.component.html"),
            styles: [__webpack_require__(/*! ./cardcontainer.component.css */ "./src/app/cardcontainer/cardcontainer.component.css")],
            entryComponents: [_delete_dialog_delete_dialog_component__WEBPACK_IMPORTED_MODULE_9__["DeleteDialogComponent"]],
        }),
        __metadata("design:paramtypes", [ng2_dragula__WEBPACK_IMPORTED_MODULE_3__["DragulaService"], _fhir_service__WEBPACK_IMPORTED_MODULE_10__["FhirService"],
            _clinicalconcepts_resource_code_manager__WEBPACK_IMPORTED_MODULE_8__["ResourceCodeManager"], _angular_material__WEBPACK_IMPORTED_MODULE_1__["MatSnackBar"],
            _angular_material__WEBPACK_IMPORTED_MODULE_1__["MatDialog"],
            _setup_data_service__WEBPACK_IMPORTED_MODULE_12__["SetupDataService"]])
    ], CardcontainerComponent);
    return CardcontainerComponent;
}());



/***/ }),

/***/ "./src/app/cardtypes/card.ts":
/*!***********************************!*\
  !*** ./src/app/cardtypes/card.ts ***!
  \***********************************/
/*! exports provided: Card */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Card", function() { return Card; });
/* harmony import */ var _graphtypes_axis__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../graphtypes/axis */ "./src/app/graphtypes/axis.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

/**
 * A Card represents the data associated with one card rendered. One Card
 * may include many graphs, each represented by one "Axis". A Card holds
 * whether or not to display the data by default, the grouping associated with
 * the charts, and the axes. Each Axis for this Card
 * could have a different graph type but must all belong to the same display
 * grouping.
 */
var Card = /** @class */ (function () {
    /**
     * The constructor for this axis.
     * @param fhirService The FhirService used to make the FHIR calls.
     * @param resourceCodes The groups of resources to display on each Axis
     *     for this Card.
     * @param dateRange The date range for this Card.
     * @throws Error if the ResourceCodeGroups have mixed display groupings, or
     * the resource code groups are undefined
     */
    function Card(fhirService, resourceCodes, 
    /**
     * The date range associated with this Card.
     */
    dateRange, sanitizer) {
        this.dateRange = dateRange;
        /**
         * The Axes associated with this Card.
         */
        this.axes = [];
        var resourceCodeGroups = resourceCodes.resourceCodeGroups;
        if (!resourceCodeGroups) {
            throw Error('Resource codes are undefined.');
        }
        if (resourceCodeGroups.length > 0) {
            var allConcepts = new Set(resourceCodeGroups.map(function (x) { return x.displayGrouping; }));
            if (allConcepts.size !== 1) {
                throw Error('The resource list in this set has mixed concepts: ' +
                    Array.from(allConcepts));
            }
            this.displayConcept = allConcepts.keys().next().value;
        }
        this.dateRange = dateRange;
        for (var _i = 0, resourceCodeGroups_1 = resourceCodeGroups; _i < resourceCodeGroups_1.length; _i++) {
            var resourceGroup = resourceCodeGroups_1[_i];
            var label = (resourceGroup.label !== resourceCodes.label) ?
                resourceGroup.label :
                undefined;
            this.axes.push(new _graphtypes_axis__WEBPACK_IMPORTED_MODULE_0__["Axis"](fhirService, resourceGroup, dateRange, sanitizer, label));
        }
    }
    return Card;
}());



/***/ }),

/***/ "./src/app/cardtypes/card/card.component.css":
/*!***************************************************!*\
  !*** ./src/app/cardtypes/card/card.component.css ***!
  \***************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = ".mat-card {\n  cursor: -webkit-grab;\n  cursor: grab;\n  margin-top:0px;\n  margin-bottom:0px;\n  margin-left: 35px; /* Leave space for the \"add card\" button. */\n  padding-top: 0px;\n  padding-bottom: 0px;\n  padding-right: 20px;\n  padding-left: 0px;\n  -webkit-transition: -webkit-box-shadow .1s;\n  transition: -webkit-box-shadow .1s;\n  transition: box-shadow .1s;\n  transition: box-shadow .1s, -webkit-box-shadow .1s;\n  background-color: rgb(248, 248, 248);\n}\n\n::ng-deep .inEditMode .mat-card {\n  background-color: rgb(226, 226, 226) !important;\n}\n\n.mat-card:hover {\n  background-color: rgb(240, 240, 240);\n  -webkit-box-shadow: 0 0 8px rgba(0,0,0,.18),0 8px 16px rgba(0,0,0,.36);\n          box-shadow: 0 0 8px rgba(0,0,0,.18),0 8px 16px rgba(0,0,0,.36);\n}\n\n.colorbar {\n  margin-right: 6px;\n  min-width: 24px;\n  border-top-left-radius: 4px;\n  border-bottom-left-radius: 4px;\n}\n\n.mat-icon {\n  color: rgb(34, 44, 66);\n  cursor: pointer;\n  opacity: .3;\n  -webkit-transition: opacity .3s;\n  transition: opacity .3s;\n}\n\n.removeCardButton {\n  opacity: 0;\n}\n\n.mat-card:hover .mat-icon {\n  opacity: .8;\n}\n\n.mat-card:hover .dragCardIcon.mat-icon {\n  opacity: .4;\n}\n\n.dragCardIcon {\n  opacity: 0;\n  margin-bottom: 15px;\n}\n\n.labelColumn{\n  padding: 3px;\n}\n\n.label {\n  max-width: 200px;\n  min-width: 200px;\n  word-wrap: break-word;\n  font-family: 'Quicksand', sans-serif;\n}\n\n::ng-deep .mat-input-element:disabled{\n  color: rgb(0,0,0, .7) !important;\n}"

/***/ }),

/***/ "./src/app/cardtypes/card/card.component.html":
/*!****************************************************!*\
  !*** ./src/app/cardtypes/card/card.component.html ***!
  \****************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<!-- This component is a card that holds a colored sidebar with icons indicating\nfunctionality, then space for a label & legend, then space for other contents. -->\n<mat-card fxFlex [attr.id]=\"id\" fxLayout=\"row\" fxLayoutAlign=\"space-between center\" (resized)=\"resize($event)\">\n  <div fxFlex fxLayout=\"column\" fxFlexAlign=\"stretch\" fxShrink='0' fxGrow='0' fxLayoutAlign=\"space-between center\"\n    [style.background-color]=\"color\" class=\"colorbar\">\n    <mat-icon *ngIf=\"isRemovable\" class=\"removeCardButton\" (click)=\"remove($event)\" matTooltip=\"Remove this card\">clear</mat-icon>\n    <mat-icon *ngIf=\"isDraggable\" class=\"dragCardIcon\">\n      drag_indicator\n    </mat-icon>\n    <!--Ensure that the dragger icon is always at the center of the color bar.-->\n    <div style=\"margin-bottom: 12px\"></div>\n  </div>\n  <div *ngIf=\"label\" fxFlex fxLayout=\"column\" fxFlexAlign=\"stretch\" fxGrow=\"0\" fxShrink=\"0\" class=\"labelColumn\">\n    <div fxFlex class=\"mat-title label\">{{label}}</div>\n    <!--Give the div that you want to appear here the class \"legends-block\".-->\n    <ng-content select=\".legends-block\"></ng-content>\n  </div>\n  <!--Give the div that you want to appear here the class \"contents-block\".-->\n  <ng-content select=\".contents-block\"></ng-content>\n  <div *ngIf=\"!isEditable\" style=\"margin-right: 25px\"></div>\n  <ng-container *ngIf=\"isEditable\">\n    <mat-icon *ngIf=\"!inEditMode\" matTooltip=\"Click to edit this card\" (click)=\"edit($event)\" class=\"editCardIcon\">edit</mat-icon>\n    <mat-icon *ngIf=\"inEditMode\" matTooltip=\"Click to save your work\" (click)=\"save($event)\">save</mat-icon>\n  </ng-container>\n</mat-card>"

/***/ }),

/***/ "./src/app/cardtypes/card/card.component.ts":
/*!**************************************************!*\
  !*** ./src/app/cardtypes/card/card.component.ts ***!
  \**************************************************/
/*! exports provided: CardComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CardComponent", function() { return CardComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var color__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! color */ "./node_modules/color/index.js");
/* harmony import */ var color__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(color__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var src_app_theme_bch_colors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! src/app/theme/bch_colors */ "./src/app/theme/bch_colors.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};



/**
 * This is the base template for all the cards in this app. It will show a
 * colored bar on the left hand side with icons for actions, and then
 * optionally a label and legend, then the contents of the card.
 */
var CardComponent = /** @class */ (function () {
    function CardComponent() {
        this.color = src_app_theme_bch_colors__WEBPACK_IMPORTED_MODULE_2__["BOSTON_WARM_GRAY"];
        this.isDraggable = true;
        this.isEditable = false;
        this.isRemovable = true;
        this.renderEvent = new _angular_core__WEBPACK_IMPORTED_MODULE_0__["EventEmitter"]();
        this.removeEvent = new _angular_core__WEBPACK_IMPORTED_MODULE_0__["EventEmitter"]();
        this.editEvent = new _angular_core__WEBPACK_IMPORTED_MODULE_0__["EventEmitter"]();
        this.saveEvent = new _angular_core__WEBPACK_IMPORTED_MODULE_0__["EventEmitter"]();
        this.inEditMode = false;
    }
    // The events below need to get propogated up to the card container.
    // Called when the user clicks the trashcan button on the card.
    CardComponent.prototype.remove = function () {
        this.removeEvent.emit(this.id);
    };
    // Called when the card resizes.
    CardComponent.prototype.resize = function ($event) {
        this.renderEvent.emit($event);
    };
    // Called when the user clicks on the edit button.
    CardComponent.prototype.edit = function ($event) {
        this.inEditMode = true;
        this.editEvent.emit($event);
    };
    // Called when the user hits the save button to exit out of edit mode.
    CardComponent.prototype.save = function ($event) {
        this.inEditMode = false;
        this.saveEvent.emit($event);
    };
    var _a;
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", typeof (_a = typeof color__WEBPACK_IMPORTED_MODULE_1__ !== "undefined" && color__WEBPACK_IMPORTED_MODULE_1__) === "function" ? _a : Object)
    ], CardComponent.prototype, "color", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", String)
    ], CardComponent.prototype, "id", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", String)
    ], CardComponent.prototype, "label", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", Object)
    ], CardComponent.prototype, "isDraggable", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", Object)
    ], CardComponent.prototype, "isEditable", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", Object)
    ], CardComponent.prototype, "isRemovable", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Output"])(),
        __metadata("design:type", Object)
    ], CardComponent.prototype, "renderEvent", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Output"])(),
        __metadata("design:type", Object)
    ], CardComponent.prototype, "removeEvent", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Output"])(),
        __metadata("design:type", Object)
    ], CardComponent.prototype, "editEvent", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Output"])(),
        __metadata("design:type", Object)
    ], CardComponent.prototype, "saveEvent", void 0);
    CardComponent = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Component"])({
            selector: 'app-card',
            template: __webpack_require__(/*! ./card.component.html */ "./src/app/cardtypes/card/card.component.html"),
            styles: [__webpack_require__(/*! ./card.component.css */ "./src/app/cardtypes/card/card.component.css")]
        })
    ], CardComponent);
    return CardComponent;
}());



/***/ }),

/***/ "./src/app/cardtypes/customizable-timeline/customizable-timeline-dialog/customizable-timeline-dialog.component.css":
/*!*************************************************************************************************************************!*\
  !*** ./src/app/cardtypes/customizable-timeline/customizable-timeline-dialog/customizable-timeline-dialog.component.css ***!
  \*************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = ".timelinePicker {\n  width: 100%;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n\n.timelinePicker .mat-form-field {\n  width: 130px;\n}\n\n.clock {\n  margin-right: 20px;\n  margin-top: 16px;\n  display: inline-block;\n}\n\n.timelineInputs {\n  width: 100%;\n  display: -webkit-inline-box;\n  display: -ms-inline-flexbox;\n  display: inline-flex;\n  margin-bottom: 25px;\n}\n\n.inputTitle {\n  width: 100%;\n}\n\n.mat-radio-button {\n  margin: 5px;\n}\n\n.mat-button-toggle-group {\n  height: 20px !important;\n}\n\n.mat-button-toggle {\n  width: 50px !important;\n}\n\n.mat-card {\n  min-width: 15px;\n  min-height: 15px;\n  padding: 0px;\n}\n\n.inputDescription {\n  width: 100%;\n}\n\n.mat-dialog-actions {\n  float: right;\n}\n\ninput {\n  height: 20px;\n}"

/***/ }),

/***/ "./src/app/cardtypes/customizable-timeline/customizable-timeline-dialog/customizable-timeline-dialog.component.html":
/*!**************************************************************************************************************************!*\
  !*** ./src/app/cardtypes/customizable-timeline/customizable-timeline-dialog/customizable-timeline-dialog.component.html ***!
  \**************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<div class=\"timelinePicker\">\n  <div class=\"clock\">\n    <mat-icon>access_time</mat-icon>\n  </div>\n  <div class=\"timelineInputs\">\n    <mat-form-field>\n      <input matInput [matDatepicker]=\"datePicker\" placeholder=\"Date\" [formControl]=\"dateFormControl\"\n        (click)=\"datePicker.open()\" required>\n      <mat-error *ngIf=\"dateFormControl.invalid\">Invalid date</mat-error>\n      <mat-hint *ngIf=\"dateNotInRange()\">\n        Caution: Date outside of current range\n      </mat-hint>\n      <mat-datepicker #datePicker></mat-datepicker>\n    </mat-form-field>\n    <mat-form-field>\n      <input type=\"time\" matInput [formControl]=\"timeFormControl\" placeholder=\"Time\" [matAutocomplete]=\"auto\" required>\n      <mat-autocomplete #auto=\"matAutocomplete\">\n        <mat-option *ngFor=\"let time of listOfTimes\" [value]=\"time[24]\">\n          {{time[12]}}\n        </mat-option>\n      </mat-autocomplete>\n    </mat-form-field>\n  </div>\n</div>\n<div mat-dialog-content>\n  <mat-form-field class=\"inputTitle\">\n    <input matInput [(ngModel)]=\"userTitle\" placeholder=\"Add title\" required id=\"dialogTitle\">\n    <mat-error>Please enter a title.</mat-error>\n  </mat-form-field>\n  <mat-form-field class=\"inputDescription\">\n    <textarea matInput [(ngModel)]=\"userDescription\" placeholder=\"Add description\" id=\"dialogDescription\"></textarea>\n  </mat-form-field>\n  <div class=\"colorPicker\">\n    <mat-button-toggle-group #group=\"matButtonToggleGroup\" [(ngModel)]=\"selectedColor\" value=\"BOSTON_YELLOW\">\n      <mat-button-toggle *ngFor=\"let color of listOfColors\" [value]=\"color\">\n        <mat-card style.backgroundColor=\"{{color}}\"></mat-card>\n      </mat-button-toggle>\n    </mat-button-toggle-group>\n  </div>\n</div>\n<div mat-dialog-actions>\n  <button mat-button (click)=\"onCancel()\" id=\"cancelButton\" class=\"cancelButton\">Cancel</button>\n  <button [disabled]=\"findIncompleteFields()\" mat-raised-button (click)=\"onSave()\" color=\"primary\"\n    id=\"saveButton\">Save</button>\n</div>"

/***/ }),

/***/ "./src/app/cardtypes/customizable-timeline/customizable-timeline-dialog/customizable-timeline-dialog.component.ts":
/*!************************************************************************************************************************!*\
  !*** ./src/app/cardtypes/customizable-timeline/customizable-timeline-dialog/customizable-timeline-dialog.component.ts ***!
  \************************************************************************************************************************/
/*! exports provided: CustomizableTimelineDialogComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CustomizableTimelineDialogComponent", function() { return CustomizableTimelineDialogComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_forms__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/forms */ "./node_modules/@angular/forms/fesm5/forms.js");
/* harmony import */ var _angular_material__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/material */ "./node_modules/@angular/material/esm5/material.es5.js");
/* harmony import */ var color__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! color */ "./node_modules/color/index.js");
/* harmony import */ var color__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(color__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! luxon */ "./node_modules/luxon/build/cjs-browser/luxon.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(luxon__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var src_app_graphtypes_customizable_graph_customizable_graph_annotation__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! src/app/graphtypes/customizable-graph/customizable-graph-annotation */ "./src/app/graphtypes/customizable-graph/customizable-graph-annotation.ts");
/* harmony import */ var src_app_theme_bch_colors__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! src/app/theme/bch_colors */ "./src/app/theme/bch_colors.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (undefined && undefined.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};





// tslint:disable-next-line:max-line-length

// tslint:disable-next-line:max-line-length

var CustomizableTimelineDialogComponent = /** @class */ (function () {
    function CustomizableTimelineDialogComponent(dialogRef, data) {
        this.dialogRef = dialogRef;
        this.data = data;
        // The list of suggested times to display with the autocomplete.
        this.listOfTimes = [];
        // The list of colors the user will be able to choose from.
        // These colors need to stay consistent with the colored styles in graph.css.
        this.listOfColors = [
            src_app_theme_bch_colors__WEBPACK_IMPORTED_MODULE_6__["BOSTON_YELLOW"], src_app_theme_bch_colors__WEBPACK_IMPORTED_MODULE_6__["BOSTON_GREEN"], src_app_theme_bch_colors__WEBPACK_IMPORTED_MODULE_6__["BOSTON_INDIGO"], src_app_theme_bch_colors__WEBPACK_IMPORTED_MODULE_6__["BOSTON_BAY"], src_app_theme_bch_colors__WEBPACK_IMPORTED_MODULE_6__["BOSTON_PINK"],
            src_app_theme_bch_colors__WEBPACK_IMPORTED_MODULE_6__["BOSTON_LAVENDER"], src_app_theme_bch_colors__WEBPACK_IMPORTED_MODULE_6__["BOSTON_PURPLE"]
        ];
        this.date = new Date(data.date);
        this.dateFormControl = new _angular_forms__WEBPACK_IMPORTED_MODULE_1__["FormControl"](this.date);
        var timeString = this.date.toLocaleTimeString([], { hour12: false, hour: '2-digit', minute: '2-digit' });
        this.timeFormControl = new _angular_forms__WEBPACK_IMPORTED_MODULE_1__["FormControl"](timeString);
        this.generateListOfTimes();
        // Set the default selected color as yellow if unset, or find the BCH Color
        // matching the selected color passed in.
        this.selectedColor = data.color ?
            this.listOfColors.find(function (c) { return c.hex() === data.color.hex(); }) :
            src_app_theme_bch_colors__WEBPACK_IMPORTED_MODULE_6__["BOSTON_YELLOW"];
        // Set the title if it is passed in.
        if (data.title) {
            this.userTitle = data.title;
        }
        // Set the description if it is passed in.
        if (data.description) {
            this.userDescription = data.description;
        }
        if (data.dateRange) {
            this.dateRange = luxon__WEBPACK_IMPORTED_MODULE_4__["Interval"].fromDateTimes(this.data.dateRange.start.toLocal().startOf('day'), this.data.dateRange.end.toLocal().endOf('day'));
        }
    }
    // Closes the dialog popup without saving the user input.
    CustomizableTimelineDialogComponent.prototype.onCancel = function () {
        this.dialogRef.close();
    };
    // Closes the dialog popup and saves user input.
    CustomizableTimelineDialogComponent.prototype.onSave = function () {
        this.dialogRef.close(new src_app_graphtypes_customizable_graph_customizable_graph_annotation__WEBPACK_IMPORTED_MODULE_5__["CustomizableGraphAnnotation"](luxon__WEBPACK_IMPORTED_MODULE_4__["DateTime"].fromJSDate(this.getSelectedDate()), this.userTitle.trim(), this.userDescription, color__WEBPACK_IMPORTED_MODULE_3__["rgb"](this.selectedColor)));
    };
    // Generates a list of times with 30-minute intervals, for the autocomplete
    // time-picker.
    CustomizableTimelineDialogComponent.prototype.generateListOfTimes = function () {
        var interval = 30;
        var date = new Date();
        date.setMinutes(0);
        date.setHours(0);
        for (var time = 0; time <= 24 * 60; time += interval) {
            date.setHours(time / 60);
            date.setMinutes(time % 60);
            // We need the time to be in 12-hour format for the display, but 24-hour
            // format for the actual value passed into the input of type "time".
            this.listOfTimes.push({
                12: date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                24: date.toLocaleTimeString([], { hour12: false, hour: '2-digit', minute: '2-digit' })
            });
        }
    };
    // Constructs a new Date based on user input.
    CustomizableTimelineDialogComponent.prototype.getSelectedDate = function () {
        var dateString = new Date(this.dateFormControl.value).toLocaleDateString();
        var date = new Date(dateString + ' ' + this.timeFormControl.value);
        return date;
    };
    // Finds incomplete fields that are required and disables saving.
    CustomizableTimelineDialogComponent.prototype.findIncompleteFields = function () {
        return !this.userTitle ||
            (this.userTitle && this.userTitle.trim().length === 0) ||
            this.dateFormControl.hasError('required') ||
            this.timeFormControl.hasError('required');
    };
    // Returns whether the date selected by the user falls outside the current
    // date range.
    CustomizableTimelineDialogComponent.prototype.dateNotInRange = function () {
        var dateTime = luxon__WEBPACK_IMPORTED_MODULE_4__["DateTime"].fromJSDate(this.getSelectedDate());
        if (!this.dateRange) {
            return false;
        }
        return !(this.dateRange.contains(dateTime));
    };
    CustomizableTimelineDialogComponent = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Component"])({
            selector: 'app-customizable-timeline-dialog',
            template: __webpack_require__(/*! ./customizable-timeline-dialog.component.html */ "./src/app/cardtypes/customizable-timeline/customizable-timeline-dialog/customizable-timeline-dialog.component.html"),
            styles: [__webpack_require__(/*! ./customizable-timeline-dialog.component.css */ "./src/app/cardtypes/customizable-timeline/customizable-timeline-dialog/customizable-timeline-dialog.component.css")]
        })
        /**
         * A Dialog with a textarea input, used to set the description of points on the
         * CustomizableTimeline.
         */
        // TODO(b/121324544): Use existing libraries for the color and time picker.
        ,
        __param(1, Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Inject"])(_angular_material__WEBPACK_IMPORTED_MODULE_2__["MAT_DIALOG_DATA"])),
        __metadata("design:paramtypes", [_angular_material__WEBPACK_IMPORTED_MODULE_2__["MatDialogRef"], Object])
    ], CustomizableTimelineDialogComponent);
    return CustomizableTimelineDialogComponent;
}());



/***/ }),

/***/ "./src/app/cardtypes/customizable-timeline/customizable-timeline.component.css":
/*!*************************************************************************************!*\
  !*** ./src/app/cardtypes/customizable-timeline/customizable-timeline.component.css ***!
  \*************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "::ng-deep [class*=\"timeline\"] .c3-xgrid-focus {\n  visibility: visible !important;\n}\n\n::ng-deep .timeline .c3 {\n  cursor: default !important;\n}\n\n::ng-deep .inEditMode .timeline .c3 {\n  cursor: pointer !important;\n}\n\n/* Only display icons on flags in the CustomizableGraph if in edit mode. */\n\n::ng-deep app-customizable-graph.inEditMode .showIcon {\n  visibility: visible !important;\n}\n\n::ng-deep [class*=\"tooltip-custom\"] {\n  position: absolute;\n  display: block;\n  font-size: 11px;\n  border-style: solid;\n  padding: 3px;\n  border-width: 1px;\n  border-color: grey;\n  border-radius: 3px;\n  min-height: 25px;\n  width: 160px;\n  max-height: 100px;\n  background-color: white;\n  overflow: auto;\n  color: white;\n}\n\n::ng-deep [class*=\"tooltip-whole\"] {\n  position: absolute;\n  display: block;\n  min-height: 25px;\n  width: 0px;\n  max-height: 100px;\n  border-left-style: solid;\n  border-width: 1px;\n}\n\n::ng-deep [class*=\"tooltip-title-custom\"] {\n  margin: 0px;\n  font-size: small;\n  text-align: center;\n  max-width: 120px;\n  display: inline-block;\n  vertical-align: bottom;\n  min-width: 120px;\n  overflow: auto;\n  margin-top: 5px;\n  overflow-wrap: break-word;\n}\n\n::ng-deep [class*=\"tooltip-details-custom\"] {\n  display: none;\n  overflow: auto;\n  text-align: center;\n  overflow-wrap: break-word;\n  max-width: 120px;\n}\n\n::ng-deep [id*=\"expand\"] {\n  visibility: hidden;\n  vertical-align: middle;\n}\n\n::ng-deep [id*=\"delete\"] {\n  visibility: hidden;\n  vertical-align: middle;\n}\n\n::ng-deep [id*=\"edit\"] {\n  visibility: hidden;\n  margin-top: 8px;\n}\n"

/***/ }),

/***/ "./src/app/cardtypes/customizable-timeline/customizable-timeline.component.html":
/*!**************************************************************************************!*\
  !*** ./src/app/cardtypes/customizable-timeline/customizable-timeline.component.html ***!
  \**************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<app-card [attr.id]=\"id\" label=\"Custom Timeline\" [isDraggable]=\"false\" [isEditable]=\"true\" [isRemovable]=\"true\"\n  color=\"transparent\" (renderEvent)=\"this.renderContainedGraph()\" (editEvent)=\"this.inEditMode = true\"\n  (saveEvent)=\"this.inEditMode = false\" (removeEvent)=\"remove()\" [ngClass]=\"{'inEditMode': inEditMode}\">\n  <ng-container class=\"legends-block\">\n    <div *ngIf=\"inEditMode\">\n      Click on this graph to add a flag for anything you want to keep track of.\n    </div>\n  </ng-container>\n  <div fxFlex=\"row\" class=\"contents-block\">\n    <app-customizable-graph class=\"timeline\" [data]=\"this.data\" [dateRange]=\"this.dateRange\" [inEditMode]=\"inEditMode\"\n      (pointsChanged)=\"pointsChanged($event)\" [ngClass]=\"{'inEditMode': inEditMode}\">\n    </app-customizable-graph>\n  </div>\n</app-card>\n"

/***/ }),

/***/ "./src/app/cardtypes/customizable-timeline/customizable-timeline.component.ts":
/*!************************************************************************************!*\
  !*** ./src/app/cardtypes/customizable-timeline/customizable-timeline.component.ts ***!
  \************************************************************************************/
/*! exports provided: CustomizableTimelineComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CustomizableTimelineComponent", function() { return CustomizableTimelineComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! luxon */ "./node_modules/luxon/build/cjs-browser/luxon.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(luxon__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var src_app_fhir_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! src/app/fhir.service */ "./src/app/fhir.service.ts");
/* harmony import */ var src_app_graphdatatypes_customizabledata__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! src/app/graphdatatypes/customizabledata */ "./src/app/graphdatatypes/customizabledata.ts");
/* harmony import */ var src_app_graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! src/app/graphtypes/graph/graph.component */ "./src/app/graphtypes/graph/graph.component.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
// tslint:disable-next-line:max-line-length





var CustomizableTimelineComponent = /** @class */ (function () {
    function CustomizableTimelineComponent(fhirService) {
        this.fhirService = fhirService;
        // An event indicating that the event lines displayed on all other charts need
        // to be updated.
        this.updateEventLines = new _angular_core__WEBPACK_IMPORTED_MODULE_0__["EventEmitter"]();
        /** Propogate remove events up to the card container.  */
        this.removeEvent = new _angular_core__WEBPACK_IMPORTED_MODULE_0__["EventEmitter"]();
        // Whether or not this CustomizableTimeline is being edited.
        this.inEditMode = false;
        this.data = src_app_graphdatatypes_customizabledata__WEBPACK_IMPORTED_MODULE_3__["CustomizableData"].defaultEmptySeries();
        this.renderContainedGraph();
    }
    CustomizableTimelineComponent.prototype.ngOnChanges = function (changes) {
        if (changes.deletedData && changes.deletedData.currentValue) {
            this.data = this.deletedData;
        }
    };
    // Render the contained graph in the event of a resize.
    CustomizableTimelineComponent.prototype.renderContainedGraph = function () {
        if (this.containedGraph && this.containedGraph.chart) {
            this.inEditMode = false;
            this.containedGraph.generateFromScratch();
        }
    };
    // Listens for an event indicating that the points on the CustomizableGraph
    // have been changed, and emits an event with the modified eventlines
    // displayed on all other charts.
    CustomizableTimelineComponent.prototype.pointsChanged = function ($event) {
        this.updateEventLines.emit({ data: this.data, id: this.id });
    };
    // Called when the user clicks the trashcan button on the card.
    CustomizableTimelineComponent.prototype.remove = function () {
        this.removeEvent.emit({ id: this.id, value: this.data });
    };
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ViewChild"])(src_app_graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["GraphComponent"]),
        __metadata("design:type", src_app_graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["GraphComponent"])
    ], CustomizableTimelineComponent.prototype, "containedGraph", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", String)
    ], CustomizableTimelineComponent.prototype, "id", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", luxon__WEBPACK_IMPORTED_MODULE_1__["Interval"])
    ], CustomizableTimelineComponent.prototype, "dateRange", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", Object)
    ], CustomizableTimelineComponent.prototype, "deletedData", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Output"])(),
        __metadata("design:type", Object)
    ], CustomizableTimelineComponent.prototype, "updateEventLines", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Output"])(),
        __metadata("design:type", Object)
    ], CustomizableTimelineComponent.prototype, "removeEvent", void 0);
    CustomizableTimelineComponent = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Component"])({
            selector: 'app-customizable-timeline',
            template: __webpack_require__(/*! ./customizable-timeline.component.html */ "./src/app/cardtypes/customizable-timeline/customizable-timeline.component.html"),
            styles: [__webpack_require__(/*! ./customizable-timeline.component.css */ "./src/app/cardtypes/customizable-timeline/customizable-timeline.component.css")]
        })
        /**
         * The customizable timeline lets the user plot any events they'd like to keep
         * track of as little flags along a timeline.
         */
        ,
        __metadata("design:paramtypes", [src_app_fhir_service__WEBPACK_IMPORTED_MODULE_2__["FhirService"]])
    ], CustomizableTimelineComponent);
    return CustomizableTimelineComponent;
}());



/***/ }),

/***/ "./src/app/cardtypes/legendstyles.css":
/*!********************************************!*\
  !*** ./src/app/cardtypes/legendstyles.css ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = ".legend {\n  cursor: pointer;\n}\n\n/* This is the color swatch for the legends.*/\n\n.legend span {\n  border-style: solid !important;\n  height: 7px;\n  margin: 3px;\n  vertical-align: center;\n  width: 7px;\n}\n"

/***/ }),

/***/ "./src/app/cardtypes/multigraphcard/multigraphcard.component.ts":
/*!**********************************************************************!*\
  !*** ./src/app/cardtypes/multigraphcard/multigraphcard.component.ts ***!
  \**********************************************************************/
/*! exports provided: MultiGraphCardComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MultiGraphCardComponent", function() { return MultiGraphCardComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_platform_browser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/platform-browser */ "./node_modules/@angular/platform-browser/fesm5/platform-browser.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! luxon */ "./node_modules/luxon/build/cjs-browser/luxon.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(luxon__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var src_app_clinicalconcepts_resource_code_manager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! src/app/clinicalconcepts/resource-code-manager */ "./src/app/clinicalconcepts/resource-code-manager.ts");
/* harmony import */ var _fhir_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../fhir.service */ "./src/app/fhir.service.ts");
/* harmony import */ var _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../graphtypes/graph/graph.component */ "./src/app/graphtypes/graph/graph.component.ts");
/* harmony import */ var _theme_bch_colors__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../theme/bch_colors */ "./src/app/theme/bch_colors.ts");
/* harmony import */ var _card__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../card */ "./src/app/cardtypes/card.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};








/**
 * This card holds a label, one or more graphs on one or more axes, and a
 * dragger handle.
 */
var MultiGraphCardComponent = /** @class */ (function () {
    function MultiGraphCardComponent(fhirService, sanitizer) {
        this.fhirService = fhirService;
        this.sanitizer = sanitizer;
        /** Propogate remove up to the card container.  */
        this.removeEvent = new _angular_core__WEBPACK_IMPORTED_MODULE_0__["EventEmitter"]();
        /**
         * The units text for this card. Blank if the axes have more than one unit.
         */
        this.unitsLabel = '';
        // Holds the color corresponding to this card.
        this.color = _theme_bch_colors__WEBPACK_IMPORTED_MODULE_6__["BOSTON_WARM_GRAY"]; // Default color for a card component.
        // Hold an instance of this enum so the HTML template can reference it.
        this.ChartType = _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_5__["ChartType"];
        // Holds the display groups for the legend.
        this.uniqueDisplayGroups = new Array();
        this.userEditable = false;
    }
    MultiGraphCardComponent.prototype.ngOnInit = function () {
        this.initializeData();
    };
    MultiGraphCardComponent.prototype.initializeData = function () {
        var _this = this;
        var self = this;
        this.card = new _card__WEBPACK_IMPORTED_MODULE_7__["Card"](this.fhirService, this.resourceCodeGroups, this.dateRange, this.sanitizer);
        if (this.resourceCodeGroups) {
            this.label = this.resourceCodeGroups.label;
            this.color = this.resourceCodeGroups.displayGrouping.fill;
            this.getLabelText().then(function (lblText) {
                _this.unitsLabel = lblText;
            });
            if (this.containedGraphs) {
                var unique_1 = new Set();
                this.containedGraphs.forEach(function (graph) {
                    graph.generateFromScratch();
                    Array.from(graph.displayGroupToSeries.keys()).forEach(function (group) {
                        unique_1.add(group);
                    });
                });
                this.uniqueDisplayGroups = Array.from(unique_1.keys());
                this.setRegions();
            }
        }
    };
    // Any time the data range changes, we need to re-request the data for the
    // specified range.
    MultiGraphCardComponent.prototype.ngOnChanges = function (changes) {
        var dateRangeChange = changes['dateRange'];
        if (dateRangeChange &&
            dateRangeChange.previousValue !== dateRangeChange.currentValue) {
            this.initializeData();
        }
    };
    /**
     * Gets the label text for this card. If the axes have all matching units,
     * it returns the units; otherwise it returns a blank string.
     */
    MultiGraphCardComponent.prototype.getLabelText = function () {
        var _this = this;
        return Promise.all(this.card.axes.map(function (axis) { return axis.getDataFromFhir(); }))
            .then(function (dataArray) { return dataArray.map(function (data) { return data.series; }); })
            .then(function (seriesNestedArray) {
            var flattened = [].concat.apply([], seriesNestedArray);
            return flattened.map(function (series) { return series.unit; })
                .filter(function (v) { return v !== undefined; });
        })
            .then(function (allUnits) {
            var units = new Set(allUnits);
            if (units.size === 1 && allUnits[0] !== undefined) {
                return ' (' + allUnits[0] + ')';
            }
            else {
                _this.updateAxisLabels();
                return '';
            }
        });
    };
    /**
     * If the axes on this card have different units, make sure that each
     * axis displays its units on the y-axis, for clarity.
     */
    MultiGraphCardComponent.prototype.updateAxisLabels = function () {
        var _this = this;
        return Promise.all(this.card.axes.map(function (axis) { return axis.getDataFromFhir(); }))
            .then(function () {
            for (var _i = 0, _a = _this.card.axes; _i < _a.length; _i++) {
                var axis = _a[_i];
                if (axis.data && axis.label && axis.data.series &&
                    axis.data.series.length > 0 && axis.data.series[0].unit) {
                    var units = ' (' + axis.data.series[0].unit + ')';
                    // Only add units if not done so already.
                    if (axis.label.indexOf(units) === -1) {
                        axis.label += units;
                    }
                }
            }
        });
    };
    /**
     * Get all the regions for the axes on this card, and plot all the regions on
     * every axis of the card.
     */
    MultiGraphCardComponent.prototype.setRegions = function () {
        var _this = this;
        var allRegions = [];
        Promise.all(this.card.axes.map(function (axis) { return axis.getDataFromFhir(); }))
            .then(function (data) {
            if (data.length > 1) {
                for (var _i = 0, data_1 = data; _i < data_1.length; _i++) {
                    var dataAxis = data_1[_i];
                    if (dataAxis.xRegions) {
                        allRegions = allRegions.concat(dataAxis.xRegions);
                    }
                }
            }
        })
            .then(function (x) {
            return Promise
                .all(_this.card.axes.map(function (axis) {
                return __awaiter(this, void 0, void 0, function () {
                    var _a;
                    return __generator(this, function (_b) {
                        switch (_b.label) {
                            case 0:
                                _a = {};
                                return [4 /*yield*/, axis.getDataFromFhir()];
                            case 1: return [2 /*return*/, (_a.data = _b.sent(), _a.axis = axis, _a)];
                        }
                    });
                });
            }))
                .then(function (d) {
                d.forEach(function (data) {
                    data.data.xRegions =
                        allRegions.filter(function (region) { return (region.axis === 'x'); });
                    data.axis.data = data.data;
                });
                _this.containedGraphs.forEach(function (graph) { return graph.generateFromScratch(); });
            });
        });
    };
    MultiGraphCardComponent.prototype.focusOnDisplayGroup = function (displayGroup) {
        this.containedGraphs.forEach(function (graph) {
            graph.focusOnDisplayGroup(displayGroup);
        });
    };
    MultiGraphCardComponent.prototype.resetChart = function (displayGroup) {
        this.containedGraphs.forEach(function (graph) {
            graph.resetChart(displayGroup);
        });
    };
    // The events below need to get propogated up to the card container.
    // Called when the user clicks the trashcan button on the card.
    MultiGraphCardComponent.prototype.remove = function () {
        // We do not add a 'value' field because there is no internal value that
        // needs to be restored when the user reverts a deletion.
        this.removeEvent.emit({ id: this.id });
    };
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ViewChildren"])(_graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_5__["GraphComponent"]),
        __metadata("design:type", _angular_core__WEBPACK_IMPORTED_MODULE_0__["QueryList"])
    ], MultiGraphCardComponent.prototype, "containedGraphs", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", String)
    ], MultiGraphCardComponent.prototype, "id", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", luxon__WEBPACK_IMPORTED_MODULE_2__["Interval"])
    ], MultiGraphCardComponent.prototype, "dateRange", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", src_app_clinicalconcepts_resource_code_manager__WEBPACK_IMPORTED_MODULE_3__["ResourceCodesForCard"])
    ], MultiGraphCardComponent.prototype, "resourceCodeGroups", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", Array)
    ], MultiGraphCardComponent.prototype, "eventlines", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Output"])(),
        __metadata("design:type", Object)
    ], MultiGraphCardComponent.prototype, "removeEvent", void 0);
    MultiGraphCardComponent = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Component"])({
            selector: 'app-multigraphcard',
            styles: [__webpack_require__(/*! ../legendstyles.css */ "./src/app/cardtypes/legendstyles.css")],
            template: __webpack_require__(/*! ./multigraphcard.html */ "./src/app/cardtypes/multigraphcard/multigraphcard.html"),
        }),
        __metadata("design:paramtypes", [_fhir_service__WEBPACK_IMPORTED_MODULE_4__["FhirService"], _angular_platform_browser__WEBPACK_IMPORTED_MODULE_1__["DomSanitizer"]])
    ], MultiGraphCardComponent);
    return MultiGraphCardComponent;
}());



/***/ }),

/***/ "./src/app/cardtypes/multigraphcard/multigraphcard.html":
/*!**************************************************************!*\
  !*** ./src/app/cardtypes/multigraphcard/multigraphcard.html ***!
  \**************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<app-card [id]=\"id\" [color]=\"this.color.hsl().string()\" [label]=\"label + unitsLabel\" (removeEvent)=\"remove()\">\n  <ng-container class=\"legends-block\">\n    <ng-container *ngIf=\"uniqueDisplayGroups.length > 1\">\n      <div fxLayout=\"row\" class=\"legend\" *ngFor=\"let displayGroup of uniqueDisplayGroups\"\n        (mouseover)=\"focusOnDisplayGroup(displayGroup, $event)\" (mouseout)=\"resetChart(displayGroup, $event)\">\n        <span [style.background-color]=\"displayGroup.fill.hsl().string()\"\n          [style.border]=\"displayGroup.outline.hsl().string()\">\n        </span>\n        <div fxFlex class=\"mat-body\">{{displayGroup.label}}</div>\n      </div>\n    </ng-container>\n  </ng-container>\n  <div fxFlex fxLayout=\"column\" class=\"contents-block\">\n    <div fxFlex *ngFor=\"let axis of card.axes\" fxShrink=\"0\" fxGrow=\"0\">\n      <mat-spinner *ngIf=\"!axis.isResolved\" [diameter]=\"30\"></mat-spinner>\n      <div *ngIf=\"axis.isResolved && axis.errorMessage\">\n        {{axis.errorMessage}}\n      </div>\n      <ng-container *ngIf=\"axis.isResolved && !axis.errorMessage\" [ngSwitch]=\"axis.chartType\">\n        <app-linegraph *ngSwitchCase=\"ChartType.LINE\" [data]=\"axis.data\" [dateRange]=\"this.dateRange\"\n          [eventlines]=\"this.eventlines\" [axisLabel]=\"axis.label\" [showTicks]=\"axis.showTicks\"></app-linegraph>\n        <app-scatterplot *ngSwitchCase=\"ChartType.SCATTER\" [data]=\"axis.data\" [dateRange]=\"this.dateRange\"\n          [eventlines]=\"this.eventlines\" [axisLabel]=\"axis.label\" [showTicks]=\"axis.showTicks\"></app-scatterplot>\n        <app-stepgraph class=\"stepgraph\" *ngSwitchCase=\"ChartType.STEP\" [data]=\"axis.data\" [dateRange]=\"this.dateRange\"\n          [eventlines]=\"this.eventlines\" [axisLabel]=\"axis.label\">\n        </app-stepgraph>\n        <app-microbio-graph *ngSwitchCase=\"ChartType.MICROBIO\" [data]=\"axis.data\" [dateRange]=\"this.dateRange\"\n          [eventlines]=\"this.eventlines\" [axisLabel]=\"axis.label\"></app-microbio-graph>\n      </ng-container>\n    </div>\n  </div>\n</app-card>"

/***/ }),

/***/ "./src/app/cardtypes/textboxcard/textboxcard.component.html":
/*!******************************************************************!*\
  !*** ./src/app/cardtypes/textboxcard/textboxcard.component.html ***!
  \******************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<app-card [id]=\"id\" [isEditable]=\"true\" (removeEvent)=\"remove()\" (editEvent)=\"edit()\" (saveEvent)=\"save()\"\n  [ngClass]=\"{'inEditMode': inEditMode}\">\n  <ng-container class=\"contents-block\">\n    <mat-form-field style=\"width: 95%;\">\n      <textarea #textArea matInput matTextareaAutosize placeholder=\"Add annotation here.\" [disabled]=\"!inEditMode\"\n        (change)=\"updateValue()\" [(ngModel)]=\"noteString\">\n    </textarea>\n      <mat-hint> {{getHintText()}} </mat-hint>\n    </mat-form-field>\n  </ng-container>\n</app-card>\n"

/***/ }),

/***/ "./src/app/cardtypes/textboxcard/textboxcard.component.ts":
/*!****************************************************************!*\
  !*** ./src/app/cardtypes/textboxcard/textboxcard.component.ts ***!
  \****************************************************************/
/*! exports provided: TextboxcardComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextboxcardComponent", function() { return TextboxcardComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};

var TextboxcardComponent = /** @class */ (function () {
    function TextboxcardComponent() {
        /** Propogate remove events up to the card container.  */
        this.removeEvent = new _angular_core__WEBPACK_IMPORTED_MODULE_0__["EventEmitter"]();
        this.inEditMode = false;
    }
    TextboxcardComponent.prototype.updateValue = function () {
        this.textAreaElement.nativeElement.innerHTML = this.noteString;
    };
    // The events below need to get propogated up to the card container.
    // Called when the user clicks the trashcan button on the card.
    TextboxcardComponent.prototype.remove = function () {
        // We pass a 'value' field with the contents of the textbox so that, in case
        // of restoration of a deleted textbox, the previous value can be displayed.
        this.removeEvent.emit({ id: this.id, value: this.noteString });
    };
    TextboxcardComponent.prototype.edit = function () {
        this.inEditMode = true;
    };
    TextboxcardComponent.prototype.save = function () {
        this.inEditMode = false;
    };
    TextboxcardComponent.prototype.getHintText = function () {
        if (this.inEditMode) {
            return 'Click the save button to save annotation';
        }
        else {
            return 'Click the edit button to modify annotation';
        }
    };
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ViewChild"])('textArea'),
        __metadata("design:type", _angular_core__WEBPACK_IMPORTED_MODULE_0__["ElementRef"])
    ], TextboxcardComponent.prototype, "textAreaElement", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", String)
    ], TextboxcardComponent.prototype, "id", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Output"])(),
        __metadata("design:type", Object)
    ], TextboxcardComponent.prototype, "removeEvent", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", String)
    ], TextboxcardComponent.prototype, "noteString", void 0);
    TextboxcardComponent = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Component"])({
            selector: 'app-textboxcard',
            template: __webpack_require__(/*! ./textboxcard.component.html */ "./src/app/cardtypes/textboxcard/textboxcard.component.html"),
        })
        /**
         * A Material Card that displays a label, a textbox, and a draggable handle
         * in a row.
         */
    ], TextboxcardComponent);
    return TextboxcardComponent;
}());



/***/ }),

/***/ "./src/app/clinicalconcepts/bch-microbio-code.ts":
/*!*******************************************************!*\
  !*** ./src/app/clinicalconcepts/bch-microbio-code.ts ***!
  \*******************************************************/
/*! exports provided: BCHMicrobioCode, BCHMicrobioCodeGroup */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BCHMicrobioCode", function() { return BCHMicrobioCode; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BCHMicrobioCodeGroup", function() { return BCHMicrobioCodeGroup; });
/* harmony import */ var src_constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! src/constants */ "./src/constants.ts");
/* harmony import */ var _resource_code_group__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./resource-code-group */ "./src/app/clinicalconcepts/resource-code-group.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();


/**
 * Holds BCHMicrobioCode codes. BCH provides a custom mapping for their
 * microbiology data since retrieving it is not yet supported in the Cerner
 * FHIR API implementation.
 */
var BCHMicrobioCode = /** @class */ (function (_super) {
    __extends(BCHMicrobioCode, _super);
    function BCHMicrobioCode() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    BCHMicrobioCode.prototype.dataAvailableInAppTimeScope = function () {
        return Promise.resolve(false);
    };
    BCHMicrobioCode.CODING_STRING = 'http://cerner.com/bch_mapping/';
    return BCHMicrobioCode;
}(_resource_code_group__WEBPACK_IMPORTED_MODULE_1__["ResourceCode"]));

/**
 * Represents one or more LOINC codes that should be displayed together. In the
 * case of multiple LOINC codes in a group, you should provide a label for that
 * group.
 */
var BCHMicrobioCodeGroup = /** @class */ (function (_super) {
    __extends(BCHMicrobioCodeGroup, _super);
    function BCHMicrobioCodeGroup() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    /**
     * Gets a list of DiagnosticReports corresponding to this code group. Each
     * item in the list has the same specimen type as the label of this group, and
     * each report's list of results has a code that is in this group's list of
     * codes.
     */
    BCHMicrobioCodeGroup.prototype.getResourceFromFhir = function (dateRange) {
        return this.fhirService.getDiagnosticReports(this, dateRange)
            .then(function (result) {
            return result;
        });
    };
    /**
     * Returns whether there is any data available for this ResourceCode within
     * the fixed timescope of this app.
     * @override
     */
    BCHMicrobioCodeGroup.prototype.dataAvailableInAppTimeScope = function () {
        return this.fhirService.diagnosticReportsPresentWithCodes(this, src_constants__WEBPACK_IMPORTED_MODULE_0__["APP_TIMESPAN"]);
    };
    return BCHMicrobioCodeGroup;
}(_resource_code_group__WEBPACK_IMPORTED_MODULE_1__["CachedResourceCodeGroup"]));



/***/ }),

/***/ "./src/app/clinicalconcepts/display-grouping.ts":
/*!******************************************************!*\
  !*** ./src/app/clinicalconcepts/display-grouping.ts ***!
  \******************************************************/
/*! exports provided: ALL_DISPLAY_GROUPS_MAP, DisplayGrouping, labResult, vitalSign, culture, med, document, microbio, posPrelimMB, negPrelimMB, posFinalMB, negFinalMB */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ALL_DISPLAY_GROUPS_MAP", function() { return ALL_DISPLAY_GROUPS_MAP; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DisplayGrouping", function() { return DisplayGrouping; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "labResult", function() { return labResult; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "vitalSign", function() { return vitalSign; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "culture", function() { return culture; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "med", function() { return med; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "document", function() { return document; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "microbio", function() { return microbio; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "posPrelimMB", function() { return posPrelimMB; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "negPrelimMB", function() { return negPrelimMB; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "posFinalMB", function() { return posFinalMB; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "negFinalMB", function() { return negFinalMB; });
/* harmony import */ var color__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! color */ "./node_modules/color/index.js");
/* harmony import */ var color__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(color__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _theme_bch_colors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../theme/bch_colors */ "./src/app/theme/bch_colors.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.


var ALL_DISPLAY_GROUPS_MAP = new Map();
/**
 * Represents the category that a certain chart's data might fall into, for
 * example a MedicationConcept such as "Antibiotic" or a ClinicalConcept such as
 * "Lab result"
 */
var DisplayGrouping = /** @class */ (function () {
    function DisplayGrouping(label, color, outline) {
        this.label = label;
        var tempColor = color;
        if (color === undefined) {
            tempColor = _theme_bch_colors__WEBPACK_IMPORTED_MODULE_1__["getDataColors"]()[DisplayGrouping.colorIdx];
            DisplayGrouping.colorIdx =
                (DisplayGrouping.colorIdx + 1) % _theme_bch_colors__WEBPACK_IMPORTED_MODULE_1__["getDataColors"]().length;
        }
        this.fill = tempColor;
        this.outline = outline ? outline : tempColor;
        ALL_DISPLAY_GROUPS_MAP.set(label, this);
    }
    DisplayGrouping.colorIdx = 0;
    return DisplayGrouping;
}());

var labResult = new DisplayGrouping('Lab Results', _theme_bch_colors__WEBPACK_IMPORTED_MODULE_1__["MATERIAL_GREEN"]);
var vitalSign = new DisplayGrouping('Vital Signs', _theme_bch_colors__WEBPACK_IMPORTED_MODULE_1__["MATERIAL_YELLOW"]);
var culture = new DisplayGrouping('Cultures', _theme_bch_colors__WEBPACK_IMPORTED_MODULE_1__["BOSTON_WARM_GRAY"]);
var med = new DisplayGrouping('Vancomycin and Gentamicin', _theme_bch_colors__WEBPACK_IMPORTED_MODULE_1__["MATERIAL_TEAL"]);
var document = new DisplayGrouping('Document', _theme_bch_colors__WEBPACK_IMPORTED_MODULE_1__["BOSTON_BAY"]);
var microbio = new DisplayGrouping('Microbiology', _theme_bch_colors__WEBPACK_IMPORTED_MODULE_1__["MATERIAL_ORANGE"]);
// We declare more DisplayGroupings related to Microbiology results that are
// used to classify points on the Microbiology chart.
var posPrelimMB = new DisplayGrouping('Check Result Preliminary', color__WEBPACK_IMPORTED_MODULE_0__('#e4e2e2'), _theme_bch_colors__WEBPACK_IMPORTED_MODULE_1__["BOSTON_YELLOW"]);
var negPrelimMB = new DisplayGrouping('Negative Preliminary', color__WEBPACK_IMPORTED_MODULE_0__('#e4e2e2'), _theme_bch_colors__WEBPACK_IMPORTED_MODULE_1__["BOSTON_BLUE"]);
var posFinalMB = new DisplayGrouping('Check Result Final', _theme_bch_colors__WEBPACK_IMPORTED_MODULE_1__["BOSTON_YELLOW"]);
var negFinalMB = new DisplayGrouping('Negative Final', _theme_bch_colors__WEBPACK_IMPORTED_MODULE_1__["BOSTON_BLUE"]);


/***/ }),

/***/ "./src/app/clinicalconcepts/loinc-code.ts":
/*!************************************************!*\
  !*** ./src/app/clinicalconcepts/loinc-code.ts ***!
  \************************************************/
/*! exports provided: LOINCCode, LOINCCodeGroup */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LOINCCode", function() { return LOINCCode; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LOINCCodeGroup", function() { return LOINCCodeGroup; });
/* harmony import */ var src_constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! src/constants */ "./src/constants.ts");
/* harmony import */ var _fhir_data_classes_annotated_observation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../fhir-data-classes/annotated-observation */ "./src/app/fhir-data-classes/annotated-observation.ts");
/* harmony import */ var _fhir_data_classes_observation_set__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../fhir-data-classes/observation-set */ "./src/app/fhir-data-classes/observation-set.ts");
/* harmony import */ var _resource_code_group__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./resource-code-group */ "./src/app/clinicalconcepts/resource-code-group.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();





/**
 * Holds LOINC codes.
 */
var LOINCCode = /** @class */ (function (_super) {
    __extends(LOINCCode, _super);
    function LOINCCode() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    LOINCCode.prototype.dataAvailableInAppTimeScope = function (fhirService) {
        return fhirService.observationsPresentWithCode(this, src_constants__WEBPACK_IMPORTED_MODULE_0__["APP_TIMESPAN"]);
    };
    LOINCCode.CODING_STRING = 'http://loinc.org';
    return LOINCCode;
}(_resource_code_group__WEBPACK_IMPORTED_MODULE_3__["ResourceCode"]));

/**
 * Represents one or more LOINC codes that should be displayed together. In the
 * case of multiple LOINC codes in a group, you should provide a label for that
 * group.
 */
var LOINCCodeGroup = /** @class */ (function (_super) {
    __extends(LOINCCodeGroup, _super);
    function LOINCCodeGroup(
    /** FHIR service for retrieving data */
    fhirService, 
    /** The label for this resource code group. */
    label, 
    /** The resource codes to display on this Axis. */
    resourceCodes, 
    /** The display grouping for this resource code group. */
    displayGrouping, 
    /** The chart type for this Axis. */
    chartType, 
    /** Absolute axis bounds for the graph displaying this ResourceCode. */
    displayBounds, 
    /**
     * Whether or not to force the axis bounds, even if a smaller range
     * containing all the data can be calculated.
     */
    forceDisplayBounds, 
    /**
     * The (optional) function that will make an observation into an
     * AnnotatedObservation so that the graph can show the appropriate
     * tooltip.
     */
    makeAnnotated) {
        if (forceDisplayBounds === void 0) { forceDisplayBounds = false; }
        var _this = _super.call(this, fhirService, label, resourceCodes, displayGrouping, chartType, displayBounds, forceDisplayBounds) || this;
        _this.fhirService = fhirService;
        _this.label = label;
        _this.resourceCodes = resourceCodes;
        _this.displayGrouping = displayGrouping;
        _this.chartType = chartType;
        _this.displayBounds = displayBounds;
        _this.forceDisplayBounds = forceDisplayBounds;
        _this.makeAnnotated = makeAnnotated;
        // If there's only one resource code in the group, just use its display
        // bounds as the axis bounds.
        if (!displayBounds && resourceCodes.length === 1) {
            _this.displayBounds = resourceCodes[0].displayBounds;
        }
        return _this;
    }
    /**
     * Gets one ObservationSet for each LOINCCode in this group, and returns
     * a list of those ObservationSets.
     * If an Observation contains "inner components", this returns separate
     * ObservationSets for those LOINCCodes, provided that they are mapped.
     */
    LOINCCodeGroup.prototype.getResourceFromFhir = function (dateRange) {
        var _this = this;
        var maxPrecision = 0;
        return this.fhirService.getObservationsForCodeGroup(this, dateRange)
            .then(function (observationDoubleArray) {
            // Unnest the inner and outer observations into one flattened
            // array per concept group.
            return observationDoubleArray.map(function (obsSingleArray) {
                return Array.from(obsSingleArray)
                    .reduce(function (acc, observation) {
                    // The outer component may not have a
                    // value or result.
                    if (observation.value || observation.result ||
                        observation.interpretation) {
                        acc.push(observation);
                    }
                    // Add separate ObservationLists for
                    // each inner component.
                    if (observation.innerComponents.length > 0) {
                        for (var _i = 0, _a = observation.innerComponents; _i < _a.length; _i++) {
                            var innerComponent = _a[_i];
                            acc.push(innerComponent);
                        }
                    }
                    return acc;
                }, []);
            });
        }, function (rejection) {
            // If there is any error with constructing an Observation for any
            // code in this code group, throw the error.
            throw rejection;
        })
            .then(function (flattened) {
            var mapObs = new Map();
            flattened.forEach(function (conceptList) {
                for (var _i = 0, conceptList_1 = conceptList; _i < conceptList_1.length; _i++) {
                    var observation = conceptList_1[_i];
                    // From this point on, each observation should have a value,
                    // result, or interpretation. All observations that just had
                    // innerComponents have been flattened out.
                    var obsList = mapObs.get(observation.label);
                    if (!obsList) {
                        obsList = new Array();
                    }
                    if (observation.precision > maxPrecision) {
                        maxPrecision = observation.precision;
                    }
                    if (_this.makeAnnotated) {
                        obsList.push(_this.makeAnnotated(observation, dateRange));
                    }
                    else {
                        obsList.push(Promise.resolve(new _fhir_data_classes_annotated_observation__WEBPACK_IMPORTED_MODULE_1__["AnnotatedObservation"](observation)));
                    }
                    mapObs.set(observation.label, obsList);
                }
            });
            _this.precision = maxPrecision;
            return Array.from(mapObs.values());
        })
            .then(function (doubleAnnotationArray) { return doubleAnnotationArray.map(function (singleAnnotationArray) {
            return Promise.all(singleAnnotationArray)
                .then(function (resolvedAnnotations) {
                return new _fhir_data_classes_observation_set__WEBPACK_IMPORTED_MODULE_2__["ObservationSet"](resolvedAnnotations);
            });
        }); })
            .then(function (observationSetArray) { return Promise.all(observationSetArray); });
    };
    return LOINCCodeGroup;
}(_resource_code_group__WEBPACK_IMPORTED_MODULE_3__["CachedResourceCodeGroup"]));



/***/ }),

/***/ "./src/app/clinicalconcepts/resource-code-group.ts":
/*!*********************************************************!*\
  !*** ./src/app/clinicalconcepts/resource-code-group.ts ***!
  \*********************************************************/
/*! exports provided: ResourceCode, ResourceCodeGroup, CachedResourceCodeGroup */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResourceCode", function() { return ResourceCode; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResourceCodeGroup", function() { return ResourceCodeGroup; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CachedResourceCodeGroup", function() { return CachedResourceCodeGroup; });
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
/**
 * A code specifying the medication or observation type as well as the specific
 * medication or observation.
 */
var ResourceCode = /** @class */ (function () {
    function ResourceCode(codeString, displayGrouping, label, showByDefault, 
    /* Absolute axis bounds for the graph displaying this ResourceCode. */
    displayBounds, 
    /* Whether or not to force the axis bounds, even if a smaller range
       containing all the data can be calculated. */
    forceDisplayBounds) {
        if (showByDefault === void 0) { showByDefault = false; }
        if (forceDisplayBounds === void 0) { forceDisplayBounds = false; }
        this.codeString = codeString;
        this.displayGrouping = displayGrouping;
        this.label = label;
        this.showByDefault = showByDefault;
        this.displayBounds = displayBounds;
        this.forceDisplayBounds = forceDisplayBounds;
        ResourceCode.CODE_STRING_TO_CODE[codeString] = this;
    }
    ResourceCode.fromCodeString = function (code) {
        return ResourceCode.CODE_STRING_TO_CODE[code];
    };
    ResourceCode.CODE_STRING_TO_CODE = {};
    return ResourceCode;
}());

/**
 * A class that holds a group of resource codes that should be displayed on
 * the same Axis together.
 */
var ResourceCodeGroup = /** @class */ (function () {
    function ResourceCodeGroup(fhirService, 
    /** The label for this resource code group. */
    label, 
    /** The resource codes to display on this Axis. */
    resourceCodes, 
    /** The display grouping for this resource code group. */
    displayGrouping, 
    /** The chart type for this Axis. */
    chartType, 
    /** Absolute axis bounds for the graph displaying this ResourceCode. */
    displayBounds, 
    /**
     * Whether or not to force the axis bounds, even if a smaller range
     * containing all the data can be calculated.
     */
    forceDisplayBounds) {
        if (forceDisplayBounds === void 0) { forceDisplayBounds = false; }
        this.fhirService = fhirService;
        this.label = label;
        this.resourceCodes = resourceCodes;
        this.displayGrouping = displayGrouping;
        this.chartType = chartType;
        this.displayBounds = displayBounds;
        this.forceDisplayBounds = forceDisplayBounds;
        // The number of decimal places to show for any value associated with this
        // resource group. The default is 0, to minimize errors caused by unnecessary
        // trailing zeros.
        this.precision = 0;
        this.showByDefault = this.resourceCodes.some(function (code) { return code.showByDefault; });
    }
    /**
     * Returns whether there is any data available for this ResourceCode within
     * the fixed timescope of this app.
     */
    ResourceCodeGroup.prototype.dataAvailableInAppTimeScope = function () {
        var _this = this;
        return Promise
            .all(this.resourceCodes.map(function (rc) { return rc.dataAvailableInAppTimeScope(_this.fhirService); }))
            .then(function (bools) { return bools.reduce(function (result, next) { return result = result || next; }); });
    };
    return ResourceCodeGroup;
}());

/**
 * CachedResourceCodeGroups cache their retrieved data in a dictionary keyed
 * by time interval.
 * @param T The type of data to be cached.
 */
var CachedResourceCodeGroup = /** @class */ (function (_super) {
    __extends(CachedResourceCodeGroup, _super);
    function CachedResourceCodeGroup() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.dataCache = new Map();
        return _this;
    }
    /**
     * Looks in the cache to see if data for this time interval exists. If not,
     * calls the implementing class's getResourceFromFhir function and caches
     * its data, then returns the data for the given time interval.
     */
    CachedResourceCodeGroup.prototype.getResourceSet = function (dateRange) {
        var _this = this;
        if (this.dataCache.has(dateRange)) {
            return Promise.resolve(this.dataCache.get(dateRange));
        }
        else {
            return this.getResourceFromFhir(dateRange).then(function (res) {
                _this.dataCache.set(dateRange, res);
                return Promise.resolve(_this.dataCache.get(dateRange));
            }, function (rejection) {
                // If there is any error with getting the resources for this
                // ResourceCodeGroup, throw an error.
                throw rejection;
            });
        }
    };
    return CachedResourceCodeGroup;
}(ResourceCodeGroup));



/***/ }),

/***/ "./src/app/clinicalconcepts/resource-code-manager.ts":
/*!***********************************************************!*\
  !*** ./src/app/clinicalconcepts/resource-code-manager.ts ***!
  \***********************************************************/
/*! exports provided: documentReferenceLoinc, diastolicBP, systolicBP, ResourceCodesForCard, ResourceCodeManager */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "documentReferenceLoinc", function() { return documentReferenceLoinc; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "diastolicBP", function() { return diastolicBP; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "systolicBP", function() { return systolicBP; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResourceCodesForCard", function() { return ResourceCodesForCard; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResourceCodeManager", function() { return ResourceCodeManager; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../clinicalconcepts/loinc-code */ "./src/app/clinicalconcepts/loinc-code.ts");
/* harmony import */ var _fhir_data_classes_annotated_observation__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../fhir-data-classes/annotated-observation */ "./src/app/fhir-data-classes/annotated-observation.ts");
/* harmony import */ var _fhir_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../fhir.service */ "./src/app/fhir.service.ts");
/* harmony import */ var _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../graphtypes/graph/graph.component */ "./src/app/graphtypes/graph/graph.component.ts");
/* harmony import */ var _bch_microbio_code__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./bch-microbio-code */ "./src/app/clinicalconcepts/bch-microbio-code.ts");
/* harmony import */ var _display_grouping__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./display-grouping */ "./src/app/clinicalconcepts/display-grouping.ts");
/* harmony import */ var _rx_norm__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./rx-norm */ "./src/app/clinicalconcepts/rx-norm.ts");
/* harmony import */ var _rx_norm_group__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./rx-norm-group */ "./src/app/clinicalconcepts/rx-norm-group.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};










// We declare a new LOINCCode referencing a DocumentReference, but do not
// include it in the groupings below because it is not graphed/displayed in the
// configuration sidebar.
var documentReferenceLoinc = new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('68608-9', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["document"], 'Summary', true);
var ovaAndParasiteExam = new _bch_microbio_code__WEBPACK_IMPORTED_MODULE_5__["BCHMicrobioCode"]('OVAANDPARASITEEXAM', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["microbio"], 'Ovo and Parasite Exam', false);
var salmonella = new _bch_microbio_code__WEBPACK_IMPORTED_MODULE_5__["BCHMicrobioCode"]('SALMONELLAANDSHIGELLACULTURE', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["microbio"], 'Salmonella and Shigella Culture', false);
var diastolicBP = new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('8462-4', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["vitalSign"], 'Diastolic Blood Pressure', true, [25, 150]);
var systolicBP = new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('8480-6', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["vitalSign"], 'Systolic Blood Pressure', true, [30, 250]);
var ResourceCodesForCard = /** @class */ (function () {
    function ResourceCodesForCard(resourceCodeGroups, label, displayGrouping) {
        var _this = this;
        // Throw an error if the DisplayGroupings don't match each other or the
        // provided DisplayGrouping for the card.
        if (!resourceCodeGroups.every(function (x) { return x.displayGrouping === displayGrouping; })) {
            throw Error('All ResourceCodeGroups in the same card must ' +
                'have the same DisplayGrouping');
        }
        this.resourceCodeGroups = resourceCodeGroups;
        this.label = label;
        this.displayGrouping = displayGrouping;
        Promise
            .all(this.resourceCodeGroups.map(function (rsc) { return rsc.dataAvailableInAppTimeScope(); }))
            .then(function (rsc) {
            var flattened = [].concat.apply([], rsc);
            _this.dataAvailable =
                flattened.reduce(function (prev, curr) { return prev || curr; }, false);
        });
    }
    return ResourceCodesForCard;
}());

/**
 * ResourceCodeManager is the centralized class where other components can
 * look to find an exhaustive listing of all the resource code groups that the
 * application may display.
 * TODO(b/119185198): Eventually RxNorms should be listed here, too.
 */
var ResourceCodeManager = /** @class */ (function () {
    function ResourceCodeManager(fhirService) {
        this.fhirService = fhirService;
        if (!ResourceCodeManager_1.resourceCodeGroups) {
            var codeGroups = [];
            // All the labs and vitals are linecharts and displayed on
            // independent axes.
            for (var _i = 0, _a = ResourceCodeManager_1.typeToPairs; _i < _a.length; _i++) {
                var _b = _a[_i], conceptGroup = _b[0], codePairs = _b[1];
                for (var _c = 0, codePairs_1 = codePairs; _c < codePairs_1.length; _c++) {
                    var loinc = codePairs_1[_c];
                    codeGroups.push(new ResourceCodesForCard([new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCodeGroup"](this.fhirService, loinc.label, new Array(loinc), conceptGroup, _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["ChartType"].LINE, loinc.displayBounds, loinc.forceDisplayBounds)], loinc.label, conceptGroup));
                }
            }
            var bpIndex = codeGroups.findIndex(function (codeGroup) { return codeGroup.label === 'Blood Pressure'; });
            // Mean Arterial Pressure is recorded as a separate LOINCCode, but include
            // it on the same axis as Systolic/Diastolic BP.
            codeGroups[bpIndex].resourceCodeGroups[0].resourceCodes.push(new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('76214-6', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["vitalSign"], 'Mean Arterial Pressure', true));
            // Make a LOINCodeGroup for Blood pressure location.
            var bpLocation_1 = new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCodeGroup"](this.fhirService, 'Blood Pressure Details', [new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('41904-4', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["vitalSign"], 'Blood Pressure Location', true)], _display_grouping__WEBPACK_IMPORTED_MODULE_6__["vitalSign"], _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["ChartType"].SCATTER);
            // Modify the existing BP LOINCCodeGroup to included annotated
            // Observations containing the BP locations.
            var bpLoincGroup = new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCodeGroup"](this.fhirService, 'Blood Pressure', codeGroups[bpIndex].resourceCodeGroups[0].resourceCodes, _display_grouping__WEBPACK_IMPORTED_MODULE_6__["vitalSign"], _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["ChartType"].LINE, undefined, // No display bounds
            false, function (observation, dateRange) {
                return bpLocation_1.getResourceSet(dateRange).then(function (obsSet) {
                    return _fhir_data_classes_annotated_observation__WEBPACK_IMPORTED_MODULE_2__["AnnotatedObservation"].forBloodPressure(observation, 
                    // We only pass in the first ObservationSet, since we know
                    // there is only one code whose observations we care about.
                    obsSet[0]);
                });
            });
            // Replace (in place) the original BP ResourceCodesForCard with the
            // modified information.
            codeGroups[bpIndex] = new ResourceCodesForCard([bpLoincGroup], codeGroups[bpIndex].label, _display_grouping__WEBPACK_IMPORTED_MODULE_6__["vitalSign"]);
            var cbc = [
                new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCodeGroup"](this.fhirService, 'Hematocrit', [new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('4544-3', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Hematocrit', false, [10, 70])], _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["ChartType"].LINE, [10, 70]),
                new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCodeGroup"](this.fhirService, 'Hemoglobin', [new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('718-7', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Hemoglobin', false, [0.5, 30])], _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["ChartType"].LINE, [0.5, 30]),
                // TODO: add Platelet
                new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCodeGroup"](this.fhirService, 'White Blood Cell', [new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('26464-8', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'White Blood Cell', false)], _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["ChartType"].LINE),
            ];
            codeGroups.push(new ResourceCodesForCard(cbc, 'Complete Blood Count', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"]));
            var cbcWBC = [
                new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCodeGroup"](this.fhirService, 'Neutrophil/Band', [new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('35332-6', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Neutrophil/Band', true, [0, 100])], _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["ChartType"].LINE, [0, 100]),
                // TODO: add Immature Granulocytes
                // TODO: add Lymphocyte
                new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCodeGroup"](this.fhirService, 'Monocyte', [new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('5905-5', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Monocyte', false, [0, 100])], _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["ChartType"].LINE, [0, 100]),
                new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCodeGroup"](this.fhirService, 'Eosinophil', [new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('713-8', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Eosinophil', false, [0, 100])], _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["ChartType"].LINE, [0, 100]),
                new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCodeGroup"](this.fhirService, 'Basophil', [new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('706-2', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Basophil', false, [0, 100])], _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["ChartType"].LINE, [0, 100]),
            ];
            codeGroups.push(new ResourceCodesForCard(cbcWBC, 'Complete Blood Count White Blood Cell', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"]));
            // TODO(b/118874488): Allow for configuration of RxNormCodeGroups.
            var medsSummaryGroup = _rx_norm__WEBPACK_IMPORTED_MODULE_7__["RXNORM_CODES"];
            codeGroups.push(new ResourceCodesForCard([new _rx_norm_group__WEBPACK_IMPORTED_MODULE_8__["RxNormCodeGroup"](this.fhirService, 'Vancomycin & Gentamicin Summary', medsSummaryGroup, _display_grouping__WEBPACK_IMPORTED_MODULE_6__["med"], _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["ChartType"].STEP)], 'Vancomycin & Gentamicin Summary', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["med"]));
            // Drug monitoring should be a scatterplot, and the related concepts
            // should be displayed on the same axes.
            var vancRxNorm_1 = new _rx_norm_group__WEBPACK_IMPORTED_MODULE_8__["RxNormCodeGroup"](this.fhirService, 'Medication Administrations', [_rx_norm__WEBPACK_IMPORTED_MODULE_7__["RxNormCode"].fromCodeString('11124')], _display_grouping__WEBPACK_IMPORTED_MODULE_6__["med"], _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["ChartType"].SCATTER);
            // Drug monitoring should be a scatterplot, and the related concepts
            // should be displayed on the same axes.
            codeGroups.push(new ResourceCodesForCard([
                vancRxNorm_1,
                new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCodeGroup"](this.fhirService, 'Monitoring', ResourceCodeManager_1.vancMonitoring, _display_grouping__WEBPACK_IMPORTED_MODULE_6__["med"], _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["ChartType"].SCATTER, undefined, // no meaningful y-axis ranges
                false, function (observation, dateRange) {
                    return vancRxNorm_1.getResourceSet(dateRange)
                        .then(function (rxNorms) {
                        // We know that we're only pushing in one RxNorm
                        // so it's safe to grab the first (and only) one in
                        // the list.
                        return rxNorms[0].orders;
                    })
                        .then(function (orderSet) {
                        return _fhir_data_classes_annotated_observation__WEBPACK_IMPORTED_MODULE_2__["AnnotatedObservation"].forMedicationMonitoring(observation, orderSet);
                    });
                })
            ], 'Vancomycin', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["med"]));
            codeGroups.push(new ResourceCodesForCard([
                new _rx_norm_group__WEBPACK_IMPORTED_MODULE_8__["RxNormCodeGroup"](this.fhirService, 'Medication Administrations', [_rx_norm__WEBPACK_IMPORTED_MODULE_7__["RxNormCode"].fromCodeString('1596450')], _display_grouping__WEBPACK_IMPORTED_MODULE_6__["med"], _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["ChartType"].SCATTER),
                new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCodeGroup"](this.fhirService, 'Monitoring', ResourceCodeManager_1.gentMonitoring, _display_grouping__WEBPACK_IMPORTED_MODULE_6__["med"], _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["ChartType"].SCATTER)
            ], 'Gentamicin', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["med"]));
            codeGroups.push(new ResourceCodesForCard([new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCodeGroup"](this.fhirService, 'Urinalysis', ResourceCodeManager_1.urineGroup, _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["ChartType"].SCATTER)], 'Urinalysis', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"]));
            codeGroups.push(new ResourceCodesForCard([new _bch_microbio_code__WEBPACK_IMPORTED_MODULE_5__["BCHMicrobioCodeGroup"](this.fhirService, 'Stool', ResourceCodeManager_1.stoolGroup, _display_grouping__WEBPACK_IMPORTED_MODULE_6__["microbio"], _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["ChartType"].MICROBIO)], 'Stool', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["microbio"]));
            codeGroups.push(new ResourceCodesForCard([new _bch_microbio_code__WEBPACK_IMPORTED_MODULE_5__["BCHMicrobioCodeGroup"](this.fhirService, 'NP Swab', ResourceCodeManager_1.npSwabGroup, _display_grouping__WEBPACK_IMPORTED_MODULE_6__["microbio"], _graphtypes_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["ChartType"].MICROBIO)], 'NP Swab', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["microbio"]));
            ResourceCodeManager_1.resourceCodeGroups = codeGroups;
        }
        if (!ResourceCodeManager_1.displayGroupMapping) {
            var mapping = new Map();
            for (var _d = 0, _e = this.getResourceCodeGroups(); _d < _e.length; _d++) {
                var group = _e[_d];
                if (mapping.has(group.displayGrouping)) {
                    mapping.get(group.displayGrouping).push(group);
                }
                else {
                    mapping.set(group.displayGrouping, [group]);
                }
            }
            ResourceCodeManager_1.displayGroupMapping = mapping;
        }
    }
    ResourceCodeManager_1 = ResourceCodeManager;
    /**
     * Returns the ResourceCodeGroups to be displayed. If the maps have already
     * been constructed, returns the static variable holding the information.
     * If not, constructs the maps and saves them into the static class variable,
     * then returns.
     */
    ResourceCodeManager.prototype.getResourceCodeGroups = function () {
        return ResourceCodeManager_1.resourceCodeGroups;
    };
    /**
     * Returns a map where the key is a clinical concept group and the value is
     * a list of LOINC code groups belonging to the clinical concept group.
     */
    ResourceCodeManager.prototype.getDisplayGroupMapping = function () {
        return ResourceCodeManager_1.displayGroupMapping;
    };
    var ResourceCodeManager_1;
    ResourceCodeManager.labLoincs = [
        // Pull all the defaults to the top.
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('1988-5', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'C-Reactive Protein', true, [0, 100], true),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('4537-7', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'ESR', true, [0, 200]),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('3094-0', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'BUN', true),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('2160-0', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Creatinine', true),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('1742-6', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Alanine Aminotransferase (ALT)', true),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('1920-8', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Aspartate Aminotransferase (AST)', true),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('6768-6', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Alkaline Phosphatase', true),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('1968-7', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Bilirubin, Direct', true),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('1975-2', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Bilirubin, Total', true),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('3084-1', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Uric acid', false)
    ];
    ResourceCodeManager.vitalLoincs = [
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('8310-5', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["vitalSign"], 'Body temperature', true, [35, 41]),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('8867-4', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["vitalSign"], 'Heart Rate', true, [20, 300]),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('9279-1', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["vitalSign"], 'Respiratory Rate', true, [6, 100]),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('55284-4', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["vitalSign"], 'Blood Pressure', true, [25, 250]),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('59408-5', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["vitalSign"], 'SpO2', true, [5, 100], true)
    ];
    ResourceCodeManager.gentMonitoring = [
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('35668-3', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Gent Level'),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('3663-2', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Gent Pk'),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('31092-0', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Gent Tr')
        // TODO: add Gentamicin, Peak/Post Q24H
    ];
    ResourceCodeManager.vancMonitoring = [
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('20578-1', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Vanc Level', true),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('4092-3', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Vanc Tr', true),
    ];
    ResourceCodeManager.urineGroup = [
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('5769-5', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Bacteria, Urinalysis'),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('50551-1', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Bilirubin, Urinalysis'),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('5794-3', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Blood, Urinalysis'),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('21033-6', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Budding Yeast, Urinalysis'),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('25157-9', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Epithelial Cast, Urinalysis'),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('50558-6', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Nitrite, Urinalysis'),
        // TODO: add Protein, Urinalysis
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('58449-0', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Red Blood Cell Clump, Urinalysis'),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('13945-1', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Red Cells, Urinalysis'),
        // TODO: add Squamous Epithelial, Urinalysis
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('50563-6', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'Urobilinogen, Urinalysis'),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('5799-2', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'White Blood Cell Enzyme, Urinalysis'),
        new _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]('33825-1', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], 'White Blood Cell Clump, Urinalysis'),
    ];
    // TODO(b/117431412): Figure out which microbio concepts to display.
    ResourceCodeManager.stoolGroup = [
        new _bch_microbio_code__WEBPACK_IMPORTED_MODULE_5__["BCHMicrobioCode"]('OVAANDPARASITEEXAM', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["microbio"], 'Ovo and Parasite Exam', true),
        new _bch_microbio_code__WEBPACK_IMPORTED_MODULE_5__["BCHMicrobioCode"]('SALMONELLAANDSHIGELLACULTURE', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["microbio"], 'Salmonella and Shigella Culture', true)
    ];
    ResourceCodeManager.npSwabGroup = [
        new _bch_microbio_code__WEBPACK_IMPORTED_MODULE_5__["BCHMicrobioCode"]('INFLUENZAABRSVPCRWASUBTYPEQUAL', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["microbio"], 'nfluenza A/B, RSV PCR w/A Subtype, QuaL', true),
        new _bch_microbio_code__WEBPACK_IMPORTED_MODULE_5__["BCHMicrobioCode"]('ADENOVIRUSPCRRESPQUAL', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["microbio"], 'Adenovirus PCR, Resp, QuaL', true),
        new _bch_microbio_code__WEBPACK_IMPORTED_MODULE_5__["BCHMicrobioCode"]('VIRALDFARESPIRATORY', _display_grouping__WEBPACK_IMPORTED_MODULE_6__["microbio"], 'Viral DFA Respiratory', true)
    ];
    ResourceCodeManager.typeToPairs = [
        [_display_grouping__WEBPACK_IMPORTED_MODULE_6__["vitalSign"], ResourceCodeManager_1.vitalLoincs],
        [_display_grouping__WEBPACK_IMPORTED_MODULE_6__["labResult"], ResourceCodeManager_1.labLoincs],
    ];
    ResourceCodeManager = ResourceCodeManager_1 = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Injectable"])(),
        __metadata("design:paramtypes", [_fhir_service__WEBPACK_IMPORTED_MODULE_3__["FhirService"]])
    ], ResourceCodeManager);
    return ResourceCodeManager;
}());



/***/ }),

/***/ "./src/app/clinicalconcepts/rx-norm-group.ts":
/*!***************************************************!*\
  !*** ./src/app/clinicalconcepts/rx-norm-group.ts ***!
  \***************************************************/
/*! exports provided: RxNormCodeGroup */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RxNormCodeGroup", function() { return RxNormCodeGroup; });
/* harmony import */ var _clinicalconcepts_resource_code_group__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../clinicalconcepts/resource-code-group */ "./src/app/clinicalconcepts/resource-code-group.ts");
/* harmony import */ var _fhir_data_classes_medication_order__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../fhir-data-classes/medication-order */ "./src/app/fhir-data-classes/medication-order.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();


/**
 * Represents one or more RxNorm codes that should be displayed together. In the
 * case of multiple RxNorm codes in a group, you should provide a label for that
 * group.
 */
var RxNormCodeGroup = /** @class */ (function (_super) {
    __extends(RxNormCodeGroup, _super);
    function RxNormCodeGroup() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    /**
     * Fills out the order and administration information for each for each
     * RxNormCode in this group, and returns a list of the populated RxNormCodes.
     * This is a roundabout process because the Cerner implementation of the
     * FHIR standard doesn't allow for searching MedicationOrders by RxNorm code,
     * so we have to search for MedicationAdministrations by RxNorm code and work
     * up from there.
     */
    RxNormCodeGroup.prototype.getResourceFromFhir = function (dateRange) {
        var _this = this;
        return this.fhirService
            .getMedicationAdministrationsWithCodes(this, dateRange)
            .then(function (medAdmins) {
            var groupedByOrder = _this.groupAdministrationsByOrderId(medAdmins);
            return _this.getMedicationOrdersAndMapToMed(groupedByOrder);
        }, function (rejection) {
            // If there are any errors constructing MedicationAdministrations
            // or MedicationOrders for this RxNormCode[], throw the error.
            throw rejection;
        });
    };
    /**
     * Takes a list of lists of MedicationAdministrations and groups them by their
     * order IDs. Each list represents a set of MedicationAdministrations for a
     * specific RxNorm, but they're not arranged by order. For example:
     *
     * [[admin1_rxnorm1_orderA, admin2_rxnorm1_orderB, admin3_rxnorm1_orderB],
     *  [admin1_rxnorm2_orderC, admin2_rxnorm2_orderC],
     *  [admin1_rxnorm3_orderD]]
     *
     * would yield:
     *
     * {orderA: [admin1_rxnorm1_orderA],
     *  orderB: [admin2_rxnorm1_orderB, admin3_rxnorm1_orderB],
     *  orderC: [admin1_rxnorm2_orderC, admin2_rxnorm2_orderC],
     *  orderD: [admin1_rxnorm3_orderD]
     * }
     * @param medAdmins A list of lists of MedicationAdministrations. See above.
     * @returns A map of order IDs to a list of corresponding
     *     MedicationAdministrations.
     */
    RxNormCodeGroup.prototype.groupAdministrationsByOrderId = function (medAdmins) {
        var groupedByOrder = new Map();
        for (var _i = 0, medAdmins_1 = medAdmins; _i < medAdmins_1.length; _i++) {
            var medAdminForDrug = medAdmins_1[_i];
            // Group medication administrations by medication order.
            groupedByOrder = medAdminForDrug.reduce(function (groups, medAdmin) {
                // Append this administration to whatever order list it belongs to.
                var orderId = medAdmin.medicationOrderId;
                if (!groups.has(orderId)) {
                    groups.set(orderId, new Array());
                }
                groups.set(orderId, groups.get(orderId).concat(medAdmin));
                return groups;
            }, 
            // Use whatever existed in groupedByOrder prior to this iteration as
            // the basis for the reducer to add to.
            groupedByOrder);
        }
        return groupedByOrder;
    };
    /**
     * Transforms a map with keys of MedicationOrder IDs and values of
     * MedicationAdministrations to a list of RxNormCodes, with the RxNormCodes
     * containing their corresponding MedicationOrders, and the medicationOrders
     * containing their corresponding MedicationAdministrations. For example:
     *
     * {orderA: [admin1_rxnorm1_orderA],
     *  orderB: [admin2_rxnorm1_orderB, admin3_rxnorm1_orderB],
     *  orderC: [admin1_rxnorm2_orderC, admin2_rxnorm2_orderC],
     *  orderD: [admin1_rxnorm3_orderD]
     * }
     *
     * would yield:
     *
     *  [RxNorm1 = {orders:
     *     [OrderA {administrationsForOrder: [admin1_rxnorm1_orderA]},
     *      OrderB {administrationsForOrder: [admin2_rxnorm1_orderB,
     *                                        admin3_rxnorm1_orderB]}]}
     *   RxNorm2 = {orders:
     *      [OrderC {administrationsForOrder: [admin1_rxnorm2_orderC,
     *                                         admin2_rxnorm2_orderC]}]}
     *   RxNorm3 = {orders:
     *      [OrderD {administrationsForOrder: [admin1_rxnorm3_orderD]}]}
     *
     * @param groupedByOrder A map with keys of MedicationOrder IDs and values of
     *     MedicationAdministrations for those MedicationOrders.
     * @returns A list of RxNormCodes with orders populated
     * @throws Error if the incoming parameter has medication administrations that
     *     did not come from the same order for the same med
     */
    RxNormCodeGroup.prototype.getMedicationOrdersAndMapToMed = function (groupedByOrder) {
        var _this = this;
        var groupedByMed = new Map();
        var allPromises = Array.from(groupedByOrder.keys()).map(function (orderId) {
            return _this.fhirService.getMedicationOrderWithId(orderId)
                .then(function (order) {
                // We only have the MedicationAdministrations from within the
                // specified time window, so we have to search again for all the
                // MedicationAdministrations present for this order and assign
                // them to the order.
                return order.setMedicationAdministrations(_this.fhirService);
            }, function (rejection) {
                // If there are any errors constructing MedicationOrders for
                // this RxNormCode[], throw the error.
                throw rejection;
            })
                .then(function (order) {
                // Verify all the administrations have the same RxNormCode and
                // same Order ID.
                var rxNormCodeSet = new Set(Array.from(groupedByOrder.get(order.orderId).values())
                    .map(function (admin) { return admin.rxNormCode; }));
                if (rxNormCodeSet.size !== 1) {
                    throw Error('Administrations for order ' + order.orderId +
                        ' are for multiple RxNorms: ' +
                        Array.from(rxNormCodeSet.values()));
                }
                var orderSet = new Set(Array.from(groupedByOrder.get(order.orderId).values())
                    .map(function (admin) { return admin.medicationOrderId; }));
                if (rxNormCodeSet.size !== 1) {
                    throw Error('Administrations for order ' + order.orderId +
                        ' report multiple order IDs: ' + Array.from(orderSet));
                }
                // Add the order to the map for the RxNorm code.
                var rxCode = rxNormCodeSet.values().next().value;
                if (groupedByMed.has(rxCode)) {
                    groupedByMed.set(rxCode, groupedByMed.get(rxCode).concat(order));
                }
                else {
                    groupedByMed.set(rxCode, new Array(order));
                }
            }, function (rejection) {
                // If there are any errors constructing MedicationOrders for
                // this RxNormCode[], throw the error.
                throw rejection;
            });
        });
        // Resolve all the promises and set the corresponding orders for each
        // RxNorm.
        return Promise.all(allPromises)
            .then(function (_) {
            Array.from(groupedByMed.entries()).forEach(function (medEntry) {
                var rxNorm = medEntry[0];
                var medOrders = medEntry[1];
                rxNorm.orders = new _fhir_data_classes_medication_order__WEBPACK_IMPORTED_MODULE_1__["MedicationOrderSet"](medOrders);
            });
            // Return all the populated RxNorms.
            return Array.from(groupedByMed.keys());
        }, function (rejection) {
            // If any promise is rejected, throw the same rejection.
            throw rejection;
        });
    };
    return RxNormCodeGroup;
}(_clinicalconcepts_resource_code_group__WEBPACK_IMPORTED_MODULE_0__["CachedResourceCodeGroup"]));



/***/ }),

/***/ "./src/app/clinicalconcepts/rx-norm.ts":
/*!*********************************************!*\
  !*** ./src/app/clinicalconcepts/rx-norm.ts ***!
  \*********************************************/
/*! exports provided: MedicationConceptGroup, ANTIVIRAL, ANTIBIOTIC, ANTIFUNGAL, MEDICATION_GROUPS, RxNormCode, RXNORM_CODES */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MedicationConceptGroup", function() { return MedicationConceptGroup; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ANTIVIRAL", function() { return ANTIVIRAL; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ANTIBIOTIC", function() { return ANTIBIOTIC; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ANTIFUNGAL", function() { return ANTIFUNGAL; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MEDICATION_GROUPS", function() { return MEDICATION_GROUPS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RxNormCode", function() { return RxNormCode; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RXNORM_CODES", function() { return RXNORM_CODES; });
/* harmony import */ var src_constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! src/constants */ "./src/constants.ts");
/* harmony import */ var _clinicalconcepts_resource_code_group__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../clinicalconcepts/resource-code-group */ "./src/app/clinicalconcepts/resource-code-group.ts");
/* harmony import */ var _theme_bch_colors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../theme/bch_colors */ "./src/app/theme/bch_colors.ts");
/* harmony import */ var _display_grouping__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./display-grouping */ "./src/app/clinicalconcepts/display-grouping.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();




var MedicationConceptGroup = /** @class */ (function (_super) {
    __extends(MedicationConceptGroup, _super);
    function MedicationConceptGroup() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return MedicationConceptGroup;
}(_display_grouping__WEBPACK_IMPORTED_MODULE_3__["DisplayGrouping"]));

var ANTIVIRAL = new MedicationConceptGroup('Antiviral', _theme_bch_colors__WEBPACK_IMPORTED_MODULE_2__["BOSTON_PURPLE"]);
var ANTIBIOTIC = new MedicationConceptGroup('Antibiotic', _theme_bch_colors__WEBPACK_IMPORTED_MODULE_2__["BOSTON_INDIGO"]);
var ANTIFUNGAL = new MedicationConceptGroup('Antifungal', _theme_bch_colors__WEBPACK_IMPORTED_MODULE_2__["BOSTON_YELLOW"]);
var MEDICATION_GROUPS = [ANTIVIRAL, ANTIBIOTIC, ANTIFUNGAL];
/**
 * Holds RXNorm codes and orders corresponding to them.
 */
var RxNormCode = /** @class */ (function (_super) {
    __extends(RxNormCode, _super);
    function RxNormCode() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RxNormCode.prototype.dataAvailableInAppTimeScope = function (fhirService) {
        return fhirService.medicationsPresentWithCode(this, src_constants__WEBPACK_IMPORTED_MODULE_0__["APP_TIMESPAN"]);
    };
    RxNormCode.CODING_STRING = 'http://www.nlm.nih.gov/research/umls/rxnorm';
    return RxNormCode;
}(_clinicalconcepts_resource_code_group__WEBPACK_IMPORTED_MODULE_1__["ResourceCode"]));

var RXNORM_CODES = [
    // Parenteral antibiotics
    new RxNormCode('11124', ANTIBIOTIC, 'Vancomycin', true),
    new RxNormCode('1596450', ANTIBIOTIC, 'Gentamicin')
];


/***/ }),

/***/ "./src/app/data-selector-element/data-selector-element.component.css":
/*!***************************************************************************!*\
  !*** ./src/app/data-selector-element/data-selector-element.component.css ***!
  \***************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = ".configurationCard {\n  background-color: transparent;\n  border-left-style: solid;\n  border-left-width: 5px;\n  height: 40px !important;\n  padding: 3px;\n}\n\n\n.disableDragging {\n  color: gray;\n  cursor: not-allowed;\n  padding-top: 4px;\n}\n\n\n.listItem {\n  display: inline-block;\n  height: -webkit-fit-content;\n  height: -moz-fit-content;\n  height: fit-content;\n  padding-left: 5px !important;\n}\n\n\n::ng-deep .mat-expansion-panel-body {\n  padding: 0px !important;\n}\n\n\n.label {\n  height: -webkit-fit-content;\n  height: -moz-fit-content;\n  height: fit-content;\n  line-height: 15px;\n}\n\n\n.tinytext {\n  font-size: 12px;\n  line-height: 15px;\n}\n"

/***/ }),

/***/ "./src/app/data-selector-element/data-selector-element.component.html":
/*!****************************************************************************!*\
  !*** ./src/app/data-selector-element/data-selector-element.component.html ***!
  \****************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<div class=\"configurationCard {{resourceCodesForCard.dataAvailable ? 'enableDragging': 'disableDragging'}}\"\n  [style.border-left-color]=\"resourceCodesForCard.dataAvailable ? conceptGroupKey.fill.hsl().string(): 'rgb(197, 185, 172)'\">\n  <!-- BOSTON_WARM_GRAY -->\n  <mat-list-item>\n    <div class=\"listItem\">\n      <div style=\"display:inline-block; vertical-align: middle;\">\n        <div class=\"label\">\n          {{resourceCodesForCard.label}}\n        </div>\n        <div class=\"tinytext\" *ngIf=\"!resourceCodesForCard.dataAvailable\">\n          No data between\n          {{appTimeIntervalString}}\n        </div>\n      </div>\n    </div>\n  </mat-list-item>\n</div>"

/***/ }),

/***/ "./src/app/data-selector-element/data-selector-element.component.ts":
/*!**************************************************************************!*\
  !*** ./src/app/data-selector-element/data-selector-element.component.ts ***!
  \**************************************************************************/
/*! exports provided: DataSelectorElementComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DataSelectorElementComponent", function() { return DataSelectorElementComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var src_constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! src/constants */ "./src/constants.ts");
/* harmony import */ var _clinicalconcepts_display_grouping__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../clinicalconcepts/display-grouping */ "./src/app/clinicalconcepts/display-grouping.ts");
/* harmony import */ var _clinicalconcepts_resource_code_manager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../clinicalconcepts/resource-code-manager */ "./src/app/clinicalconcepts/resource-code-manager.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};




var DataSelectorElementComponent = /** @class */ (function () {
    function DataSelectorElementComponent() {
        // Hold an instance of the app time interval so we can display it in the HTML
        this.appTimeIntervalString = src_constants__WEBPACK_IMPORTED_MODULE_1__["APP_TIMESPAN"].start.toFormat('MM/dd/yyyy') +
            ' and ' + src_constants__WEBPACK_IMPORTED_MODULE_1__["APP_TIMESPAN"].end.toFormat('MM/dd/yyyy');
    }
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", _clinicalconcepts_resource_code_manager__WEBPACK_IMPORTED_MODULE_3__["ResourceCodesForCard"])
    ], DataSelectorElementComponent.prototype, "resourceCodesForCard", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", _clinicalconcepts_display_grouping__WEBPACK_IMPORTED_MODULE_2__["DisplayGrouping"])
    ], DataSelectorElementComponent.prototype, "conceptGroupKey", void 0);
    DataSelectorElementComponent = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Component"])({
            selector: 'app-data-selector-element',
            template: __webpack_require__(/*! ./data-selector-element.component.html */ "./src/app/data-selector-element/data-selector-element.component.html"),
            styles: [__webpack_require__(/*! ./data-selector-element.component.css */ "./src/app/data-selector-element/data-selector-element.component.css")]
        })
        // This class represents one element in a list or menu of ResourceCodesForCards
        // that can be added to the main CardContainer.
    ], DataSelectorElementComponent);
    return DataSelectorElementComponent;
}());



/***/ }),

/***/ "./src/app/data-selector-menu/data-selector-menu.component.css":
/*!*********************************************************************!*\
  !*** ./src/app/data-selector-menu/data-selector-menu.component.css ***!
  \*********************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = ".addCardInline {\n  color: rgb(248, 248, 248);\n  display: inline-block;\n  opacity: 0.15;\n  -webkit-transition: opacity 0.3s;\n  transition: opacity 0.3s;\n  /* Needed so that there's not enough space between the cards to hold the icon,\n  just enough to hold the line placeholder.*/\n  margin-bottom:-14px;\n  margin-top:-14px;\n}\n\nspan {\n  border: 2px dashed rgb(248, 248, 248);\n  /* Only outline the bottom instead of all four sides.*/\n  border-style: none none dotted;\n  display: inline-block;\n\n}\n\n.addCardInline:hover {\n  opacity: 1;\n}\n\n.conceptSelector {\n  padding-left: 0px !important;\n  padding-right: 0px !important;\n  min-width: 200px;\n}\n\n.mainConceptSelector {\n  border-left-style: solid;\n  border-left-width: 5px;\n}\n\n::ng-deep .mat-menu-item  {\n  line-height: 20px !important;\n}\n\n::ng-deep .mat-list-item-content {\n  margin-top: 8px;\n}\n\n::ng-deep .mat-autocomplete-panel .mat-list-item-content {\n  margin-top: -8px; /* Styling for autocomplete menu items needs to be different.*/\n}\n\n::ng-deep .mat-option {\n  height: -webkit-fit-content !important;\n  height: -moz-fit-content !important;\n  height: fit-content !important;\n  overflow: visible !important;\n  padding: 0px !important;\n}\n\n.conceptForm {\n  margin-left: 10px;\n  margin-right: 10px;\n}\n\n::ng-deep .autoMenu.mat-menu-panel {\n  min-width: 300px;\n}\n\n.conceptFormField {\n  width: 100%;\n}\n"

/***/ }),

/***/ "./src/app/data-selector-menu/data-selector-menu.component.html":
/*!**********************************************************************!*\
  !*** ./src/app/data-selector-menu/data-selector-menu.component.html ***!
  \**********************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<div fxFlex fxLayout=\"row\" fxLayoutAlign=\"start center\" class=\"addCardInline\">\n  <button mat-icon-button [matMenuTriggerFor]=\"masterMenu\" matTooltip=\"Add card here\">\n    <mat-icon class=\"toolbarButton\">add_circle</mat-icon>\n  </button>\n  <span fxFlex>\n  </span>\n</div>\n<mat-menu #masterMenu=\"matMenu\" [overlapTrigger]=\"false\">\n  <ng-template matMenuContent>\n    <button mat-menu-item (click)=\"textbox()\">\n      <mat-icon>add_comment</mat-icon>\n      <span>Add Blank Annotation</span>\n    </button>\n    <button mat-menu-item (click)=\"customTimeline()\">\n      <mat-icon>show_chart</mat-icon>\n      <span>Add Custom Timeline</span>\n    </button>\n    <mat-divider></mat-divider>\n    <button mat-menu-item [matMenuTriggerFor]=\"conceptSelectorMenu\">\n      <mat-icon>add_to_photos</mat-icon>\n      <span>Add Chart</span>\n    </button>\n  </ng-template>\n</mat-menu>\n<mat-menu #conceptSelectorMenu=\"matMenu\" [style.padding]=\"0\">\n  <ng-template matMenuContent>\n    <button mat-menu-item [matMenuTriggerFor]=\"menu\">\n      Search for a concept\n    </button>\n    <mat-divider></mat-divider>\n    <mat-menu #menu=\"matMenu\" (closed)=\"autocompleteTrigger.closePanel()\" class=\"autoMenu\">\n      <!-- Autocomplete search bar -->\n      <form class=\"conceptForm\">\n        <mat-form-field class=\"conceptFormField\">\n          <input matInput placeholder=\"Search for a concept\" aria-label=\"Search for a concept\" [matAutocomplete]=\"auto\"\n            [formControl]=\"conceptCtrl\" (click)=\"$event.stopPropagation()\">\n          <!-- $event.stopPropagation is to not close main menu when clicking inside the input field -->\n          <mat-icon matPrefix>search</mat-icon>\n          <mat-autocomplete #auto=\"matAutocomplete\" (optionSelected)=\"selectOption($event)\">\n            <mat-option *ngFor=\"let concept of filteredConcepts | async\" [value]=\"concept.label\">\n              <app-data-selector-element [resourceCodesForCard]=\"concept\" [conceptGroupKey]=\"concept.displayGrouping\"></app-data-selector-element>\n              <mat-divider></mat-divider>\n            </mat-option>\n          </mat-autocomplete>\n        </mat-form-field>\n      </form>\n    </mat-menu>\n    <ng-container *ngFor=\"let entry of displayGroupings\">\n      <button mat-menu-item [matMenuTriggerFor]=\"subConceptSelectorMenu\" class=\"mainConceptSelector\"\n        [style.border-left-color]=\"entry[0].fill.hsl().string()\">\n        {{entry[0].label}}\n      </button>\n      <mat-divider></mat-divider>\n      <mat-menu #subConceptSelectorMenu=\"matMenu\">\n        <ng-template matMenuContent>\n          <button *ngFor=\"let resourceCodesForCard of entry[1]\" (click)=\"addConceptCard(resourceCodesForCard.label)\"\n            class=\"conceptSelector\" mat-menu-item>\n            <app-data-selector-element [resourceCodesForCard]=\"resourceCodesForCard\" [conceptGroupKey]=\"entry[0]\"></app-data-selector-element>\n            <mat-divider></mat-divider>\n          </button>\n        </ng-template>\n      </mat-menu>\n    </ng-container>\n  </ng-template>\n</mat-menu>"

/***/ }),

/***/ "./src/app/data-selector-menu/data-selector-menu.component.ts":
/*!********************************************************************!*\
  !*** ./src/app/data-selector-menu/data-selector-menu.component.ts ***!
  \********************************************************************/
/*! exports provided: DataSelectorMenuComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DataSelectorMenuComponent", function() { return DataSelectorMenuComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_forms__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/forms */ "./node_modules/@angular/forms/fesm5/forms.js");
/* harmony import */ var _angular_material__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/material */ "./node_modules/@angular/material/esm5/material.es5.js");
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs/operators */ "./node_modules/rxjs/_esm5/operators/index.js");
/* harmony import */ var _clinicalconcepts_resource_code_manager__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../clinicalconcepts/resource-code-manager */ "./src/app/clinicalconcepts/resource-code-manager.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};





var DataSelectorMenuComponent = /** @class */ (function () {
    function DataSelectorMenuComponent(resourceCodeManager) {
        this.resourceCodeManager = resourceCodeManager;
        // An event that is emitted when the user requests to add a new card.
        this.addCard = new _angular_core__WEBPACK_IMPORTED_MODULE_0__["EventEmitter"]();
        // An event that is emitted when the user requests to add a textbox.
        this.addTextbox = new _angular_core__WEBPACK_IMPORTED_MODULE_0__["EventEmitter"]();
        // An event that is emitted when the user requests to add a custom timeline.
        this.addCustomTimeline = new _angular_core__WEBPACK_IMPORTED_MODULE_0__["EventEmitter"]();
        // The FormControl used to monitor changes in the user input of the
        // autocomplete field.
        this.conceptCtrl = new _angular_forms__WEBPACK_IMPORTED_MODULE_1__["FormControl"]();
        var displayGroups = resourceCodeManager.getDisplayGroupMapping();
        var temp = Array.from(displayGroups.values());
        this.allConcepts = [].concat.apply([], temp);
        this.displayGroupings = Array.from(displayGroups.entries());
    }
    DataSelectorMenuComponent.prototype.ngOnInit = function () {
        var _this = this;
        // Watch for changes to the user input on the autocomplete panel.
        this.filteredConcepts = this.conceptCtrl.valueChanges.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["startWith"])(''), // The autocomplete input starts with nothing typed in.
        Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(function (concept) {
            return concept ? _this.filter(concept) : _this.allConcepts.slice();
        }));
    };
    // Listens for an event indicating that the user has selected to add the
    // concept card from the top toolbar. The label for the card is sent as an
    // event to CardContainer.
    DataSelectorMenuComponent.prototype.addConceptCard = function (label) {
        this.addCard.emit(label);
    };
    // Emits an event indicating to CardContainer to add a blank textbox at the
    // top of the page.
    DataSelectorMenuComponent.prototype.textbox = function () {
        this.addTextbox.emit();
    };
    DataSelectorMenuComponent.prototype.customTimeline = function () {
        this.addCustomTimeline.emit();
    };
    // Filter the concepts shown on the autocomplete menu.
    DataSelectorMenuComponent.prototype.filter = function (concept) {
        return this.allConcepts.filter(function (option) {
            return option.label.toLowerCase().indexOf(concept.toLowerCase()) === 0;
        });
    };
    // We close the menu after an option is selected by autocomplete.
    DataSelectorMenuComponent.prototype.closeMenus = function () {
        this.menuTrigger.closeMenu();
        this.autocompleteTrigger.closePanel();
    };
    // Listen for the event indicating that an option has been selected in the
    // autocomplete menu.
    DataSelectorMenuComponent.prototype.selectOption = function ($event) {
        this.addConceptCard($event.option.value);
        this.closeMenus();
    };
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ViewChild"])(_angular_material__WEBPACK_IMPORTED_MODULE_2__["MatMenuTrigger"]),
        __metadata("design:type", _angular_material__WEBPACK_IMPORTED_MODULE_2__["MatMenuTrigger"])
    ], DataSelectorMenuComponent.prototype, "menuTrigger", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ViewChild"])(_angular_material__WEBPACK_IMPORTED_MODULE_2__["MatAutocompleteTrigger"]),
        __metadata("design:type", _angular_material__WEBPACK_IMPORTED_MODULE_2__["MatAutocompleteTrigger"])
    ], DataSelectorMenuComponent.prototype, "autocompleteTrigger", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Output"])(),
        __metadata("design:type", Object)
    ], DataSelectorMenuComponent.prototype, "addCard", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Output"])(),
        __metadata("design:type", Object)
    ], DataSelectorMenuComponent.prototype, "addTextbox", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Output"])(),
        __metadata("design:type", Object)
    ], DataSelectorMenuComponent.prototype, "addCustomTimeline", void 0);
    DataSelectorMenuComponent = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Component"])({
            selector: 'app-data-selector-menu',
            template: __webpack_require__(/*! ./data-selector-menu.component.html */ "./src/app/data-selector-menu/data-selector-menu.component.html"),
            styles: [__webpack_require__(/*! ./data-selector-menu.component.css */ "./src/app/data-selector-menu/data-selector-menu.component.css")]
        })
        /**
         * Shows a button with expanding menus for selecting data elements to display.
         */
        ,
        __metadata("design:paramtypes", [_clinicalconcepts_resource_code_manager__WEBPACK_IMPORTED_MODULE_4__["ResourceCodeManager"]])
    ], DataSelectorMenuComponent);
    return DataSelectorMenuComponent;
}());



/***/ }),

/***/ "./src/app/date_utils.ts":
/*!*******************************!*\
  !*** ./src/app/date_utils.ts ***!
  \*******************************/
/*! exports provided: getTickMarksForXAxis, getDaysForIntervalSet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTickMarksForXAxis", function() { return getTickMarksForXAxis; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getDaysForIntervalSet", function() { return getDaysForIntervalSet; });
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! luxon */ "./node_modules/luxon/build/cjs-browser/luxon.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(luxon__WEBPACK_IMPORTED_MODULE_0__);
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

/**
 * For the given date range, returns a DateTime for each day in the time
 * range (converting to local time first) as a list in chronological
 * order. All data points in dateRange will be enclosed by the days listed in
 * the returned array. If specified, additional DateTimes will be included at
 * the 12-hour mark of each day in the interval.
 * @param dateRange The date range to get tick marks for.
 * @param twelveHour Whether or not to include DateTimes at the 12-hour mark of
 *     each day.
 *
 * @returns A list of the days in chronological order within the time range.
 */
function getTickMarksForXAxis(dateRange, twelveHour) {
    var days = [];
    // The dateRange could be stored in UTC, so convert it back to local
    // time.
    var intervalLocal = luxon__WEBPACK_IMPORTED_MODULE_0__["Interval"].fromDateTimes(dateRange.start.toLocal(), dateRange.end.toLocal());
    var startDate = intervalLocal.start.startOf('day');
    var dayCount = luxon__WEBPACK_IMPORTED_MODULE_0__["Duration"].fromMillis(intervalLocal.end.toMillis() - startDate.toMillis())
        .as('days');
    for (var i = 0; i <= dayCount; i++) {
        days.push(startDate.plus({ days: i }));
        if (twelveHour) {
            days.push(startDate.plus({ days: i, hours: 12 }));
        }
    }
    return days;
}
/**
 * Returns a DateTime for each day contained in any of the intervals in the
 * passed-in interval set. If the interval set contains day-boundaries, it will
 * add an extra day to be sure to encompass the full day, like
 * getTickMarksForXAxis. The days returned will be in an array in time order.
 *
 * @param intervals The intervals to list all the days for.
 */
function getDaysForIntervalSet(intervals) {
    var days = [];
    var allIntervals = luxon__WEBPACK_IMPORTED_MODULE_0__["Interval"].merge(intervals);
    for (var _i = 0, allIntervals_1 = allIntervals; _i < allIntervals_1.length; _i++) {
        var interval = allIntervals_1[_i];
        getTickMarksForXAxis(interval, false).forEach(function (x) { return days.push(x.toUTC()); });
    }
    return days.sort();
}


/***/ }),

/***/ "./src/app/debugger.service.ts":
/*!*************************************!*\
  !*** ./src/app/debugger.service.ts ***!
  \*************************************/
/*! exports provided: DebuggerService */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DebuggerService", function() { return DebuggerService; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};

/**
 * This service accumulates any errors sent to it in the app into an array of
 * strings so that they can be surfaced in the UI.
 */
var DebuggerService = /** @class */ (function () {
    function DebuggerService() {
        this.errors = [];
    }
    DebuggerService.prototype.logError = function (error) {
        this.errors.push(error);
    };
    DebuggerService = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Injectable"])({ providedIn: 'root' })
    ], DebuggerService);
    return DebuggerService;
}());



/***/ }),

/***/ "./src/app/debugger/debugger.component.html":
/*!**************************************************!*\
  !*** ./src/app/debugger/debugger.component.html ***!
  \**************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<div style=\"background-color: white\">\n  Browser version: {{browserVersion}} <br />\n  Authentication information:<br />\n  URL Parameters: {{parameters}} <br />\n\n  Errors surfaced:<br />\n  <div *ngFor=\"let error of debugService.errors\">\n    {{error}}\n  </div>\n</div>\n"

/***/ }),

/***/ "./src/app/debugger/debugger.component.ts":
/*!************************************************!*\
  !*** ./src/app/debugger/debugger.component.ts ***!
  \************************************************/
/*! exports provided: DebuggerComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DebuggerComponent", function() { return DebuggerComponent; });
/* harmony import */ var fhirclient__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fhirclient */ "./node_modules/fhirclient/fhir-client.js");
/* harmony import */ var fhirclient__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fhirclient__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/router */ "./node_modules/@angular/router/fesm5/router.js");
/* harmony import */ var _debugger_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../debugger.service */ "./src/app/debugger.service.ts");
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.




var DebuggerComponent = /** @class */ (function () {
    function DebuggerComponent(debugService, route) {
        var _this = this;
        this.debugService = debugService;
        this.route = route;
        this.parameters = new Array();
        this.browserVersion = navigator.appVersion;
        this.route.queryParams.subscribe(function (params) {
            _this.parameters.push(JSON.stringify(params));
        });
    }
    DebuggerComponent = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'app-debugger',
            template: __webpack_require__(/*! ./debugger.component.html */ "./src/app/debugger/debugger.component.html"),
        })
        /**
         * This debugger component surfaces errors stored in the debug service to the
         * UI.
         */
        ,
        __metadata("design:paramtypes", [_debugger_service__WEBPACK_IMPORTED_MODULE_3__["DebuggerService"], _angular_router__WEBPACK_IMPORTED_MODULE_2__["ActivatedRoute"]])
    ], DebuggerComponent);
    return DebuggerComponent;
}());



/***/ }),

/***/ "./src/app/delete-dialog/delete-dialog.component.html":
/*!************************************************************!*\
  !*** ./src/app/delete-dialog/delete-dialog.component.html ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<h1 mat-dialog-title>Do you want to remove this card?</h1>\n<div mat-dialog-actions>\n  <button mat-button (click)=\"onExit()\">No</button>\n  <button mat-button (click)=\"onConfirm()\" cdkFocusInitial>Yes, remove this card</button>\n</div>"

/***/ }),

/***/ "./src/app/delete-dialog/delete-dialog.component.ts":
/*!**********************************************************!*\
  !*** ./src/app/delete-dialog/delete-dialog.component.ts ***!
  \**********************************************************/
/*! exports provided: DeleteDialogComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DeleteDialogComponent", function() { return DeleteDialogComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_material_dialog__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/material/dialog */ "./node_modules/@angular/material/esm5/dialog.es5.js");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};


var DeleteDialogComponent = /** @class */ (function () {
    function DeleteDialogComponent(dialogRef) {
        this.dialogRef = dialogRef;
    }
    // The user does not wish to delete the card.
    DeleteDialogComponent.prototype.onExit = function () {
        this.dialogRef.close();
    };
    // The user wishes to delete the card.
    DeleteDialogComponent.prototype.onConfirm = function () {
        this.dialogRef.close({
            delete: true,
        });
    };
    DeleteDialogComponent = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Component"])({
            selector: 'app-delete-dialog',
            template: __webpack_require__(/*! ./delete-dialog.component.html */ "./src/app/delete-dialog/delete-dialog.component.html"),
            styles: [__webpack_require__(/*! ../cardcontainer/cardcontainer.component.css */ "./src/app/cardcontainer/cardcontainer.component.css")]
        })
        /**
         * Shows a dialog asking the user to confirm whether or not they wish to delete
         * the card.
         */
        ,
        __metadata("design:paramtypes", [_angular_material_dialog__WEBPACK_IMPORTED_MODULE_1__["MatDialogRef"]])
    ], DeleteDialogComponent);
    return DeleteDialogComponent;
}());



/***/ }),

/***/ "./src/app/fhir-data-classes/annotated-observation.ts":
/*!************************************************************!*\
  !*** ./src/app/fhir-data-classes/annotated-observation.ts ***!
  \************************************************************/
/*! exports provided: AnnotatedObservation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AnnotatedObservation", function() { return AnnotatedObservation; });
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! luxon */ "./node_modules/luxon/build/cjs-browser/luxon.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(luxon__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _fhir_resource_set__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../fhir-resource-set */ "./src/app/fhir-resource-set.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();


/**
 * An Observation with additional information to display in its tooltip.
 */
var AnnotatedObservation = /** @class */ (function (_super) {
    __extends(AnnotatedObservation, _super);
    function AnnotatedObservation(observation, 
    /**
     * The items in this list are [label, value] pairs to be displayed in
     * a tooltip.
     * This array should be treated as immutable.
     * TODO(b/126219092): Pull in a library to enforce immutability.
     */
    annotationValues) {
        if (annotationValues === void 0) { annotationValues = new Array(); }
        var _this = _super.call(this, observation.label) || this;
        _this.observation = observation;
        _this.annotationValues = annotationValues;
        return _this;
    }
    /**
     * Makes an AnnotatedObservation for medication monitoring.
     * The annotations read out how long it's been since the prior medication
     * dose, and how long it was until the next medication dose was given.
     * @param observation The monitoring observation to annotate
     * @param medicationOrderSet The medication orders containing the doses of the
     *     corresponding medication
     * @throws Error if there are two medication orders in MedicationOrderSet
     *     that contain the timestamp of the observation
     */
    AnnotatedObservation.forMedicationMonitoring = function (observation, medicationOrderSet) {
        // Look in the medication order set's administrations and find the ones
        // closest in time to this observation.
        var doseCountBefore;
        var doseCountAfter;
        var timeSinceLast;
        var timeBeforeNext;
        var annotations = new Array();
        // Find the medication order set that coincides in time with this
        // administration (if any).
        var containingMedicationOrder;
        for (var _i = 0, _a = medicationOrderSet.resourceList; _i < _a.length; _i++) {
            var order = _a[_i];
            if (luxon__WEBPACK_IMPORTED_MODULE_0__["Interval"]
                .fromDateTimes(order.firstAdministration.timestamp, order.lastAdmininistration.timestamp)
                .contains(observation.timestamp)) {
                if (containingMedicationOrder) {
                    throw Error('Two medication orders contain this monitoring point.');
                }
                containingMedicationOrder = order;
            }
        }
        if (containingMedicationOrder) {
            // Find the spot in the array of administrations where the monitoring
            // would fall, timewise.
            var sortedAdmins = containingMedicationOrder.administrationsForOrder.resourceList.sort(function (a, b) { return a.medAdministration.timestamp.toMillis() -
                b.medAdministration.timestamp.toMillis(); });
            var idx = 0;
            while (idx < sortedAdmins.length &&
                sortedAdmins[idx].medAdministration.timestamp <
                    observation.timestamp) {
                idx++;
            }
            // It's guaranteed that there's a dose before the monitoring point and a
            // dose after the monitoring point since we check to make sure
            // the observation is between the first and last administrations.
            // Here we look up those dose numbers and the time difference between
            // the doses and the monitoring point.
            var doseBeforeObs = sortedAdmins[idx - 1];
            var doseAfterObs = sortedAdmins[idx];
            doseCountBefore = doseBeforeObs.doseInOrder;
            timeSinceLast =
                observation.timestamp.diff(doseBeforeObs.medAdministration.timestamp);
            doseCountAfter = doseAfterObs.doseInOrder;
            timeBeforeNext =
                doseAfterObs.medAdministration.timestamp.diff(observation.timestamp);
            annotations.push([
                'Time since dose #' + doseCountBefore, timeSinceLast.toFormat('h:mm')
            ]);
            annotations.push([
                'Time before dose #' + doseCountAfter, timeBeforeNext.toFormat('h:mm')
            ]);
        }
        return new AnnotatedObservation(observation, annotations);
    };
    /**
     * Makes an AnnotatedObservation for blood pressure, with information about
     * the blood pressure location.
     * @param observation The monitoring observation to annotate
     * @param locationSet The ObservationSet containing Blood Pressure location
     *     observations.
     * @throws Error if there are two observations in locationSet
     *     that contain the timestamp of the observation
     */
    AnnotatedObservation.forBloodPressure = function (observation, locationSet) {
        var annotations = new Array();
        // Find the medication order set that coincides in time with this
        // administration (if any).
        var matchingObservation;
        if (locationSet) {
            for (var _i = 0, _a = locationSet.resourceList; _i < _a.length; _i++) {
                var locationObs = _a[_i];
                if (locationObs.observation.timestamp.equals(observation.timestamp)) {
                    if (matchingObservation) {
                        throw Error('Two blood pressure locations recorded at the same time.');
                    }
                    matchingObservation = locationObs.observation;
                }
            }
        }
        if (matchingObservation) {
            annotations.push(['Blood Pressure Location', matchingObservation.result]);
        }
        return new AnnotatedObservation(observation, annotations);
    };
    return AnnotatedObservation;
}(_fhir_resource_set__WEBPACK_IMPORTED_MODULE_1__["LabeledClass"]));



/***/ }),

/***/ "./src/app/fhir-data-classes/diagnostic-report.ts":
/*!********************************************************!*\
  !*** ./src/app/fhir-data-classes/diagnostic-report.ts ***!
  \********************************************************/
/*! exports provided: DiagnosticReportStatus, DiagnosticReport, AnnotatedDiagnosticReport */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DiagnosticReportStatus", function() { return DiagnosticReportStatus; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DiagnosticReport", function() { return DiagnosticReport; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AnnotatedDiagnosticReport", function() { return AnnotatedDiagnosticReport; });
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../constants */ "./src/constants.ts");
/* harmony import */ var _observation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./observation */ "./src/app/fhir-data-classes/observation.ts");
/* harmony import */ var _specimen__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./specimen */ "./src/app/fhir-data-classes/specimen.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.



/**
 * FHIR element for DiagnosticReportStatus, from the DSTU2 version of the
 * standard.
 * https://www.hl7.org/fhir/valueset-diagnostic-report-status.html
 */
var DiagnosticReportStatus;
(function (DiagnosticReportStatus) {
    DiagnosticReportStatus["Registered"] = "Registered";
    DiagnosticReportStatus["Partial"] = "Partial";
    DiagnosticReportStatus["Preliminary"] = "Preliminary";
    DiagnosticReportStatus["Final"] = "Final";
    DiagnosticReportStatus["Amended"] = "Amended";
    DiagnosticReportStatus["Corrected"] = "Corrected";
    DiagnosticReportStatus["Appended"] = "Appended";
    DiagnosticReportStatus["Cancelled"] = "Cancelled";
    DiagnosticReportStatus["EnteredInError"] = "Enteredinerror";
    DiagnosticReportStatus["Unknown"] = "Unknown";
})(DiagnosticReportStatus || (DiagnosticReportStatus = {}));
var statusToEnumMap = new Map([
    ['registered', DiagnosticReportStatus.Registered],
    ['partial', DiagnosticReportStatus.Partial],
    ['preliminary', DiagnosticReportStatus.Preliminary],
    ['final', DiagnosticReportStatus.Final],
    ['amended', DiagnosticReportStatus.Amended],
    ['corrected', DiagnosticReportStatus.Corrected],
    ['appended', DiagnosticReportStatus.Appended],
    ['cancelled', DiagnosticReportStatus.Cancelled],
    ['entered-in-error', DiagnosticReportStatus.EnteredInError],
    ['unknown', DiagnosticReportStatus.Unknown],
]);
/**
 * FHIR resource for DiagnosticReport, from the DSTU2 version of the standard.
 * https://www.hl7.org/fhir/DSTU2/diagnosticreport.html
 *
 * The parsing for this class is heavily influenced by the custom API BCH
 * built to return DiagnosticReports for microbiology data. In particular, we
 * only parse out specimens and results from the "contained" portion of the
 * resource instead of supporting retrieval by reference since the Cerner
 * implementation of the FHIR standard won't allow microbiology retrieval.
 */
var DiagnosticReport = /** @class */ (function () {
    function DiagnosticReport(json) {
        /** Specimens this report is based on */
        this.specimens = new Array();
        /** Results in the form of observations */
        this.results = new Array();
        if (json.id) {
            this.id = json.id;
        }
        // Contained resources may be either specimens or observations.
        var contained = json.contained;
        for (var _i = 0, contained_1 = contained; _i < contained_1.length; _i++) {
            var rsc = contained_1[_i];
            if (rsc.resourceType === _constants__WEBPACK_IMPORTED_MODULE_0__["FhirResourceType"].Specimen) {
                this.specimens.push(new _specimen__WEBPACK_IMPORTED_MODULE_2__["Specimen"](rsc));
            }
            else if (rsc.resourceType === _constants__WEBPACK_IMPORTED_MODULE_0__["FhirResourceType"].Observation) {
                this.results.push(new _observation__WEBPACK_IMPORTED_MODULE_1__["Observation"](rsc));
            }
            // Silently ignore all other contained resource types.
        }
        if (!json.status) {
            throw Error('The report needs a status to be useful. JSON: ' +
                JSON.stringify(json));
        }
        this.status = statusToEnumMap.get(json.status);
    }
    return DiagnosticReport;
}());

/**
 * A diagnostic report with the timestamp for a specific culture type extended.
 */
var AnnotatedDiagnosticReport = /** @class */ (function () {
    function AnnotatedDiagnosticReport(report, cultureType) {
        // Get the timestamp from the collection time of the specimen.
        var specimen = report.specimens.find(function (s) { return (s.type === cultureType); });
        if (specimen) {
            this.timestamp = specimen.collectedDateTime ?
                specimen.collectedDateTime :
                (specimen.collectedPeriod ? specimen.collectedPeriod.start :
                    undefined);
        }
        this.report = report;
    }
    return AnnotatedDiagnosticReport;
}());



/***/ }),

/***/ "./src/app/fhir-data-classes/dosage.ts":
/*!*********************************************!*\
  !*** ./src/app/fhir-data-classes/dosage.ts ***!
  \*********************************************/
/*! exports provided: Dosage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Dosage", function() { return Dosage; });
/* harmony import */ var _unit_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../unit_utils */ "./src/app/unit_utils.ts");

// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
/**
 * This object represents relevant components of dosage information, provided
 * in MedicationOrders and MedicationAdministrations.
 */
var Dosage = /** @class */ (function () {
    function Dosage(json) {
        if (json.dosage) {
            if (json.dosage.quantity) {
                this.quantity = json.dosage.quantity.value;
                this.unit = Object(_unit_utils__WEBPACK_IMPORTED_MODULE_0__["fixUnitAbbreviations"])(json.dosage.quantity.unit);
            }
            if (json.dosage.route) {
                this.route = json.dosage.route.text;
            }
            /*
             * The text for the dosage usually contains information about the rate of
             * administration, however the format across different
             * MedicationAdministrations is not consistent. Ex: "500 mg IV q6hr" vs
             * "250 mg = 1 caps Oral Once"
             */
            this.text = json.dosage.text;
        }
    }
    return Dosage;
}());



/***/ }),

/***/ "./src/app/fhir-data-classes/encounter.ts":
/*!************************************************!*\
  !*** ./src/app/fhir-data-classes/encounter.ts ***!
  \************************************************/
/*! exports provided: Encounter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Encounter", function() { return Encounter; });
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! luxon */ "./node_modules/luxon/build/cjs-browser/luxon.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(luxon__WEBPACK_IMPORTED_MODULE_0__);
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

/**
 * This object represents basic information about an Encounter: what its
 * reason and type were, when it happened, and its ID.
 */
var Encounter = /** @class */ (function () {
    function Encounter(json) {
        this.json = json;
        this.encounterId = json.identifier;
        try {
            this.period = luxon__WEBPACK_IMPORTED_MODULE_0__["Interval"].fromDateTimes(luxon__WEBPACK_IMPORTED_MODULE_0__["DateTime"].fromISO(json.period.start), json.period.end ? luxon__WEBPACK_IMPORTED_MODULE_0__["DateTime"].fromISO(json.period.end) : luxon__WEBPACK_IMPORTED_MODULE_0__["DateTime"].utc());
        }
        catch (_a) {
            throw Error('An encounter must have a start date. JSON: ' + JSON.stringify(json));
        }
        this.type = json.type;
        this.reason = json.reason;
    }
    return Encounter;
}());



/***/ }),

/***/ "./src/app/fhir-data-classes/medication-administration.ts":
/*!****************************************************************!*\
  !*** ./src/app/fhir-data-classes/medication-administration.ts ***!
  \****************************************************************/
/*! exports provided: MedicationAdministration, MedicationAdministrationSet, AnnotatedAdministration */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MedicationAdministration", function() { return MedicationAdministration; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MedicationAdministrationSet", function() { return MedicationAdministrationSet; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AnnotatedAdministration", function() { return AnnotatedAdministration; });
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! luxon */ "./node_modules/luxon/build/cjs-browser/luxon.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(luxon__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _clinicalconcepts_rx_norm__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../clinicalconcepts/rx-norm */ "./src/app/clinicalconcepts/rx-norm.ts");
/* harmony import */ var _fhir_resource_set__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../fhir-resource-set */ "./src/app/fhir-resource-set.ts");
/* harmony import */ var _unit_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../unit_utils */ "./src/app/unit_utils.ts");
/* harmony import */ var _dosage__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./dosage */ "./src/app/fhir-data-classes/dosage.ts");
/* harmony import */ var _medication__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./medication */ "./src/app/fhir-data-classes/medication.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();






/**
 * This object represents a FHIR MedicationAdministration. It does not contain
 * all the information in a standard MedicationAdministration (see
 * https://www.hl7.org/fhir/DSTU2/medicationadministration.html) but instead
 * stores only the information we're interested in seeing.
 */
var MedicationAdministration = /** @class */ (function (_super) {
    __extends(MedicationAdministration, _super);
    /**
     * Makes an MedicationAdministration out of a JSON object that represents a
     * a FHIR MedicationAdministration.
     * https://www.hl7.org/fhir/DSTU2/medicationadministration.html
     * @param json A JSON object that represents a FHIR MedicationAdministration.
     */
    function MedicationAdministration(json) {
        var _this = _super.call(this, json.medicationReference ? json.medicationReference.display :
            json.medicationCodeableConcept ?
                json.medicationCodeableConcept.text :
                null) || this;
        _this.json = json;
        _this.MED_RESOURCE_TYPE = 'Medication';
        _this.containedMedications = [];
        if (json.medicationCodeableConcept) {
            if (json.medicationCodeableConcept.coding) {
                _this.rxNormCode =
                    (json.medicationCodeableConcept.coding
                        .map(
                    // Map the codes to a boolean that is true only if the
                    // encoding is an RxNorm encoding, and the RxNorm code
                    // appears in our RxNormCode list that we care about.
                    function (coding) { return (!coding.system ||
                        coding.system.indexOf(_clinicalconcepts_rx_norm__WEBPACK_IMPORTED_MODULE_1__["RxNormCode"].CODING_STRING) !== -1) &&
                        _clinicalconcepts_rx_norm__WEBPACK_IMPORTED_MODULE_1__["RxNormCode"].fromCodeString(coding.code); })
                        // Filter out any codes that are not RxNorm codes.
                        .filter(function (code) { return !!code; }))[0];
            }
        }
        // TODO(b/111990521): If there are hours and minutes then we can guarantee
        // timezone is specified, but if not, then the timezone might not be
        // specified! I'm not sure how to best handle that.
        // https://www.hl7.org/fhir/DSTU2/datatypes.html#dateTime
        _this.timestamp = json.effectiveTimeDateTime ?
            luxon__WEBPACK_IMPORTED_MODULE_0__["DateTime"].fromISO(json.effectiveTimeDateTime).toUTC() :
            (json.effectiveTimePeriod ?
                luxon__WEBPACK_IMPORTED_MODULE_0__["DateTime"].fromISO(json.effectiveTimePeriod.start).toUTC() :
                null);
        _this.dosage = new _dosage__WEBPACK_IMPORTED_MODULE_4__["Dosage"](json);
        _this.wasNotGiven = json.wasNotGiven;
        _this.medicationOrderId =
            json.prescription ? json.prescription.reference : null;
        if (json.contained && json.contained.length > 0) {
            // We first find the element that lists the "ingredients" of this
            // MedicationAdministration with each corresponding dosage and reference
            // id. This element of "contained" will have the same id as the overall
            // MedicationAdministration's medicationReference number.
            var referenceId_1 = json.medicationReference ? json.medicationReference.reference : null;
            var ingredientReferences = new Map();
            if (referenceId_1) {
                var index = json.contained.findIndex(function (el) {
                    return (el.resourceType === _this.MED_RESOURCE_TYPE && el.product &&
                        el.id === referenceId_1.replace('#', ''));
                });
                var listOfIngredients = json.contained[index];
                if (listOfIngredients && listOfIngredients.product.ingredient) {
                    for (var _i = 0, _a = listOfIngredients.product.ingredient; _i < _a.length; _i++) {
                        var el = _a[_i];
                        if (el.item && el.amount) {
                            ingredientReferences.set(el.item.reference.replace('#', ''), el);
                        }
                    }
                }
                // Remove the element similar to a "list of ingredients" from contained.
                if (index > -1) {
                    json.contained.splice(index, 1);
                }
            }
            if (ingredientReferences.size > 0 && json.contained.length > 1) {
                // We map the Medications in the list of ingredients to JSON elements
                // containing the RxNorms for each ingredient.
                for (var _b = 0, _c = json.contained; _b < _c.length; _b++) {
                    var ing = _c[_b];
                    _this.containedMedications.push(new _medication__WEBPACK_IMPORTED_MODULE_5__["ContainedMedication"](ing, ingredientReferences));
                }
            }
        }
        if (!(_this.rxNormCode && _this.label)) {
            // If a MedicationAdministration has "Contained" portions of different
            // ingredients, then there might not be one single RxNorm corresponding to
            // this administration.
            // We throw an error if all contained medications do not
            // have an RxNormCode, or if there are no contained medications.
            if (_this.containedMedications.length === 0 ||
                (_this.containedMedications.length > 0 &&
                    _this.containedMedications.every(function (med) { return (med.code === undefined); }))) {
                throw Error('JSON must include RxNormCode and a label' +
                    ' to be included as a MedicationAdministration. JSON: ' +
                    JSON.stringify(json));
            }
        }
        return _this;
        // TODO(b/b/119673528): Replace checks for LOINC and RxNorm labels.
        // if (this.rxNormCode) {
        //   // Check this MedicationOrder label against the RxNorm label.
        //   // Check the observation label against the LOINC code label.
        //   if (this.label.toLowerCase() !== this.rxNormCode.label.toLowerCase()) {
        //     throw Error(
        //         'The label for this MedicationAdministration\'s RxNorm code' +
        //         ' doesn\'t match the label in the data. MedicationOrder label: '
        //         + this.label + ' RxNorm label: ' + this.rxNormCode.label);
        //   }
        // }
    }
    return MedicationAdministration;
}(_fhir_resource_set__WEBPACK_IMPORTED_MODULE_2__["LabeledClass"]));

/**
 * A set of MedicalAdministrations that belong together as part of the same
 * series.
 */
var MedicationAdministrationSet = /** @class */ (function (_super) {
    __extends(MedicationAdministrationSet, _super);
    /**
     * Constructor for MedicationAdministrationSet.
     * @param medicationAdministrationList The list of MedicationAdministrations
     *     belonging together.
     * @throws Error if the administrations have different labels or RxNorms,
     *      or if there is not a label, or if the administrations have different
     *      units.
     */
    function MedicationAdministrationSet(medicationAdministrationList) {
        var _this = _super.call(this, medicationAdministrationList) || this;
        var rxNorms = medicationAdministrationList.map(function (x) { return x.medAdministration.rxNormCode; });
        if (new Set(rxNorms).size > 1) {
            throw Error('Different RxNorms for administrations: ' + rxNorms);
        }
        _this.rxNormCode = rxNorms[0];
        _this.minDose = Math.min.apply(Math, medicationAdministrationList.map(function (x) { return x.medAdministration.dosage.quantity; }));
        _this.maxDose = Math.max.apply(Math, medicationAdministrationList.map(function (x) { return x.medAdministration.dosage.quantity; }));
        var units = new Set(medicationAdministrationList.map(function (x) { return x.medAdministration.dosage.unit; }));
        if (units.size > 1) {
            throw Error('Different units in the administration set: ' +
                Array.from(units.values()));
        }
        _this.unit = Object(_unit_utils__WEBPACK_IMPORTED_MODULE_3__["fixUnitAbbreviations"])(Array.from(units.values())[0]);
        return _this;
    }
    return MedicationAdministrationSet;
}(_fhir_resource_set__WEBPACK_IMPORTED_MODULE_2__["FhirResourceSet"]));

/**
 * A MedicationAdministration with additional information relating it to
 * the other administrations in the same order.
 */
var AnnotatedAdministration = /** @class */ (function (_super) {
    __extends(AnnotatedAdministration, _super);
    function AnnotatedAdministration(medAdmin, doseInOrder, doseDay, prevDose) {
        var _this = _super.call(this, medAdmin.label) || this;
        _this.medAdministration = medAdmin;
        _this.doseInOrder = doseInOrder;
        _this.doseDay = doseDay;
        _this.previousDose = prevDose;
        return _this;
    }
    return AnnotatedAdministration;
}(_fhir_resource_set__WEBPACK_IMPORTED_MODULE_2__["LabeledClass"]));



/***/ }),

/***/ "./src/app/fhir-data-classes/medication-order.ts":
/*!*******************************************************!*\
  !*** ./src/app/fhir-data-classes/medication-order.ts ***!
  \*******************************************************/
/*! exports provided: MedicationOrder, MedicationOrderSet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MedicationOrder", function() { return MedicationOrder; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MedicationOrderSet", function() { return MedicationOrderSet; });
/* harmony import */ var _clinicalconcepts_rx_norm__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../clinicalconcepts/rx-norm */ "./src/app/clinicalconcepts/rx-norm.ts");
/* harmony import */ var _fhir_resource_set__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../fhir-resource-set */ "./src/app/fhir-resource-set.ts");
/* harmony import */ var _unit_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../unit_utils */ "./src/app/unit_utils.ts");
/* harmony import */ var _medication_administration__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./medication-administration */ "./src/app/fhir-data-classes/medication-administration.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
// Disable this check because it's for IE 11 compatibility and we're not worried
// about that in our testing code.
/* tslint:disable:object-literal-shorthand*/




/**
 * This object represents a FHIR MedicationOrder. It does not contain
 * all the information in a standard MedicationOrder (see
 * https://www.hl7.org/fhir/DSTU2/medicationorder.html) but instead
 * stores only the information we're interested in seeing.
 */
var MedicationOrder = /** @class */ (function (_super) {
    __extends(MedicationOrder, _super);
    /**
     * Makes an MedicationOrder out of a list of MedicationAdministrations.
     * https://www.hl7.org/fhir/DSTU2/medicationorder.html
     * @param json The json representing this MedicationOrder.
     */
    function MedicationOrder(json) {
        var _this = 
        // A MedicationOrder's label is one of the following in order of preference:
        // 1) the medication reference's display anme
        // 2) the medication encoding's text
        // 3) the order's ID
        _super.call(this, json.medicationReference ? json.medicationReference.display :
            json.medicationCodeableConcept ?
                json.medicationCodeableConcept.text :
                json.id) || this;
        _this.json = json;
        _this.dosageRetrievalError = 'Could not retrieve dosage instructions.';
        // By default, we set the instruction message as the retrieval error message,
        // and change it if we find a valid dosage instruction.
        _this.dosageInstruction = _this.dosageRetrievalError;
        if (json.dosageInstruction && json.dosageInstruction[0]) {
            if (json.dosageInstruction.length > 1) {
                throw Error('JSON must only include one dosage instruction.');
            }
            _this.dosageInstruction = json.dosageInstruction[0].text;
        }
        _this.orderId = json.id;
        if (json.medicationCodeableConcept) {
            if (json.medicationCodeableConcept.coding) {
                _this.rxNormCode =
                    (json.medicationCodeableConcept.coding
                        .map(
                    // Map the codes to a boolean that is true only if the
                    // encoding is an RxNorm encoding, and the RxNorm code
                    // appears in our RxNormCode list that we care about.
                    function (coding) { return (!coding.system ||
                        coding.system.indexOf(_clinicalconcepts_rx_norm__WEBPACK_IMPORTED_MODULE_0__["RxNormCode"].CODING_STRING) !== -1) &&
                        _clinicalconcepts_rx_norm__WEBPACK_IMPORTED_MODULE_0__["RxNormCode"].fromCodeString(coding.code); })
                        // Filter out any codes that are not RxNorm codes.
                        .filter(function (code) { return !!code; }))[0];
            }
        }
        if (!(_this.rxNormCode && _this.label)) {
            throw Error('JSON must include RxNormCode and a label' +
                ' to be included as a MedicationOrder. JSON: ' +
                JSON.stringify(json));
        }
        // Check this MedicationOrder label against the RxNorm label.
        if (_this.label.toLowerCase() !== _this.rxNormCode.label.toLowerCase()) {
            throw Error('The label for this MedicationOrder\'s RxNorm code doesn\'t match ' +
                ' the label in the data. MedicationOrder label: ' + _this.label +
                ' RxNorm label: ' + _this.rxNormCode.label);
        }
        return _this;
    }
    /**
     * Sets the MedicationAdministration info for this MedicationOrder.
     * @param fhirService The FhirService used to find the
     *     MedicationAdministrations corresponding to this MedicationOrder.
     * @throws Error if the label for the list of administrations does not match
     *     the label for this order.
     * @returns This order, after all the promises are resolved.
     */
    MedicationOrder.prototype.setMedicationAdministrations = function (fhirService) {
        var _this = this;
        return fhirService.getMedicationAdministrationsWithOrder(this.orderId)
            .then(function (medAdmins) {
            medAdmins = medAdmins.sort(function (a, b) {
                return a.timestamp.toMillis() - b.timestamp.toMillis();
            });
            _this.firstAdministration = medAdmins[0];
            _this.lastAdmininistration = medAdmins[medAdmins.length - 1];
            var admins = [];
            for (var i = 0; i < medAdmins.length; i++) {
                var admin = medAdmins[i];
                // We want the dose counts and day counts to start with 1 so we
                // add 1 to the day count and the index for the dose.
                var dayCount = admin.timestamp.diff(_this.firstAdministration.timestamp)
                    .as('day') + 1;
                var annotated = new _medication_administration__WEBPACK_IMPORTED_MODULE_3__["AnnotatedAdministration"](admin, i + 1 /* dose in order starts at 1 */, dayCount, i > 0 ? admins[i - 1] : undefined);
                admins.push(annotated);
            }
            _this.administrationsForOrder =
                new _medication_administration__WEBPACK_IMPORTED_MODULE_3__["MedicationAdministrationSet"](admins);
            return _this;
        }, function (rejection) {
            // Throw an error if the construction of the
            // MedicationAdministration results in an error.
            throw rejection;
        });
    };
    return MedicationOrder;
}(_fhir_resource_set__WEBPACK_IMPORTED_MODULE_1__["LabeledClass"]));

/**
 * A set of MedicationOrders that belong together as part of the same
 * series, representing all orders for the medicine in a given time period.
 */
var MedicationOrderSet = /** @class */ (function (_super) {
    __extends(MedicationOrderSet, _super);
    /**
     * Constructor for MedicationOrderSet.
     * @param MedicationOrderList The list of MedicationOrders belonging
     *     together. This list is sorted by first MedicationAdministration for
     *     each order.
     * @throws Error if the observations have different labels/RxNormCodes, or
     *     if there is not a label/RxNormCode.
     */
    function MedicationOrderSet(medicationOrderList) {
        var _this = this;
        // Sort the list by first administration.
        medicationOrderList = medicationOrderList.sort(function (a, b) {
            return a.firstAdministration.timestamp.toMillis() -
                b.firstAdministration.timestamp.toMillis();
        });
        _this = _super.call(this, medicationOrderList) || this;
        // Set the RxNormCode and MedicationConceptGroup for this
        // MedicationOrderSet.
        // TODO(b/117327111): Restructure FhirResourceSet to take in a list of
        // attributes to check sameness for
        if (medicationOrderList.length > 0) {
            var firstRxNorm = medicationOrderList[0].rxNormCode;
            if (!firstRxNorm) {
                throw Error('The first resource does not have an RxNorm code.');
            }
            for (var _i = 0, medicationOrderList_1 = medicationOrderList; _i < medicationOrderList_1.length; _i++) {
                var rs = medicationOrderList_1[_i];
                if (rs.rxNormCode !== firstRxNorm) {
                    throw Error('The resource list in this set has mixed RxNorm codes.');
                }
            }
            _this.rxNormCode = firstRxNorm;
            _this.medicationConcept = _this.rxNormCode.displayGrouping;
            _this.minDose = Math.min.apply(Math, medicationOrderList.map(function (x) { return x.administrationsForOrder.minDose; }));
            _this.maxDose = Math.max.apply(Math, medicationOrderList.map(function (x) { return x.administrationsForOrder.maxDose; }));
            var units = new Set(medicationOrderList.map(function (x) { return x.administrationsForOrder.unit; }));
            if (units.size > 1) {
                throw Error('Different units in the order set: ' + Array.from(units.values()));
            }
            _this.unit = Object(_unit_utils__WEBPACK_IMPORTED_MODULE_2__["fixUnitAbbreviations"])(Array.from(units.values())[0]);
        }
        return _this;
    }
    return MedicationOrderSet;
}(_fhir_resource_set__WEBPACK_IMPORTED_MODULE_1__["FhirResourceSet"]));

/* tslint:enable:object-literal-shorthand*/


/***/ }),

/***/ "./src/app/fhir-data-classes/medication.ts":
/*!*************************************************!*\
  !*** ./src/app/fhir-data-classes/medication.ts ***!
  \*************************************************/
/*! exports provided: ContainedMedication */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ContainedMedication", function() { return ContainedMedication; });
/* harmony import */ var _clinicalconcepts_rx_norm__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../clinicalconcepts/rx-norm */ "./src/app/clinicalconcepts/rx-norm.ts");
/* harmony import */ var _fhir_resource_set__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../fhir-resource-set */ "./src/app/fhir-resource-set.ts");
/* harmony import */ var _dosage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./dosage */ "./src/app/fhir-data-classes/dosage.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();



/**
 * This object represents relevant components of a medication contained as part
 * of a MedicationAdministration.
 * This is not a FHIR resource, and differs from the defined Medication
 * documentation at http://hl7.org/fhir/dstu2/medication.html.
 */
var ContainedMedication = /** @class */ (function (_super) {
    __extends(ContainedMedication, _super);
    function ContainedMedication(json, ingredients) {
        var _this = _super.call(this, json.code ? json.code.text : null) || this;
        // We want to construct new Medications for jsons containing RxNorm codes.
        if (json.resourceType !== 'Medication') {
            throw Error('Resource must be of type Medication');
        }
        if (json.code) {
            if (json.code.coding) {
                _this.code =
                    json.code.coding
                        .map(
                    // Map the codes to a boolean that is true only if the
                    // encoding is an RxNormCode encoding, and the RxNorm code
                    // appeas in our RxNormCode list that we care about.
                    function (coding) { return (!coding.system ||
                        coding.system.indexOf(_clinicalconcepts_rx_norm__WEBPACK_IMPORTED_MODULE_0__["RxNormCode"].CODING_STRING) !== -1) &&
                        _clinicalconcepts_rx_norm__WEBPACK_IMPORTED_MODULE_0__["RxNormCode"].fromCodeString(coding.code); })
                        // Filter out any codes that are not RxNorm codes.
                        .filter(function (code) { return !!code; })[0];
            }
        }
        if (!_this.code) {
            throw Error('Medication must have RxNorm code to be useful');
        }
        _this.id = json.id;
        var reference = ingredients.get(_this.id);
        if (!reference) {
            throw Error('Medication info must have been contained in ingredient list.');
        }
        if (_this.id) {
            //  The dosage format is different for contained
            // portions of Medications.
            var dosage = {
                dosage: {
                    quantity: {
                        value: reference.amount.numerator ?
                            reference.amount.numerator.value :
                            null,
                        unit: reference.amount.numerator ? reference.amount.numerator.unit :
                            null
                    },
                }
            };
            _this.dosage = new _dosage__WEBPACK_IMPORTED_MODULE_2__["Dosage"](dosage);
        }
        return _this;
    }
    return ContainedMedication;
}(_fhir_resource_set__WEBPACK_IMPORTED_MODULE_1__["LabeledClass"]));



/***/ }),

/***/ "./src/app/fhir-data-classes/observation-interpretation-valueset.ts":
/*!**************************************************************************!*\
  !*** ./src/app/fhir-data-classes/observation-interpretation-valueset.ts ***!
  \**************************************************************************/
/*! exports provided: OBSERVATION_INTERPRETATION_VALUESET_URL, CHECK_RESULT_CODE, NEGFLORA_CODE, NEG_CODE, ObservationInterpretation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OBSERVATION_INTERPRETATION_VALUESET_URL", function() { return OBSERVATION_INTERPRETATION_VALUESET_URL; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CHECK_RESULT_CODE", function() { return CHECK_RESULT_CODE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NEGFLORA_CODE", function() { return NEGFLORA_CODE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NEG_CODE", function() { return NEG_CODE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ObservationInterpretation", function() { return ObservationInterpretation; });
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
/** This is the URL for the coding system for observation interpretations. */
var OBSERVATION_INTERPRETATION_VALUESET_URL = 'http://hl7.org/fhir/ValueSet/observation-interpretation';
/**
 * These are codes corresponding to ObservationInterpretations used in
 * MicrobioGraph.
 */
var CHECK_RESULT_CODE = 'CHECKRESULT';
var NEGFLORA_CODE = 'NEGORFLORA';
var NEG_CODE = 'NEG';
/**
 * Represents the possible interpretations for observations. Each interpretation
 * has a code (usually 1-3 characters) plus a text description for display.
 * This class also keeps track of a map of codes to display text.
 */
var ObservationInterpretation = /** @class */ (function () {
    function ObservationInterpretation(code, display) {
        this.code = code;
        this.display = display;
        ObservationInterpretation.codeToObject.set(code, this);
    }
    ObservationInterpretation.codeToObject = new Map();
    return ObservationInterpretation;
}());

/**
 * These are the FHIR standard value set values.
 * http://hl7.org/fhir/valueset-observation-interpretation.html
 */
var STANDARD_FHIR_INTERPRETATIONS = [
    new ObservationInterpretation('<', 'Off scale low'),
    new ObservationInterpretation('>', 'Off scale high'),
    new ObservationInterpretation('A', 'Abnormal'),
    new ObservationInterpretation('A', 'Critically abnormal'),
    new ObservationInterpretation('AC', 'Anti-complementary substances present'),
    new ObservationInterpretation('B', 'Better'),
    new ObservationInterpretation('D', 'Significant change down'),
    new ObservationInterpretation('DET', 'Detected'),
    new ObservationInterpretation('H', 'High'),
    new ObservationInterpretation('HH', 'Critically high'),
    new ObservationInterpretation('HM', 'Hold for Medical Review'),
    new ObservationInterpretation('HU', 'Very high'),
    new ObservationInterpretation('I', 'Intermediate'),
    new ObservationInterpretation('IE', 'Insufficient evidence'),
    new ObservationInterpretation('IND', 'Indeterminate'),
    new ObservationInterpretation('L', 'Low'),
    new ObservationInterpretation('LL', 'Critically low'),
    new ObservationInterpretation('LU', 'Very low'),
    new ObservationInterpretation('MS', 'Moderately susceptible. Indicates for microbiology susceptibilities only.'),
    new ObservationInterpretation('N', 'Normal'),
    new ObservationInterpretation('ND', 'Not Detected'),
    new ObservationInterpretation(NEG_CODE, 'Negative'),
    new ObservationInterpretation('NR', 'Non-reactive'),
    new ObservationInterpretation('NS', 'Non-susceptible'),
    new ObservationInterpretation('null', 'No range defined, or normal ranges don\'t apply'),
    new ObservationInterpretation('OBX', 'Interpretation qualifiers in separate OBX segments'),
    new ObservationInterpretation('POS', 'Positive'),
    new ObservationInterpretation('QCF', 'Quality Control Failure'),
    new ObservationInterpretation('R', 'Resistant'),
    new ObservationInterpretation('RR', 'Reactive'),
    new ObservationInterpretation('S', 'Susceptible'),
    new ObservationInterpretation('SDD', 'Susceptible-dose dependent'),
    new ObservationInterpretation('SYN-R', 'Synergy - resistant'),
    new ObservationInterpretation('SYN-S', 'Synergy - susceptible'),
    new ObservationInterpretation('TOX', 'Cytotoxic substance present'),
    new ObservationInterpretation('U', 'Significant change up'),
    new ObservationInterpretation('VS', 'Very susceptible. Indicates for microbiology susceptibilities only.'),
    new ObservationInterpretation('W', 'Worse'),
    new ObservationInterpretation('WR', 'Weakly reactive')
];
/**
 * This valueset is extensible, so here are some that BCH extends it with
 * for its microbiology results.
 */
var BCH_CUSTOM_INTERPRETATIONS = [
    new ObservationInterpretation(CHECK_RESULT_CODE, 'Check result'),
    new ObservationInterpretation(NEGFLORA_CODE, 'Negative or Flora')
];
var ALL_INTERPRETATIONS = [].concat(BCH_CUSTOM_INTERPRETATIONS, STANDARD_FHIR_INTERPRETATIONS);


/***/ }),

/***/ "./src/app/fhir-data-classes/observation-set.ts":
/*!******************************************************!*\
  !*** ./src/app/fhir-data-classes/observation-set.ts ***!
  \******************************************************/
/*! exports provided: ObservationSet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ObservationSet", function() { return ObservationSet; });
/* harmony import */ var _fhir_resource_set__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../fhir-resource-set */ "./src/app/fhir-resource-set.ts");
/* harmony import */ var _unit_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../unit_utils */ "./src/app/unit_utils.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();


/**
 * A set of observations that belong together as part of the same series.
 */
var ObservationSet = /** @class */ (function (_super) {
    __extends(ObservationSet, _super);
    /**
     * Constructor for ObservationSet.
     * @param observationList The list of observations belonging together.
     * @throws Error if the observations have different labels, as this indicates
     *     that they are data points from different series, or if there is not
     *     a label.
     */
    function ObservationSet(observationList) {
        var _this = _super.call(this, observationList) || this;
        /**
         * Whether or not all Observations belonging to this ObservationSet contain
         * all qualitative results rather than numerical values.
         */
        _this.allQualitative = false;
        var firstNormalRange;
        var firstUnit;
        if (observationList.length > 0) {
            firstNormalRange = observationList[0].observation.normalRange;
            firstUnit = observationList[0].observation.unit;
        }
        // Ensure that the labels of the data are all the same. Also ensure that
        // we only set a normal range if all the observations have a matching
        // normal range.
        var differentNormalRanges = false;
        var differentUnits = false;
        for (var _i = 0, observationList_1 = observationList; _i < observationList_1.length; _i++) {
            var obs = observationList_1[_i];
            // Some observations may not have a normal range.
            if (obs.observation.normalRange &&
                (obs.observation.normalRange[0] !== firstNormalRange[0] ||
                    obs.observation.normalRange[1] !== firstNormalRange[1])) {
                differentNormalRanges = true;
            }
            // Some observations may not have a normal range.
            if (obs.observation.unit && obs.observation.unit !== firstUnit) {
                differentUnits = true;
            }
        }
        if (!differentNormalRanges) {
            _this.normalRange = firstNormalRange;
        }
        if (!differentUnits && firstUnit) {
            _this.unit = Object(_unit_utils__WEBPACK_IMPORTED_MODULE_1__["fixUnitAbbreviations"])(firstUnit);
        }
        _this.allQualitative = observationList.every(function (obs) { return (obs.observation.result !== null && !obs.observation.value); });
        return _this;
    }
    return ObservationSet;
}(_fhir_resource_set__WEBPACK_IMPORTED_MODULE_0__["FhirResourceSet"]));



/***/ }),

/***/ "./src/app/fhir-data-classes/observation.ts":
/*!**************************************************!*\
  !*** ./src/app/fhir-data-classes/observation.ts ***!
  \**************************************************/
/*! exports provided: ObservationStatus, Observation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ObservationStatus", function() { return ObservationStatus; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Observation", function() { return Observation; });
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! luxon */ "./node_modules/luxon/build/cjs-browser/luxon.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(luxon__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _clinicalconcepts_bch_microbio_code__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../clinicalconcepts/bch-microbio-code */ "./src/app/clinicalconcepts/bch-microbio-code.ts");
/* harmony import */ var _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../clinicalconcepts/loinc-code */ "./src/app/clinicalconcepts/loinc-code.ts");
/* harmony import */ var _fhir_resource_set__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../fhir-resource-set */ "./src/app/fhir-resource-set.ts");
/* harmony import */ var _unit_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../unit_utils */ "./src/app/unit_utils.ts");
/* harmony import */ var _observation_interpretation_valueset__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./observation-interpretation-valueset */ "./src/app/fhir-data-classes/observation-interpretation-valueset.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();






/**
 * FHIR element for ObservationStatus, from the DSTU2 version of the
 * standard.
 * http://hl7.org/fhir/DSTU2/valueset-observation-status.html
 */
var ObservationStatus;
(function (ObservationStatus) {
    ObservationStatus["Registered"] = "Registered";
    ObservationStatus["Preliminary"] = "Preliminary";
    ObservationStatus["Final"] = "Final";
    ObservationStatus["Amended"] = "Amended";
    ObservationStatus["Cancelled"] = "Cancelled";
    ObservationStatus["EnteredInError"] = "Enteredinerror";
    ObservationStatus["Unknown"] = "Unknown";
})(ObservationStatus || (ObservationStatus = {}));
var statusToEnumMap = new Map([
    ['registered', ObservationStatus.Registered],
    ['preliminary', ObservationStatus.Preliminary],
    ['final', ObservationStatus.Final],
    ['amended', ObservationStatus.Amended],
    ['cancelled', ObservationStatus.Cancelled],
    ['entered-in-error', ObservationStatus.EnteredInError],
    ['unknown', ObservationStatus.Unknown],
]);
/**
 * This object represents a FHIR Observation. It does not contain all the
 * information in a standard Observation
 * (see https://www.hl7.org/fhir/observation.html#resource) but instead stores
 * only the information we're interested in seeing.
 *
 * In general, in terms of the MedTimeLine app, we represent an Observation
 * as a point on a line graph for a lab or a vital sign. Observations also hold
 * information about microbiology report results that show up in the
 * microbiology graph tooltips.
 * TODO(b/126222425): Add a descriptive readme to this folder.
 */
var Observation = /** @class */ (function (_super) {
    __extends(Observation, _super);
    /**
     * Makes an Observation out of a JSON object that represents a
     * a FHIR observation.
     * @param json A JSON object that represents a FHIR observation.
     */
    function Observation(json) {
        var _this = _super.call(this, Observation.getLabel(json)) || this;
        _this.json = json;
        _this.codes = [];
        _this.innerComponents = [];
        // TODO(b/111990521): If there are hours and minutes then we can
        // guarantee timezone is specified, but if not, then the timezone might
        // not be specified! I'm not sure how to best handle that.
        // https://www.hl7.org/fhir/DSTU2/datatypes.html#dateTime
        _this.timestamp = json.effectiveDateTime ?
            luxon__WEBPACK_IMPORTED_MODULE_0__["DateTime"].fromISO(json.effectiveDateTime).toUTC() :
            json.issued ? luxon__WEBPACK_IMPORTED_MODULE_0__["DateTime"].fromISO(json.issued).toUTC() : null;
        if (json.code) {
            if (json.code.coding) {
                // TODO(b/121318193): Implement better parsing of Observations with BCH
                // Codes (associated with Microbiology data).
                if (json.code.coding[0].system === _clinicalconcepts_bch_microbio_code__WEBPACK_IMPORTED_MODULE_1__["BCHMicrobioCode"].CODING_STRING) {
                    _this.codes = json.code.coding.map(function (coding) { return _clinicalconcepts_bch_microbio_code__WEBPACK_IMPORTED_MODULE_1__["BCHMicrobioCode"].fromCodeString(coding.code); });
                    _this.display = json.code.coding[0].display;
                }
                else {
                    _this.codes =
                        json.code.coding
                            .map(
                        // Map the codes to a boolean that is true only if the
                        // encoding is a LOINC encoding, and the LOINC code appeas
                        // in our LOINCCode list that we care about.
                        function (coding) { return (!coding.system ||
                            coding.system.indexOf(_clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_2__["LOINCCode"].CODING_STRING) !== -1) &&
                            _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_2__["LOINCCode"].fromCodeString(coding.code); })
                            // Filter out any codes that are not LOINC codes.
                            .filter(function (code) { return !!code; });
                }
            }
        }
        if (json.interpretation && json.interpretation.coding) {
            var coding = json.interpretation.coding[0];
            if (coding.system === _observation_interpretation_valueset__WEBPACK_IMPORTED_MODULE_5__["OBSERVATION_INTERPRETATION_VALUESET_URL"]) {
                if (_observation_interpretation_valueset__WEBPACK_IMPORTED_MODULE_5__["ObservationInterpretation"].codeToObject.has(coding.code)) {
                    _this.interpretation =
                        _observation_interpretation_valueset__WEBPACK_IMPORTED_MODULE_5__["ObservationInterpretation"].codeToObject.get(coding.code);
                }
                else {
                    throw Error('Unsupported interpretation code: ' + JSON.stringify(coding));
                }
            }
            // Silently ignore encodings coming from other systems.
        }
        if (json.component) {
            json.component.forEach(function (element) {
                var innerObs = new Observation(element);
                if (!innerObs.timestamp) {
                    innerObs.timestamp = _this.timestamp;
                }
                _this.innerComponents.push(innerObs);
            });
        }
        if (!_this.codes || _this.codes.length === 0) {
            throw Error('Observations have to have a LOINC code to be useful.' +
                ' Label: ' + _this.label + '\nJSON: ' + JSON.stringify(json));
        }
        if (!_this.label) {
            throw Error('Observations have to have a label to be useful. ' +
                'JSON: ' + JSON.stringify(json));
        }
        /*
        TODO(b/119673528): Work out which labels we're going to use for BCH, then
        re-enable.
        // Check the observation label against the LOINC code label.
        if (this.label !== this.loincCodes[0].label) {
          throw Error(
              'The label for this observation\'s LOINC code doesn\'t match ' +
              ' the label in the data. Observation label: ' + this.label +
              ' LOINC label: ' + this.loincCodes[0].label);
        }
        */
        _this.value = json.valueQuantity ? json.valueQuantity : null;
        if (_this.value) {
            _this.unit = Object(_unit_utils__WEBPACK_IMPORTED_MODULE_4__["fixUnitAbbreviations"])(_this.value.unit);
        }
        // We must calculate precision before the value is stored as a number, where
        // precision is lost.
        if (json.valueQuantity && json.valueQuantity.value) {
            var values = json.valueQuantity.value.toString().split('.');
            _this.precision = values.length > 1 ? values[1].length : 0;
        }
        _this.result =
            json.valueCodeableConcept ? json.valueCodeableConcept.text : null;
        // TODO(b/121318193): Impement better parsing of Observations with BCH Codes
        // (associated with Microbiology data). These Observations might not have
        // values or results.
        if (_this.value === null && _this.result === null && !_this.interpretation &&
            _this.innerComponents.length === 0) {
            throw Error('An Observation must have a value, result, inner components, ' +
                'or an interpretation to be useful. JSON: ' + JSON.stringify(json));
        }
        // The FHIR standard says that if there's only one range then it should be
        // what is "normal" for that measure. Otherwise they should be labeled.
        // We are going to err on the side of safety and not include a normal range
        // unless there's just the one, and it includes a high and low field.
        // https://www.hl7.org/fhir/DSTU2/observation.html#4.20.4.4
        // TODO(b/113575661): handle multiple ranges
        if (json.referenceRange && json.referenceRange.length === 1) {
            if (json.referenceRange[0].low && json.referenceRange[0].high) {
                _this.normalRange = [
                    json.referenceRange[0].low.value, json.referenceRange[0].high.value
                ];
            }
        }
        _this.status = statusToEnumMap.get(json.status);
        return _this;
    }
    Observation.getLabel = function (json) {
        var label;
        if (json.code) {
            label = json.code.text;
            if (json.code.coding) {
                if (json.code.coding[0].system === _clinicalconcepts_bch_microbio_code__WEBPACK_IMPORTED_MODULE_1__["BCHMicrobioCode"].CODING_STRING) {
                    label = json.code.coding[0].display;
                }
            }
        }
        return label;
    };
    return Observation;
}(_fhir_resource_set__WEBPACK_IMPORTED_MODULE_3__["LabeledClass"]));



/***/ }),

/***/ "./src/app/fhir-data-classes/specimen.ts":
/*!***********************************************!*\
  !*** ./src/app/fhir-data-classes/specimen.ts ***!
  \***********************************************/
/*! exports provided: Specimen */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Specimen", function() { return Specimen; });
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! luxon */ "./node_modules/luxon/build/cjs-browser/luxon.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(luxon__WEBPACK_IMPORTED_MODULE_0__);
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

/**
 * FHIR resource for a Specimen, from the DSTU2 standard.
 * https://www.hl7.org/fhir/DSTU2/specimen.html
 */
var Specimen = /** @class */ (function () {
    function Specimen(json) {
        if (json.id) {
            this.id = json.id;
        }
        if (!json.type) {
            throw Error('A specimen must have a type to be useful. JSON: ' +
                JSON.stringify(json));
        }
        this.type = json.type.text;
        if (!json.collection) {
            throw Error('A specimen must have collection information to be useful. JSON: ' +
                JSON.stringify(json));
        }
        if (json.collection.collectedPeriod && json.collection.collectedDateTime) {
            throw Error('Only collectedPeriod or collectionDateTime should be defined. JSON: ' +
                JSON.stringify(json));
        }
        if (json.collection.collectedPeriod) {
            var collectedPeriod = json.collection.collectedPeriod;
            // If only the start time is present, put it into collectedDateTime.
            if (collectedPeriod.start && !collectedPeriod.end) {
                this.collectedDateTime = luxon__WEBPACK_IMPORTED_MODULE_0__["DateTime"].fromISO(collectedPeriod.start);
            }
            else {
                this.collectedPeriod = luxon__WEBPACK_IMPORTED_MODULE_0__["Interval"].fromDateTimes(luxon__WEBPACK_IMPORTED_MODULE_0__["DateTime"].fromISO(collectedPeriod.start), luxon__WEBPACK_IMPORTED_MODULE_0__["DateTime"].fromISO(collectedPeriod.end));
            }
        }
        if (json.collection.collectedDateTime) {
            this.collectedDateTime =
                luxon__WEBPACK_IMPORTED_MODULE_0__["DateTime"].fromISO(json.collection.collectedDateTime);
        }
    }
    return Specimen;
}());



/***/ }),

/***/ "./src/app/fhir-http.service.ts":
/*!**************************************!*\
  !*** ./src/app/fhir-http.service.ts ***!
  \**************************************/
/*! exports provided: FhirHttpService */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FhirHttpService", function() { return FhirHttpService; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_platform_browser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/platform-browser */ "./node_modules/@angular/platform-browser/fesm5/platform-browser.js");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../constants */ "./src/constants.ts");
/* harmony import */ var _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./clinicalconcepts/loinc-code */ "./src/app/clinicalconcepts/loinc-code.ts");
/* harmony import */ var _clinicalconcepts_resource_code_manager__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./clinicalconcepts/resource-code-manager */ "./src/app/clinicalconcepts/resource-code-manager.ts");
/* harmony import */ var _clinicalconcepts_rx_norm__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./clinicalconcepts/rx-norm */ "./src/app/clinicalconcepts/rx-norm.ts");
/* harmony import */ var _debugger_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./debugger.service */ "./src/app/debugger.service.ts");
/* harmony import */ var _fhir_data_classes_encounter__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./fhir-data-classes/encounter */ "./src/app/fhir-data-classes/encounter.ts");
/* harmony import */ var _fhir_data_classes_medication_administration__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./fhir-data-classes/medication-administration */ "./src/app/fhir-data-classes/medication-administration.ts");
/* harmony import */ var _fhir_data_classes_medication_order__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./fhir-data-classes/medication-order */ "./src/app/fhir-data-classes/medication-order.ts");
/* harmony import */ var _fhir_data_classes_observation__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./fhir-data-classes/observation */ "./src/app/fhir-data-classes/observation.ts");
/* harmony import */ var _fhir_service__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./fhir.service */ "./src/app/fhir.service.ts");
/* harmony import */ var _smart_on_fhir_client__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./smart-on-fhir-client */ "./src/app/smart-on-fhir-client.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (undefined && undefined.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};













var GREATER_OR_EQUAL = 'ge';
var LESS_OR_EQUAL = 'le';
// The Cerner implementation has a maximum result return of 100 for
// observations.
var CERNER_MAX_OBS_RESULTS_RETURNED = 100;
var FhirHttpService = /** @class */ (function (_super) {
    __extends(FhirHttpService, _super);
    function FhirHttpService(debugService, smartOnFhirClient, sanitizer) {
        var _this = _super.call(this) || this;
        _this.debugService = debugService;
        _this.sanitizer = sanitizer;
        _this.createContentTypeString = 'application/xhtml+xml;charset=utf-8';
        // Create a promise which resolves to the smart API when the smart API is
        // ready. This allows clients of this service to call service methods
        // which depend on the API, regardless of whether the API is ready or not.
        _this.smartApiPromise = new Promise(function (resolve, reject) { return smartOnFhirClient.oauth2.ready(function (smart) { return resolve(smart); }, function (err) { return reject(err); }); });
        return _this;
    }
    /**
     * Gets observations from a specified date range with a specific LOINC code.
     * @param code The LOINC code for which to get observations.
     * @param dateRange The time interval observations should fall between.
     * @param limitCount If set, the number of observations that should be
     *     queried for
     */
    FhirHttpService.prototype.getObservationsWithCode = function (code, dateRange, limitCount) {
        var _this = this;
        var queryParams = {
            type: _constants__WEBPACK_IMPORTED_MODULE_2__["FhirResourceType"].Observation,
            query: {
                code: _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_3__["LOINCCode"].CODING_STRING + '|' + code.codeString,
                date: {
                    $and: [
                        GREATER_OR_EQUAL + dateRange.start.toISO(),
                        LESS_OR_EQUAL + dateRange.end.toISO()
                    ]
                },
                _count: limitCount ? limitCount : CERNER_MAX_OBS_RESULTS_RETURNED
            }
        };
        return this.smartApiPromise.then(function (smartApi) {
            return smartApi.patient.api.fetchAll(queryParams)
                .then(function (results) {
                return results
                    .map(function (result) {
                    return new _fhir_data_classes_observation__WEBPACK_IMPORTED_MODULE_10__["Observation"](result);
                })
                    // TODO(b/126775896): Determine which statuses to
                    // filter out.
                    .filter(function (result) { return result.status !==
                    _fhir_data_classes_observation__WEBPACK_IMPORTED_MODULE_10__["ObservationStatus"].EnteredInError; });
            }, 
            // Do not return any Observations for this code if one of
            // the Observation constructions throws an error.
            function (rejection) {
                _this.debugService.logError(rejection);
                throw rejection;
            });
        });
    };
    /**
     * Gets medication data from a specified date range with a specific Rx code
     * @param code The RxNormCode codes for which to get observations.
     * @param dateRange The time interval observations should fall between.
     * @param limitCount If provided, the maximum number of observations to
     *     query for.
     */
    FhirHttpService.prototype.getMedicationAdministrationsWithCode = function (code, dateRange, limitCount) {
        var _this = this;
        var queryParams = {
            type: _constants__WEBPACK_IMPORTED_MODULE_2__["FhirResourceType"].MedicationAdministration,
            query: {
                effectivetime: {
                    $and: [
                        GREATER_OR_EQUAL + dateRange.start.toISO(),
                        LESS_OR_EQUAL + dateRange.end.toISO()
                    ]
                },
                medication: {
                    code: _clinicalconcepts_rx_norm__WEBPACK_IMPORTED_MODULE_5__["RxNormCode"].CODING_STRING + '|' + code.codeString,
                }
            }
        };
        if (limitCount) {
            queryParams.query['_count'] = limitCount;
        }
        return this.smartApiPromise.then(function (smartApi) { return smartApi.patient.api.fetchAll(queryParams)
            .then(function (results) { return results.map(function (result) {
            try {
                return new _fhir_data_classes_medication_administration__WEBPACK_IMPORTED_MODULE_8__["MedicationAdministration"](result);
            }
            catch (e) {
                _this.debugService.logError(e);
                throw e;
            }
        }); }, 
        // Do not return any MedicationAdministrations for
        // this code if one of the MedicationAdministration
        // constructions throws an error.
        function (rejection) {
            _this.debugService.logError(rejection);
            throw rejection;
        }); });
    };
    /**
     * Gets order for specified external id.
     * @param id The id to pull the order from.
     */
    FhirHttpService.prototype.getMedicationOrderWithId = function (id) {
        var _this = this;
        return this.smartApiPromise.then(function (smartApi) {
            return smartApi.patient.api
                .read({ type: _constants__WEBPACK_IMPORTED_MODULE_2__["FhirResourceType"].MedicationOrder, 'id': id })
                .then(function (result) {
                return new _fhir_data_classes_medication_order__WEBPACK_IMPORTED_MODULE_9__["MedicationOrder"](result.data);
            }, 
            // Do not return any MedicationOrders for
            // this code if one of the MedicationOrder
            // constructions throws an error.
            function (rejection) {
                _this.debugService.logError(rejection);
                throw rejection;
            });
        });
    };
    /**
     * Gets administrations for specified order id.
     * @param id The id to pull the order from.
     */
    FhirHttpService.prototype.getMedicationAdministrationsWithOrder = function (id) {
        var _this = this;
        var queryParams = {
            type: _constants__WEBPACK_IMPORTED_MODULE_2__["FhirResourceType"].MedicationAdministration,
            query: {
                prescription: { reference: [_constants__WEBPACK_IMPORTED_MODULE_2__["FhirResourceType"].MedicationOrder, id].join('/') }
            }
        };
        return this.smartApiPromise.then(function (smartApi) { return smartApi.patient.api.fetchAll(queryParams)
            .then(function (results) {
            results.map(function (result) {
                return new _fhir_data_classes_medication_administration__WEBPACK_IMPORTED_MODULE_8__["MedicationAdministration"](result);
            });
        }, 
        // Do not return any MedicationOrders for
        // this code if one of the MedicationOrder
        // constructions throws an error.
        function (rejection) {
            _this.debugService.logError(rejection);
            throw rejection;
        }); });
    };
    /**
     * Gets the encounters for the patient for any encounter that falls in the
     * given date range.
     * @param dateRange Return all encounters that covered any time in this
     *   date range.
     */
    FhirHttpService.prototype.getEncountersForPatient = function (dateRange) {
        var _this = this;
        var queryParams = {
            type: _constants__WEBPACK_IMPORTED_MODULE_2__["FhirResourceType"].Encounter,
        };
        if (!dateRange) {
            dateRange = _constants__WEBPACK_IMPORTED_MODULE_2__["APP_TIMESPAN"];
        }
        // The Cerner implementation of the Encounter search does not offer any
        // filtering by date at this point, so we grab all the encounters
        // then filter them.
        return this.smartApiPromise.then(function (smartApi) { return smartApi.patient.api.fetchAll(queryParams)
            .then(function (results) {
            results =
                results
                    .map(function (result) {
                    return new _fhir_data_classes_encounter__WEBPACK_IMPORTED_MODULE_7__["Encounter"](result);
                })
                    .filter(function (encounter) {
                    return dateRange.intersection(encounter.period) !== null;
                });
            return results;
        }, function (rejection) {
            _this.debugService.logError(rejection);
        }); });
    };
    /**
     * Saves the current HTML of the graphs rendered as a DocumentReference
     * (static save).
     * @param html The inner HTML to keep in the Document.
     * @param date The date the note was written on.
     */
    FhirHttpService.prototype.saveStaticNote = function (html, date) {
        html = this.sanitizer.sanitize(_angular_core__WEBPACK_IMPORTED_MODULE_0__["SecurityContext"].HTML, html);
        var doc = new DOMParser().parseFromString(html, 'text/html');
        var xhtml = new XMLSerializer().serializeToString(doc);
        var testData = {
            resource: {
                resourceType: _constants__WEBPACK_IMPORTED_MODULE_2__["FhirResourceType"].DocumentReference,
                type: {
                    coding: [{
                            system: _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_3__["LOINCCode"].CODING_STRING,
                            code: _clinicalconcepts_resource_code_manager__WEBPACK_IMPORTED_MODULE_4__["documentReferenceLoinc"].codeString,
                        }],
                },
                indexed: date,
                status: 'current',
                // https://fhir.cerner.com/millennium/dstu2/infrastructure/document-reference/#body-fields
                content: [{
                        attachment: {
                            contentType: this.createContentTypeString,
                            data: btoa(xhtml),
                        }
                    }],
            }
        };
        // TODO(b/119119092): Currently we only have permissions to write for
        // Timmy (patient id 4342012), not Wilma
        this.smartApiPromise.then(function (smartApi) {
            testData['resource']['subject'] = {
                reference: [_constants__WEBPACK_IMPORTED_MODULE_2__["FhirResourceType"].Patient, smartApi.patient.id].join('/')
            };
            testData['resource']['context'] = {
                encounter: {
                    reference: [
                        _constants__WEBPACK_IMPORTED_MODULE_2__["FhirResourceType"].Encounter, smartApi.tokenResponse.encounter
                    ].join('/')
                }
            };
            smartApi.patient.api.create(testData);
            return smartApi;
        });
    };
    /**
     * Gets the DiagnosticReports for the patient for any report that falls in
     * the given date range.
     * @param codeGroup The CodeGroup to retrieve DiagnosticReports for.
     * @param dateRange Return all DiagnosticReports that covered any time in this
     *   date range.
     */
    // TODO(b/119121684): Make API calls to get DiagnosticReports.
    FhirHttpService.prototype.getDiagnosticReports = function (codeGroup, dateRange) {
        return Promise.resolve([]);
    };
    FhirHttpService = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Injectable"])(),
        __param(1, Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Inject"])(_smart_on_fhir_client__WEBPACK_IMPORTED_MODULE_12__["SMART_ON_FHIR_CLIENT"])),
        __metadata("design:paramtypes", [_debugger_service__WEBPACK_IMPORTED_MODULE_6__["DebuggerService"], Object, _angular_platform_browser__WEBPACK_IMPORTED_MODULE_1__["DomSanitizer"]])
    ], FhirHttpService);
    return FhirHttpService;
}(_fhir_service__WEBPACK_IMPORTED_MODULE_11__["FhirService"]));



/***/ }),

/***/ "./src/app/fhir-launch/fhir-launch.component.css":
/*!*******************************************************!*\
  !*** ./src/app/fhir-launch/fhir-launch.component.css ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = ""

/***/ }),

/***/ "./src/app/fhir-launch/fhir-launch.component.html":
/*!********************************************************!*\
  !*** ./src/app/fhir-launch/fhir-launch.component.html ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<span *ngIf=\"!error\">Launching authentication...</span>\n<div *ngIf=\"useDebugger\" style=\"background-color: white\">\n  Authentication Information<br />\n  Base URI: {{this.baseURL}}<br />\n  Redirect URI : {{this.redirectURL}}<br />\n  Scopes: {{this.scope}};<br />\n  URL parameters: {{this.parameters}} <br />\n  <button (click)=\"beginAuthenticationFlow()\">Click here to continue authentication.</button>\n</div>\n<span *ngIf=\"error\">Error: This app is not configured for this EHR.</span>\n"

/***/ }),

/***/ "./src/app/fhir-launch/fhir-launch.component.ts":
/*!******************************************************!*\
  !*** ./src/app/fhir-launch/fhir-launch.component.ts ***!
  \******************************************************/
/*! exports provided: FhirLaunchComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FhirLaunchComponent", function() { return FhirLaunchComponent; });
/* harmony import */ var fhirclient__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fhirclient */ "./node_modules/fhirclient/fhir-client.js");
/* harmony import */ var fhirclient__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fhirclient__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/router */ "./node_modules/@angular/router/fesm5/router.js");
/* harmony import */ var _environments_environment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../environments/environment */ "./src/environments/environment.ts");
/* harmony import */ var _fhir_config_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./../fhir_config.js */ "./src/app/fhir_config.js");
/* harmony import */ var _fhir_config_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_fhir_config_js__WEBPACK_IMPORTED_MODULE_4__);
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};






var FhirLaunchComponent = /** @class */ (function () {
    function FhirLaunchComponent(router, route) {
        this.router = router;
        this.route = route;
        this.error = false;
        this.scope = [
            'launch', 'patient/Observation.read', 'patient/Patient.read',
            'patient/MedicationOrder.read', 'patient/MedicationAdministration.read',
            'patient/DocumentReference.read', 'patient/DocumentReference.write',
            'patient/Encounter.read'
        ].join(' ');
        this.parameters = new Array();
    }
    FhirLaunchComponent.prototype.ngOnInit = function () {
        var _this = this;
        if (_environments_environment__WEBPACK_IMPORTED_MODULE_3__["environment"].useMockServer) {
            this.router.navigate(['']);
        }
        else {
            this.useDebugger = _environments_environment__WEBPACK_IMPORTED_MODULE_3__["environment"].useDebugger;
            // If we're using the debugger, pause before authenticating and display
            // all the credentials we're passing in.
            if (this.useDebugger) {
                this.clientId = _fhir_config_js__WEBPACK_IMPORTED_MODULE_4__["credentials"].client_id;
                this.baseURL = _fhir_config_js__WEBPACK_IMPORTED_MODULE_4__["url"].baseURL;
                this.redirectURL = _fhir_config_js__WEBPACK_IMPORTED_MODULE_4__["url"].redirectURL;
                this.route.queryParams.subscribe(function (params) {
                    _this.parameters.push(JSON.stringify(params));
                });
            }
            else {
                this.beginAuthenticationFlow();
            }
        }
    };
    FhirLaunchComponent.prototype.beginAuthenticationFlow = function () {
        var clientId = _fhir_config_js__WEBPACK_IMPORTED_MODULE_4__["credentials"].client_id;
        if (!clientId) {
            this.error = true;
        }
        else {
            FHIR.oauth2.authorize({
                'client_id': clientId,
                'scope': this.scope,
                'redirect_uri': _fhir_config_js__WEBPACK_IMPORTED_MODULE_4__["url"].redirectURL
            });
        }
    };
    FhirLaunchComponent = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'app-fhir-launch',
            template: __webpack_require__(/*! ./fhir-launch.component.html */ "./src/app/fhir-launch/fhir-launch.component.html"),
            styles: [__webpack_require__(/*! ./fhir-launch.component.css */ "./src/app/fhir-launch/fhir-launch.component.css")]
        }),
        __metadata("design:paramtypes", [_angular_router__WEBPACK_IMPORTED_MODULE_2__["Router"], _angular_router__WEBPACK_IMPORTED_MODULE_2__["ActivatedRoute"]])
    ], FhirLaunchComponent);
    return FhirLaunchComponent;
}());



/***/ }),

/***/ "./src/app/fhir-resource-set.ts":
/*!**************************************!*\
  !*** ./src/app/fhir-resource-set.ts ***!
  \**************************************/
/*! exports provided: LabeledClass, FhirResourceSet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LabeledClass", function() { return LabeledClass; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FhirResourceSet", function() { return FhirResourceSet; });
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
/**
 * A class that has a label attribute.
 */
var LabeledClass = /** @class */ (function () {
    function LabeledClass(label) {
        this.label = label;
    }
    return LabeledClass;
}());

/**
 * A set of FHIR resources. All resources that are a part of this set must
 * have the same label.
 */
var FhirResourceSet = /** @class */ (function () {
    /**
     * Constructor for FhirResourceSet.
     * @param resourceList The list of resources belonging together.
     * @throws Error if the resources have different labels, or if there is not
     *     a label.
     */
    function FhirResourceSet(resourceList) {
        if (!resourceList) {
            throw Error('Resource list is undefined.');
        }
        if (resourceList.length > 0) {
            var firstLabel = resourceList[0].label;
            if (!firstLabel) {
                throw Error('The first resource does not have a label.');
            }
            var allLabels = new Set(resourceList.map(function (rs) { return rs.label.toLowerCase(); }));
            if (allLabels.size !== 1) {
                throw Error('The resource list in this set has mixed labels: ' +
                    Array.from(allLabels.values()));
            }
            this.label = firstLabel;
        }
        this.resourceList = resourceList;
    }
    return FhirResourceSet;
}());



/***/ }),

/***/ "./src/app/fhir.service.ts":
/*!*********************************!*\
  !*** ./src/app/fhir.service.ts ***!
  \*********************************/
/*! exports provided: FhirService */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FhirService", function() { return FhirService; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rxjs */ "./node_modules/rxjs/_esm5/index.js");
/* harmony import */ var _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./clinicalconcepts/loinc-code */ "./src/app/clinicalconcepts/loinc-code.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};



var FhirService = /** @class */ (function () {
    function FhirService() {
    }
    /**
     * Returns whether there are any observations with this code in the given
     * time range.
     * @param code The LOINC code for which to get observations.
     * @param dateRange The time interval observations should fall between.
     */
    FhirService.prototype.observationsPresentWithCode = function (code, dateRange) {
        // Just ask for one result to reduce the call time.
        return this.getObservationsWithCode(code, dateRange, 1)
            .then(function (obs) { return obs.length > 0; }, function (rejection) {
            // If any Observation for this code results in an error, do not show
            // any Observations at all.
            throw rejection;
        });
    };
    /**
     * Returns whether there are any observations with this code in the given
     * time range.
     * @param code The BCHMicrobio code for which to get observations.
     * @param dateRange The time interval observations should fall between.
     */
    FhirService.prototype.diagnosticReportsPresentWithCodes = function (codeGroup, dateRange) {
        // Just ask for one result to reduce the call time.
        return this.getDiagnosticReports(codeGroup, dateRange, 1)
            .then(function (reports) { return reports.length > 0; }, function (rejection) {
            // If any DiagnosticReports for this code results in an error, do not
            // show any DiagnosticReports at all.
            throw rejection;
        });
    };
    /**
     * Gets observations from a specified date range with a specific code group.
     * @param codeGroup The LOINCCodeGroup code for which to get observations.
     * @param dateRange The time interval observations should fall between.
     * @returns The observations if there's a valid code group or date range.
     */
    FhirService.prototype.getObservationsForCodeGroup = function (codeGroup, dateRange) {
        if (!codeGroup || !dateRange) {
            return Object(rxjs__WEBPACK_IMPORTED_MODULE_1__["of"])([]).toPromise();
        }
        var observationPromises = new Array();
        for (var _i = 0, _a = codeGroup.resourceCodes; _i < _a.length; _i++) {
            var c = _a[_i];
            if (c instanceof _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_2__["LOINCCode"]) {
                observationPromises.push(this.getObservationsWithCode(c, dateRange));
            }
        }
        return Promise.all(observationPromises);
    };
    /**
     * Returns whether there are any observations with this code in the given
     * time range.
     * @param code The RxNorm code for which to get observations.
     * @param dateRange The time interval observations should fall between.
     */
    FhirService.prototype.medicationsPresentWithCode = function (code, dateRange) {
        // Just ask for one result to reduce the call time.
        return this.getMedicationAdministrationsWithCode(code, dateRange, 1)
            .then(function (obs) { return obs.length > 0; }, function (rejection) {
            // If any MedicationAdministration for this code results in an error,
            // do not show any MedicationAdministrations at all.
            throw rejection;
        });
    };
    /**
     * Gets medication data from a specified date range with specific Rx codes,
     * since multiple medications are displayed on a single chart.
     * @param codes The RxNormCode codes for which to get observations.
     * @param dateRanges The time interval observations should fall between.
     */
    FhirService.prototype.getMedicationAdministrationsWithCodes = function (codes, dateRange) {
        if (!codes || !dateRange) {
            return Object(rxjs__WEBPACK_IMPORTED_MODULE_1__["of"])([]).toPromise();
        }
        var medicationPromises = new Array();
        for (var _i = 0, _a = codes.resourceCodes; _i < _a.length; _i++) {
            var code = _a[_i];
            medicationPromises.push(this.getMedicationAdministrationsWithCode(code, dateRange));
        }
        // This will be rejected if any Promise is rejected.
        return Promise.all(medicationPromises);
    };
    FhirService = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Injectable"])()
    ], FhirService);
    return FhirService;
}());



/***/ }),

/***/ "./src/app/fhir_config.js":
/*!********************************!*\
  !*** ./src/app/fhir_config.js ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports) {



/***/ }),

/***/ "./src/app/graphdatatypes/customizabledata.ts":
/*!****************************************************!*\
  !*** ./src/app/graphdatatypes/customizabledata.ts ***!
  \****************************************************/
/*! exports provided: CustomizableData */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CustomizableData", function() { return CustomizableData; });
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! luxon */ "./node_modules/luxon/build/cjs-browser/luxon.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(luxon__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _graphtypes_customizable_graph_customizable_graph_annotation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../graphtypes/customizable-graph/customizable-graph-annotation */ "./src/app/graphtypes/customizable-graph/customizable-graph-annotation.ts");
/* harmony import */ var _graphdata__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./graphdata */ "./src/app/graphdatatypes/graphdata.ts");
/* harmony import */ var _labeled_series__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./labeled-series */ "./src/app/graphdatatypes/labeled-series.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();




/**
 * CustomizableData holds a time-based series to which a user can add more
 * points.
 */
var CustomizableData = /** @class */ (function (_super) {
    __extends(CustomizableData, _super);
    function CustomizableData(series, 
    /**
     * The annotations for this customizable graph. If populated, holds a
     * map from a number representation of a Date to
     * CustomizableGraphAnnotation for the corresponding point.
     */
    annotations, regions) {
        var _this = _super.call(this, [series], new Map(), undefined, undefined, regions) || this;
        _this.annotations = annotations;
        _this.annotations = annotations;
        _this.yAxisDisplayBounds = [0, 10];
        return _this;
    }
    CustomizableData.defaultEmptySeries = function () {
        // We need to initialize the data with a point so that the c3 chart can show
        // the x-axis with the dates (otherwise, it turns up blank). This date is
        // the earliest possible date: Tuesday, April 20th, 271,821 BCE.
        return CustomizableData.fromInitialPoint(0, new _graphtypes_customizable_graph_customizable_graph_annotation__WEBPACK_IMPORTED_MODULE_1__["CustomizableGraphAnnotation"](luxon__WEBPACK_IMPORTED_MODULE_0__["DateTime"].fromJSDate(new Date(-8640000000000000)), 'initial_point_hidden'));
    };
    /**
     * Converts an initial time and y value to a CustomizableData object.
     * @param date The date for this initial point.
     * @param yValue The y-value for this initial point.
     * @param annotation The CustomizableGraphAnnotation for this point.
     * @returns a new CustomizableData representing this initial point.
     */
    // TODO(b/123940928): Consider passing in encounters rather than FhirService.
    CustomizableData.fromInitialPoint = function (yValue, annotation) {
        var annotations = new Map().set(annotation.timestamp.toMillis(), annotation);
        return new CustomizableData(_labeled_series__WEBPACK_IMPORTED_MODULE_3__["LabeledSeries"].fromInitialPoint(annotation.timestamp, yValue), annotations);
    };
    /**
     * Adds a point to the series in this CustomizableData object.
     * @param date The date for this point.
     * @param yValue The y-value for this point.
     * @param annotation The CustomizableGraphAnnotation for this point.
     * @returns a new CustomizableData with the addition of this point.
     */
    CustomizableData.prototype.addPointToSeries = function (yValue, annotation) {
        // This method assumes there is only 1 series.
        this.series[0].xValues.push(annotation.timestamp);
        this.series[0].yValues.push(yValue);
        this.annotations.set(annotation.timestamp.toMillis(), annotation);
        this.c3DisplayConfiguration = this.generateColumnMapping(new Map());
    };
    /**
     * Removes a point from the series in this CustomizableData object, as well as
     * the corresponding annotation.
     * @param date The date for this point to remove.
     */
    CustomizableData.prototype.removePointFromSeries = function (date) {
        var index = this.series[0].xValues.findIndex(function (x) { return x.toMillis() === date.toMillis(); });
        this.series[0].xValues.splice(index, 1);
        this.series[0].yValues.splice(index, 1);
        this.annotations.delete(date.toMillis());
        this.c3DisplayConfiguration = this.generateColumnMapping(new Map());
    };
    return CustomizableData;
}(_graphdata__WEBPACK_IMPORTED_MODULE_2__["GraphData"]));



/***/ }),

/***/ "./src/app/graphdatatypes/graphdata.ts":
/*!*********************************************!*\
  !*** ./src/app/graphdatatypes/graphdata.ts ***!
  \*********************************************/
/*! exports provided: DisplayConfiguration, GraphData */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DisplayConfiguration", function() { return DisplayConfiguration; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GraphData", function() { return GraphData; });
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! luxon */ "./node_modules/luxon/build/cjs-browser/luxon.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(luxon__WEBPACK_IMPORTED_MODULE_0__);
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

var DisplayConfiguration = /** @class */ (function () {
    function DisplayConfiguration(
    /**
     * These columns feed in to c3 as data. Each item in allColumns is
     * an array of data. The first entry is the series label and the following
     * entries are the data for that series.
     */
    allColumns, 
    /**
     * The keys of this map are the name of the y-series as stored in
     * allColumns, and the values are their corresponding x-series names.
     */
    columnMap, 
    /**
     * Maps y-series names (keys) to DisplayGroupings.
     */
    ySeriesLabelToDisplayGroup) {
        this.allColumns = allColumns;
        this.columnMap = columnMap;
        this.ySeriesLabelToDisplayGroup = ySeriesLabelToDisplayGroup;
    }
    return DisplayConfiguration;
}());

/*
 * The base class for holding data pertaining to one graph.
 */
var GraphData = /** @class */ (function () {
    function GraphData(
    /** A list of the series to be displayed on the graph. */
    series, 
    /**
     * The DisplayGroups (for example, lab results, vital signs, medications)
     * associated with particular series. We use this to make a custom legend
     * for the graph.
     */
    seriesToDisplayGroup, 
    /**
     * A map to provide tooltips.
     * This is a bit complicated. c3's API lets you specify a function call
     * that will provide the HTML content for any given point's tooltip.
     * As a parameter, it passes in one or more data points:
     * https://c3js.org/reference.html#tooltip-contents
     * so when the tooltip is rendered, all you have is the plotted
     * information. As far as I can tell, that data structure is undocumented.
     * Upon inspection, the data point includes which series it belongs to,
     * the x value, and the y value, so if you want to render a custom
     * tooltip, you have to be able to derive all the information you need
     * from those values.
     * tooltipMap, alongside tooltipKeyFn, helps with this process.
     * If you call tooltipKeyFn on the data object passed into the c3 contents
     * function, it should yield the key into tooltipMap that will let you
     * look up the appropriate tooltip for that data point. If tooltipKeyFn
     * is unset, then we fall back to the default lookup, which is by x-value.
     */
    tooltipMap, 
    /**
     * See documentation on tooltipMap for more detail. tooltipKeyFn
     * takes in a graph data point and returns the key into tooltipMap that
     * provides the tooltip for that data point.
     */
    tooltipKeyFn, 
    /**
     * A list of x-axis regions to display on the graph.
     */
    regions) {
        this.series = series;
        this.tooltipMap = tooltipMap;
        this.tooltipKeyFn = tooltipKeyFn;
        // The number of decimal places to show for any value associated with this
        // GraphData. The default is 0, to minimize errors caused by unnecessary
        // trailing zeros.
        this.precision = 0;
        this.c3DisplayConfiguration =
            this.generateColumnMapping(seriesToDisplayGroup);
        this.xRegions = regions;
    }
    /*
     * Sets up the column map and list of columns to use while generating the c3
     * chart.
     * @param data The GraphData to use while making the columns and column map.
     */
    GraphData.prototype.generateColumnMapping = function (seriesToDisplayGroup) {
        // Give labels to each series and make a map of x-values to y-values.
        var allColumns = [];
        var columnMap = {};
        var ySeriesLabelToDisplayGroup = new Map();
        for (var _i = 0, _a = this.series; _i < _a.length; _i++) {
            var s = _a[_i];
            allColumns.push(new Array('x_' + s.label).concat(s.xValues));
            allColumns.push(new Array(s.label).concat(s.yValues));
            columnMap[s.label] = 'x_' + s.label;
            ySeriesLabelToDisplayGroup.set(s.label, seriesToDisplayGroup.get(s));
        }
        // If there is no data, we add a "dummy" data point to still display the
        // x-axis.
        if (allColumns.length < 1) {
            // Add a data point to still show the x-axis.
            // This date is the earliest possible date: Tuesday, April 20th, 271,821
            // BCE.
            allColumns.push(['x_empty', luxon__WEBPACK_IMPORTED_MODULE_0__["DateTime"].fromJSDate(new Date(-8640000000000000))], ['empty', 0]);
            columnMap['empty'] = 'x_empty';
        }
        return new DisplayConfiguration(allColumns, columnMap, ySeriesLabelToDisplayGroup);
    };
    return GraphData;
}());



/***/ }),

/***/ "./src/app/graphdatatypes/labeled-series.ts":
/*!**************************************************!*\
  !*** ./src/app/graphdatatypes/labeled-series.ts ***!
  \**************************************************/
/*! exports provided: LabeledSeries */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LabeledSeries", function() { return LabeledSeries; });
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
/**
 * Timeseries data, represented as a list of <DateTime, number> tuples,
 * with metadata including a human-readable label, a unit, and a typical range.
 * Used for most charts to display a changing value over time. Multiple
 * LabeledSeries may appear on the same graph.
 */
var LabeledSeries = /** @class */ (function () {
    function LabeledSeries(lbl, coordinates, unit, yNormalBounds, concept) {
        this.label = lbl;
        this.xValues = [];
        this.yValues = [];
        this.unit = unit;
        /*
         * Separate out the coordinates into x and y values because that's what
         * the graphing library will expect.
         */
        for (var _i = 0, coordinates_1 = coordinates; _i < coordinates_1.length; _i++) {
            var _a = coordinates_1[_i], x = _a[0], y = _a[1];
            this.xValues.push(x);
            this.yValues.push(y);
        }
        this.yNormalBounds = yNormalBounds;
        this.concept = concept;
        /**
         * Calculate the y axis display bounds by finding the outer boundaries of
         * the data and the normal range.
         */
        this.yDisplayBounds = [
            Math.min.apply(Math, this.yValues), Math.max.apply(Math, this.yValues)
        ];
        if (this.yNormalBounds) {
            this.yDisplayBounds = [
                Math.min(this.yDisplayBounds[0], this.yNormalBounds[0]),
                Math.max(this.yDisplayBounds[1], this.yNormalBounds[1])
            ];
        }
    }
    /**
     * Generates a LabeledSeries from the given ObservationSet.
     * @param observationSet The ObservationSet to chart.
     * @param encounters A list of Encounters to use while determining line breaks
     *     in series.
     */
    LabeledSeries.fromObservationSet = function (observationSet, encounters) {
        var coordinates = [];
        var observations = observationSet.resourceList;
        for (var _i = 0, observations_1 = observations; _i < observations_1.length; _i++) {
            var obs = observations_1[_i];
            coordinates.push([obs.observation.timestamp, obs.observation.value.value]);
        }
        coordinates = this.addEncounterEndpoints(coordinates, encounters);
        return new LabeledSeries(observationSet.label, coordinates, observationSet.unit, observationSet.normalRange);
    };
    /**
     * Generates a LabeledSeries from the given list of discrete resulted-
     * ObservationSets.
     * For Observations with discrete values, such as "yellow"
     * for the color of urine, we group all ObservationSets into one
     * LabeledSeries, at a specific yValue.
     * @param observationSets The discrete ObservationSets to chart.
     * @param yValue The numerical y-value to map to this ObservationSet with
     *     discrete results.
     * @param label The label for this LabeledSeries.
     * @param encounters A list of Encounters to use while determining line breaks
     *     in series.
     */
    LabeledSeries.fromObservationSetsDiscrete = function (observationSets, yValue, label, encounters) {
        var coordinates = [];
        for (var _i = 0, observationSets_1 = observationSets; _i < observationSets_1.length; _i++) {
            var obsSet = observationSets_1[_i];
            var observations = obsSet.resourceList;
            for (var _a = 0, observations_2 = observations; _a < observations_2.length; _a++) {
                var obs = observations_2[_a];
                coordinates.push([obs.observation.timestamp, yValue]);
            }
        }
        coordinates = this.addEncounterEndpoints(coordinates, encounters);
        return new LabeledSeries(label, coordinates);
    };
    /**
     * Generates a set of LabeledSeries from the given MedicationOrderSet. It will
     * return one series for all the orders together since the order set
     * represents all orders for the same medication.
     * @param medOrderSet The MedicationOrderSet to chart.
     * @param dateRange The date range displayed on the chart.
     * @param encounters A list of Encounters to use while determining line breaks
     *     in series.
     * @param fixedYPosition If set, we use this y-position for all the
     *    datapoints in both returned series. If unset, we use the dosage
     *    quantity for each administration as the y-value.
     */
    LabeledSeries.fromMedicationOrderSet = function (medOrderSet, dateRange, encounters, fixedYPosition) {
        var data = [];
        for (var _i = 0, _a = medOrderSet.resourceList; _i < _a.length; _i++) {
            var medOrder = _a[_i];
            // The first series in fromMedicationOrder is all the administrations.
            // The second series (unused in this function) is the end points only.
            data.push(LabeledSeries.fromMedicationOrder(medOrder, dateRange, fixedYPosition)[0]);
        }
        // Combine all the series into a single series so that it shows up with
        // the same color.
        var coords = [];
        for (var _b = 0, data_1 = data; _b < data_1.length; _b++) {
            var series = data_1[_b];
            for (var i = 0; i < series.xValues.length; i++) {
                coords.push([series.xValues[i], series.yValues[i]]);
            }
        }
        coords = this.addEncounterEndpoints(coords, encounters);
        return new LabeledSeries(medOrderSet.label, coords, medOrderSet.unit, undefined, // yNormalBounds
        // TODO(b/122468555): Enforce that medOrderSets have to have a
        // RxNormCode upon construction
        medOrderSet.rxNormCode ? medOrderSet.rxNormCode.displayGrouping :
            undefined);
    };
    /**
     * Generates a set of LabeledSeries from the given MedicationOrder. For each
     * order, there are two LabeledSeries -- one for the corresponding
     * MedicationAdministrations, and one for the endpoints displayed for the
     * order.
     * @param order The MedicationOrder to chart.
     * @param dateRange The date range displayed on the chart.
     * @param fixedYPosition If set, we use this y-position for all the
     *    datapoints in both returned series. If unset, we use the dosage
     *    quantity for each administration as the y-value.
     */
    LabeledSeries.fromMedicationOrder = function (order, dateRange, fixedYPosition) {
        var coordinates = new Array();
        var endpointCoordinates = new Array();
        var medAdminsForOrder = order.administrationsForOrder;
        var label = order.label + order.orderId;
        if (medAdminsForOrder) {
            for (var _i = 0, _a = medAdminsForOrder.resourceList; _i < _a.length; _i++) {
                var annotatedAdmin = _a[_i];
                coordinates.push([
                    annotatedAdmin.medAdministration.timestamp,
                    this.getYPositionForMed(annotatedAdmin.medAdministration, fixedYPosition)
                ]);
            }
            // We add the beginning and end time stamp if the order is not fully
            // displayed-- so that no dashes are displayed when an order is being
            // carried over from before the time window displayed.
            // We only display an endpoint for a MedicationOrder if the
            // endpoint is visible -- that is, if the time of the first
            // Administration of the order is during or after the beginning of the
            // time range of the chart, and if the time of the last Administration
            // of the order is before the end of the chart's time range.
            var firstAdministrationIsAfterStartTime = order.firstAdministration.timestamp.toMillis() >=
                dateRange.start.toMillis();
            var lastAdministrationIsBeforeEndTime = order.lastAdmininistration.timestamp.toMillis() <=
                dateRange.end.toMillis();
            if (firstAdministrationIsAfterStartTime) {
                endpointCoordinates.push([
                    order.firstAdministration.timestamp,
                    this.getYPositionForMed(order.firstAdministration, fixedYPosition)
                ]);
            }
            else if (fixedYPosition &&
                (order.lastAdmininistration.timestamp.toMillis() >
                    dateRange.start.toMillis())) {
                // Only add a point for continuity if we have a fixed y position.
                coordinates.push([dateRange.start, fixedYPosition]);
            }
            if (lastAdministrationIsBeforeEndTime) {
                endpointCoordinates.push([
                    order.lastAdmininistration.timestamp,
                    this.getYPositionForMed(order.lastAdmininistration, fixedYPosition)
                ]);
            }
            else if (fixedYPosition &&
                order.firstAdministration.timestamp.toMillis() <
                    dateRange.end.toMillis()) {
                // Only add a point for continuity if we have a fixed y position.
                coordinates.push([dateRange.end, fixedYPosition]);
            }
        }
        return [
            new LabeledSeries(label, coordinates, medAdminsForOrder.unit, undefined, // yNormalBounds
            order.rxNormCode.displayGrouping),
            new LabeledSeries('endpoint' + label, endpointCoordinates, medAdminsForOrder.unit)
        ];
    };
    /**
     * Generates a LabeledSeries from the given initial date and y-value.
     * @param date The DateTime corresponding to the initial point to chart.
     * @param yValue The y-value for the initial point to chart.
     */
    LabeledSeries.fromInitialPoint = function (date, yValue) {
        return new LabeledSeries('', [[date, yValue]]);
    };
    /**
     * Generates LabeledSeries from the given DiagnosticReport.
     * @param report The DiagnosticReport to chart.
     * @param date the DateTime corresponding to the Observations in the
     *     DiagnosticReport.
     */
    LabeledSeries.fromDiagnosticReport = function (report, date, yAxisMap) {
        var series = [];
        var interpretationMap = new Map();
        var _loop_1 = function (observation) {
            var yValue = Array.from(yAxisMap.keys())
                .find(function (key) { return yAxisMap.get(key) === observation.display; });
            var interpretation = observation.interpretation.code;
            if (interpretationMap.get(interpretation)) {
                var existing = interpretationMap.get(interpretation);
                existing.push([date, yValue]);
                interpretationMap.set(interpretation, existing);
            }
            else {
                interpretationMap.set(interpretation, [[date, yValue]]);
            }
        };
        // Sort results by interpretation, and make a LabeledSeries for each.
        for (var _i = 0, _a = report.results; _i < _a.length; _i++) {
            var observation = _a[_i];
            _loop_1(observation);
        }
        // Make a LabeledSeries for each interpretation.
        for (var _b = 0, _c = Array.from(interpretationMap.keys()); _b < _c.length; _b++) {
            var interpretation = _c[_b];
            series.push(new LabeledSeries(
            // Encode the status and interpretation into the series name so that
            // we can use d3 later on to filter the data points and display them
            // with the correct styling.
            report.id + '-' + interpretation + '-' + report.status, interpretationMap.get(interpretation)));
        }
        return series;
    };
    LabeledSeries.getYPositionForMed = function (medAdmin, fixedYPosition) {
        return fixedYPosition !== undefined && fixedYPosition !== null ?
            fixedYPosition :
            medAdmin.dosage.quantity;
    };
    LabeledSeries.addEncounterEndpoints = function (coordinates, encounters) {
        if (coordinates.length > 0) {
            // If any encounters are set for this MedicationOrderSet, add null values
            // to the endpoints of encounters to ensure line breakage between points
            // of different encounters.
            // We assume that encounter endpoints correspond to correct line breaks,
            // and do not cross-check encounter id's of MedicationOrders or
            // MedicationAdministrations.
            for (var _i = 0, encounters_1 = encounters; _i < encounters_1.length; _i++) {
                var encounter = encounters_1[_i];
                coordinates.push([encounter.period.start.toUTC(), null]);
                coordinates.push([encounter.period.end.toUTC(), null]);
            }
        }
        return coordinates;
    };
    return LabeledSeries;
}());



/***/ }),

/***/ "./src/app/graphdatatypes/linegraphdata.ts":
/*!*************************************************!*\
  !*** ./src/app/graphdatatypes/linegraphdata.ts ***!
  \*************************************************/
/*! exports provided: LineGraphData */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LineGraphData", function() { return LineGraphData; });
/* harmony import */ var _clinicalconcepts_display_grouping__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../clinicalconcepts/display-grouping */ "./src/app/clinicalconcepts/display-grouping.ts");
/* harmony import */ var _graphtypes_tooltips_medication_tooltips__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../graphtypes/tooltips/medication-tooltips */ "./src/app/graphtypes/tooltips/medication-tooltips.ts");
/* harmony import */ var _graphtypes_tooltips_observation_tooltips__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../graphtypes/tooltips/observation-tooltips */ "./src/app/graphtypes/tooltips/observation-tooltips.ts");
/* harmony import */ var _theme_bch_colors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../theme/bch_colors */ "./src/app/theme/bch_colors.ts");
/* harmony import */ var _graphdata__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./graphdata */ "./src/app/graphdatatypes/graphdata.ts");
/* harmony import */ var _labeled_series__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./labeled-series */ "./src/app/graphdatatypes/labeled-series.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();






/**
 * LineGraphData holds configurations for a line graph. A line graph may display
 * one or more LabeledSeries.
 */
var LineGraphData = /** @class */ (function (_super) {
    __extends(LineGraphData, _super);
    function LineGraphData(
    /** The label for the graph. */
    label, 
    /** The LabeledSeries that are a part of this line graph. */
    series, 
    /** The display bounds of the y-axis. */
    yAxisDisplayBounds, 
    /** The unit for the y-axis of the graph. */
    unit, 
    /**
     * The LabeledSeries mapped to which DisplayGrouping they fall under for
     * the purposes of color and legends
     */
    seriesToDisplayGroup, tooltipMap, tooltipKeyFn, regions, precision) {
        var _this = _super.call(this, series, seriesToDisplayGroup, tooltipMap, tooltipKeyFn, regions) || this;
        _this.label = label;
        _this.yAxisDisplayBounds = yAxisDisplayBounds;
        _this.unit = unit;
        _this.precision = precision ? precision : 0;
        return _this;
    }
    /**
     * Converts a list of ObservationSets to a LineGraphData object.
     * @param label The label for this set of observations.
     * @param observationGroup A list of ObservationSets to display.
     * @param resourceCodeGroup The ResourceCodeGroup these ObservationSets belong
     *   to
     * @param sanitizer A DOM sanitizer for use in tooltip construction
     * @param encounters A list of Encounters to use while determining line breaks
     *     in series.
     * @returns a new LineGraphData for this observation set.
     * @throws Error if the observations in observationGroup have different units.
     */
    LineGraphData.fromObservationSetList = function (label, observationGroup, resourceCodeGroup, sanitizer, encounters) {
        var seriesToDisplayGrouping = new Map();
        var seriesIdx = 0;
        var dataColors = Object(_theme_bch_colors__WEBPACK_IMPORTED_MODULE_3__["getDataColors"])();
        var minY = Number.MAX_VALUE;
        var maxY = Number.MIN_VALUE;
        var series = [];
        var obsLabelToColor = new Map();
        for (var _i = 0, observationGroup_1 = observationGroup; _i < observationGroup_1.length; _i++) {
            var obsSet = observationGroup_1[_i];
            var lblSeries = _labeled_series__WEBPACK_IMPORTED_MODULE_5__["LabeledSeries"].fromObservationSet(obsSet, encounters);
            series.push(lblSeries);
            var color = dataColors[seriesIdx];
            seriesToDisplayGrouping.set(lblSeries, new _clinicalconcepts_display_grouping__WEBPACK_IMPORTED_MODULE_0__["DisplayGrouping"](lblSeries.label, color));
            obsLabelToColor.set(obsSet.label, color);
            seriesIdx = (seriesIdx + 1) % dataColors.length;
            /* Find the minimum and maximum y values for all the series. */
            minY = Math.min(minY, lblSeries.yDisplayBounds[0]);
            maxY = Math.max(maxY, lblSeries.yDisplayBounds[1]);
        }
        var tooltipMap = LineGraphData.makeTooltipMap(observationGroup, sanitizer, obsLabelToColor);
        var allUnits = new Set(observationGroup.map(function (x) { return x.unit; }).filter(function (x) { return x !== undefined; }));
        if (allUnits.size > 1) {
            throw Error('Observations have different units.');
        }
        var data = new LineGraphData(label, series, LineGraphData.getDisplayBounds(minY, maxY, resourceCodeGroup), allUnits.values().next().value, seriesToDisplayGrouping, tooltipMap.size > 0 ? tooltipMap : undefined, undefined, // tooltipMap
        undefined, // regions
        resourceCodeGroup.precision);
        return data;
    };
    LineGraphData.makeTooltipMap = function (obsGroup, sanitizer, obsLabelToColor) {
        var tooltipMap = new Map();
        // Only construct custom tooltips if there's annotation values for hte
        // observations.
        for (var _i = 0, obsGroup_1 = obsGroup; _i < obsGroup_1.length; _i++) {
            var obsSet = obsGroup_1[_i];
            for (var _a = 0, _b = obsSet.resourceList; _a < _b.length; _a++) {
                var obs = _b[_a];
                if (obs.annotationValues.length > 0) {
                    var timestamp = obs.observation.timestamp.toMillis().toString();
                    // The key for this tooltip is the administration's timestamp.
                    // There may be multiple data points associated with the timestamp
                    // so we stack the administrations on top of one another in that case.
                    if (tooltipMap.get(timestamp)) {
                        tooltipMap.set(timestamp, tooltipMap.get(timestamp) +
                            new _graphtypes_tooltips_observation_tooltips__WEBPACK_IMPORTED_MODULE_2__["GenericAnnotatedObservationTooltip"](false, obsLabelToColor.get(obs.label))
                                .getTooltip(obs, sanitizer));
                    }
                    else {
                        tooltipMap.set(timestamp, new _graphtypes_tooltips_observation_tooltips__WEBPACK_IMPORTED_MODULE_2__["GenericAnnotatedObservationTooltip"](true, obsLabelToColor.get(obs.label))
                            .getTooltip(obs, sanitizer));
                    }
                }
            }
        }
        return tooltipMap;
    };
    LineGraphData.getDisplayBounds = function (minInSeries, maxInSeries, resourceCodeGroup) {
        var yAxisDisplayMin;
        var yAxisDisplayMax;
        if (resourceCodeGroup.forceDisplayBounds &&
            resourceCodeGroup.displayBounds) {
            // We use the provided display bounds by default, regardless of the
            // bounds of the data.
            yAxisDisplayMin = resourceCodeGroup.displayBounds[0];
            yAxisDisplayMax = resourceCodeGroup.displayBounds[1];
        }
        else {
            // We use the provided display bounds as the y-axis display min and max,
            // unless the calculated minimum and maximum of the data span a smaller
            // range.
            // We choose the provided min bound if it is larger than the min of the
            // data, to cut off abnormal values.
            yAxisDisplayMin = resourceCodeGroup.displayBounds ?
                ((resourceCodeGroup.displayBounds[0] >= minInSeries) ?
                    resourceCodeGroup.displayBounds[0] :
                    minInSeries) :
                minInSeries;
            // We choose the provided max bound if it is smaller than the max of the
            // data, to cut off abnormal values.
            yAxisDisplayMax = resourceCodeGroup.displayBounds ?
                ((resourceCodeGroup.displayBounds[1] <= maxInSeries) ?
                    resourceCodeGroup.displayBounds[1] :
                    maxInSeries) :
                maxInSeries;
        }
        return [yAxisDisplayMin, yAxisDisplayMax];
    };
    /**
     * Converts a list of MedicationOrderSets to a LineGraphData object.
     * @param medicationOrderListGroup A list of MedicationOrderSets to display.
     * @param encounters A list of Encounters to use while determining line breaks
     *     in series.
     * @returns a new LineGraphData for this observation set.
     * @throws Error if the medication administrations in medicationOrderSet
     *     have different units.
     */
    LineGraphData.fromMedicationOrderSet = function (medicationOrderSet, dateRange, sanitizer, encounters) {
        var tooltipMap = new Map();
        var regions = [];
        for (var _i = 0, _a = medicationOrderSet.resourceList; _i < _a.length; _i++) {
            var order = _a[_i];
            regions.push({
                axis: 'x',
                class: 'order-region',
                start: order.firstAdministration.timestamp,
                end: order.lastAdmininistration.timestamp
            });
            for (var _b = 0, _c = order.administrationsForOrder.resourceList; _b < _c.length; _b++) {
                var admin = _c[_b];
                var timestamp = admin.medAdministration.timestamp.toMillis().toString();
                // The key for this tooltip is the administration's timestamp.
                // There may be multiple data points associated with the timestamp
                // so we stack the administrations on top of one another in that case.
                var tooltipText = new _graphtypes_tooltips_medication_tooltips__WEBPACK_IMPORTED_MODULE_1__["MedicationAdministrationTooltip"]().getTooltip([admin], sanitizer);
                if (tooltipMap.get(timestamp)) {
                    tooltipMap.set(timestamp, tooltipMap.get(timestamp) + tooltipText);
                }
                else {
                    tooltipMap.set(timestamp, tooltipText);
                }
            }
        }
        var singleSeries = _labeled_series__WEBPACK_IMPORTED_MODULE_5__["LabeledSeries"].fromMedicationOrderSet(medicationOrderSet, dateRange, encounters);
        var seriesToDisplayGrouping = new Map();
        seriesToDisplayGrouping.set(singleSeries, new _clinicalconcepts_display_grouping__WEBPACK_IMPORTED_MODULE_0__["DisplayGrouping"](singleSeries.label, Object(_theme_bch_colors__WEBPACK_IMPORTED_MODULE_3__["getDataColors"])()[0]));
        return new LineGraphData(medicationOrderSet.label, [singleSeries], [medicationOrderSet.minDose, medicationOrderSet.maxDose], medicationOrderSet.unit, seriesToDisplayGrouping, tooltipMap, undefined, regions);
    };
    /**
     * Converts a list of ObservationSets with discrete y-values (results) to a
     * LineGraphData object.
     * If we are graphing Observations with discrete values, such as "yellow"
     * for the color of urine, we group all ObservationSets into one
     * LabeledSeries, and display textual information in the tooltip.
     * @param label The label for this set of observations.
     * @param observationGroup A list of ObservationSets to display.
     * @param encounters A list of Encounters to use while determining line breaks
     *     in series.
     * @returns a new LineGraphData for this observation set.
     * @throws Error if the observations in observationGroup have different
     *     units.
     */
    LineGraphData.fromObservationSetListDiscrete = function (label, observationGroup, sanitizer, encounters) {
        // For ObservationSets with discrete categories, we display a scatterplot
        // with one series, with most information in the tooltip.
        var yValue = 10;
        var lblSeries = _labeled_series__WEBPACK_IMPORTED_MODULE_5__["LabeledSeries"].fromObservationSetsDiscrete(observationGroup, yValue, label, encounters);
        var seriesToDisplayGroup = new Map();
        seriesToDisplayGroup.set(lblSeries, new _clinicalconcepts_display_grouping__WEBPACK_IMPORTED_MODULE_0__["DisplayGrouping"](lblSeries.label, Object(_theme_bch_colors__WEBPACK_IMPORTED_MODULE_3__["getDataColors"])()[0]));
        var tooltipMap = new Map();
        for (var _i = 0, observationGroup_2 = observationGroup; _i < observationGroup_2.length; _i++) {
            var observationSet = observationGroup_2[_i];
            for (var _a = 0, _b = observationSet.resourceList; _a < _b.length; _a++) {
                var obs = _b[_a];
                var tsString = obs.observation.timestamp.toMillis().toString();
                var tooltipText = new _graphtypes_tooltips_observation_tooltips__WEBPACK_IMPORTED_MODULE_2__["DiscreteObservationTooltip"]().getTooltip([obs.observation], sanitizer);
                // The key for this tooltip is the observation's timestamp.
                // There may be multiple data points associated with the timestamp
                // so we stack the tooltips on top of one another in that case.
                if (tooltipMap.has(tsString)) {
                    tooltipMap.set(tsString, tooltipMap.get(tsString) + tooltipText);
                }
                else {
                    tooltipMap.set(tsString, tooltipText);
                }
            }
        }
        return new LineGraphData(label, [lblSeries], [0, yValue], undefined, // Units
        seriesToDisplayGroup, tooltipMap);
    };
    return LineGraphData;
}(_graphdata__WEBPACK_IMPORTED_MODULE_4__["GraphData"]));



/***/ }),

/***/ "./src/app/graphdatatypes/microbiographdata.ts":
/*!*****************************************************!*\
  !*** ./src/app/graphdatatypes/microbiographdata.ts ***!
  \*****************************************************/
/*! exports provided: MicrobioGraphData */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MicrobioGraphData", function() { return MicrobioGraphData; });
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! luxon */ "./node_modules/luxon/build/cjs-browser/luxon.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(luxon__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _clinicalconcepts_display_grouping__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../clinicalconcepts/display-grouping */ "./src/app/clinicalconcepts/display-grouping.ts");
/* harmony import */ var _fhir_data_classes_diagnostic_report__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../fhir-data-classes/diagnostic-report */ "./src/app/fhir-data-classes/diagnostic-report.ts");
/* harmony import */ var _fhir_data_classes_observation_interpretation_valueset__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../fhir-data-classes/observation-interpretation-valueset */ "./src/app/fhir-data-classes/observation-interpretation-valueset.ts");
/* harmony import */ var _graphtypes_tooltips_microbio_tooltips__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../graphtypes/tooltips/microbio-tooltips */ "./src/app/graphtypes/tooltips/microbio-tooltips.ts");
/* harmony import */ var _labeled_series__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./labeled-series */ "./src/app/graphdatatypes/labeled-series.ts");
/* harmony import */ var _stepgraphdata__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./stepgraphdata */ "./src/app/graphdatatypes/stepgraphdata.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();







/**
 * MicrobioGraphData holds configurations for a microbiology graph. The format
 * of a microbiology graph is simliar to a step graph in that each y-axis
 * position represents a single microbiology test, and points plotted along
 * that position represent results for that test.
 */
var MicrobioGraphData = /** @class */ (function (_super) {
    __extends(MicrobioGraphData, _super);
    function MicrobioGraphData(series, endpointSeries, yAxisMap, seriesToDisplayGroup, tooltipMap, keyFn, 
    /**
     * Maps the report ID to the report status. This is used for custom
     * styling of display points.
     */
    reportIdToStatus) {
        var _this = _super.call(this, series, endpointSeries, yAxisMap, seriesToDisplayGroup, tooltipMap, keyFn) || this;
        _this.reportIdToStatus = reportIdToStatus;
        return _this;
    }
    /**
     * Converts a list of DiagnosticReports to a StepGraphData object.
     * All DiagnosticReports in the list should belong to the same culture type.
     * @param diagnosticReports A list of DiagnosticReports to display.
     * @returns a new StepGraphData for this set.
     */
    MicrobioGraphData.fromDiagnosticReports = function (diagnosticReports, cultureType, sanitizer) {
        // TODO(b/121266814): Make constants or enum for cultureType.
        var points = [];
        // We keep the yAxisMap mapping y-axis positions to labels to be consistent
        // with other forms of StepGraphData.
        var currYPosition = _stepgraphdata__WEBPACK_IMPORTED_MODULE_6__["StepGraphData"].Y_AXIS_SPACING;
        var yAxisMap = new Map();
        var tooltipMap = new Map();
        var timestampToId = new Map();
        var seriesToDisplayGroup = new Map();
        // We create a master y-axis map mapping discrete labels (Observation
        // displays) to y-values. This must be uniform across all DiagnosticReports.
        for (var _i = 0, diagnosticReports_1 = diagnosticReports; _i < diagnosticReports_1.length; _i++) {
            var report = diagnosticReports_1[_i];
            for (var _a = 0, _b = report.results; _a < _b.length; _a++) {
                var observation = _b[_a];
                if (!Array.from(yAxisMap.values()).includes(observation.display)) {
                    yAxisMap.set(currYPosition, observation.display);
                    currYPosition += _stepgraphdata__WEBPACK_IMPORTED_MODULE_6__["StepGraphData"].Y_AXIS_SPACING;
                }
            }
        }
        var reportIdToStatus = new Map();
        var _loop_1 = function (report) {
            // Find the specimen in the report with the correct Culture type.
            // We throw an error if there are mutiple specimens of the same type for
            // a DiagnosticReport.
            var seen = new Set();
            var hasDuplicates = report.specimens.some(function (s) {
                return seen.size === seen.add(s.type).size;
            });
            if (hasDuplicates) {
                throw Error('Report has multiple specimens with same type.');
            }
            reportIdToStatus.set(report.id, report.status);
            var specimen = report.specimens.find(function (s) { return (s.type === cultureType); });
            if (specimen) {
                var annotatedReport = new _fhir_data_classes_diagnostic_report__WEBPACK_IMPORTED_MODULE_2__["AnnotatedDiagnosticReport"](report, cultureType);
                // For this tooltip, the keys are report IDs.
                tooltipMap.set(report.id, new _graphtypes_tooltips_microbio_tooltips__WEBPACK_IMPORTED_MODULE_4__["MicrobioTooltip"]().getTooltip(annotatedReport, sanitizer));
                var ts = annotatedReport.timestamp.toMillis().toString();
                timestampToId.set(ts, report.id);
                for (var _i = 0, _a = _labeled_series__WEBPACK_IMPORTED_MODULE_5__["LabeledSeries"].fromDiagnosticReport(report, annotatedReport.timestamp, yAxisMap); _i < _a.length; _i++) {
                    var series = _a[_i];
                    seriesToDisplayGroup.set(series, MicrobioGraphData.getDisplayGroupFromResult(report.status, series.label.includes(_fhir_data_classes_observation_interpretation_valueset__WEBPACK_IMPORTED_MODULE_3__["CHECK_RESULT_CODE"])));
                    points.push(series);
                }
            }
        };
        for (var _c = 0, diagnosticReports_2 = diagnosticReports; _c < diagnosticReports_2.length; _c++) {
            var report = diagnosticReports_2[_c];
            _loop_1(report);
        }
        return new MicrobioGraphData([], // No series representing "lines" on this chart
        points, yAxisMap, seriesToDisplayGroup, tooltipMap, 
        // Because the keys here are report IDs we have to pass in a custom
        // function to translate the graph's x-values to the appropriate
        // tooltip.
        function (reportPoint) {
            return timestampToId.get(luxon__WEBPACK_IMPORTED_MODULE_0__["DateTime"].fromJSDate(reportPoint.x).toMillis().toString());
        }, reportIdToStatus);
    };
    /**
     * Returns the correct display grouping for a diagnostic report.
     * @param status The DiagnosticReport's status.
     * @param isPositive Whether the report appears to be positive.
     * @returns The correct display grouping for the report.
     */
    MicrobioGraphData.getDisplayGroupFromResult = function (status, isPositive) {
        if (isPositive) {
            if (status === _fhir_data_classes_diagnostic_report__WEBPACK_IMPORTED_MODULE_2__["DiagnosticReportStatus"].Preliminary) {
                return _clinicalconcepts_display_grouping__WEBPACK_IMPORTED_MODULE_1__["posPrelimMB"];
            }
            else if (status === _fhir_data_classes_diagnostic_report__WEBPACK_IMPORTED_MODULE_2__["DiagnosticReportStatus"].Final) {
                return _clinicalconcepts_display_grouping__WEBPACK_IMPORTED_MODULE_1__["posFinalMB"];
            }
        }
        else if (status === _fhir_data_classes_diagnostic_report__WEBPACK_IMPORTED_MODULE_2__["DiagnosticReportStatus"].Preliminary) {
            return _clinicalconcepts_display_grouping__WEBPACK_IMPORTED_MODULE_1__["negPrelimMB"];
        }
        else if (status === _fhir_data_classes_diagnostic_report__WEBPACK_IMPORTED_MODULE_2__["DiagnosticReportStatus"].Final) {
            return _clinicalconcepts_display_grouping__WEBPACK_IMPORTED_MODULE_1__["negFinalMB"];
        }
    };
    return MicrobioGraphData;
}(_stepgraphdata__WEBPACK_IMPORTED_MODULE_6__["StepGraphData"]));



/***/ }),

/***/ "./src/app/graphdatatypes/stepgraphdata.ts":
/*!*************************************************!*\
  !*** ./src/app/graphdatatypes/stepgraphdata.ts ***!
  \*************************************************/
/*! exports provided: StepGraphData */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "StepGraphData", function() { return StepGraphData; });
/* harmony import */ var _graphtypes_tooltips_medication_tooltips__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../graphtypes/tooltips/medication-tooltips */ "./src/app/graphtypes/tooltips/medication-tooltips.ts");
/* harmony import */ var _graphdata__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./graphdata */ "./src/app/graphdatatypes/graphdata.ts");
/* harmony import */ var _labeled_series__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./labeled-series */ "./src/app/graphdatatypes/labeled-series.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();



/**
 * StepGraphData holds configurations for a step graph. A step graph displays
 * one or more LabeledSeries.
 */
var StepGraphData = /** @class */ (function (_super) {
    __extends(StepGraphData, _super);
    function StepGraphData(
    /** A list of the LabeledSeries data to plot. */
    dataSeries, 
    /** A list of the LabeledSeries representing end points. */
    endpointSeries, 
    /**
     * The map of y values to discrete labels to display on the y axis of the
     * stepgraph.
     */
    yAxisMap, seriesToDisplayGroup, tooltipMap, keyFn) {
        var _this = _super.call(this, dataSeries.concat(endpointSeries), seriesToDisplayGroup, tooltipMap, keyFn) || this;
        _this.dataSeries = dataSeries;
        _this.endpointSeries = endpointSeries;
        _this.yAxisMap = yAxisMap;
        return _this;
    }
    /**
     * Converts a list of MedicationOrderSets to a StepGraphData object.
     * @param medicationOrderListGroup A list of MedicationOrderSets to display.
     * @returns a new StepGraphData for this observation set.
     * @throws Error if the observations in observationGroup have different units.
     */
    StepGraphData.fromMedicationOrderSetList = function (medicationOrderListGroup, dateRange, sanitizer) {
        var data = [];
        var endpoints = [];
        // Give labels to each series and make a map of x-values to y-values.
        var yAxisMap = new Map();
        var currYPosition = StepGraphData.Y_AXIS_SPACING;
        var seriesToDisplayGroup = new Map();
        medicationOrderListGroup = medicationOrderListGroup.sort(function (a, b) {
            return a.resourceList[a.resourceList.length - 1]
                .lastAdmininistration.timestamp.toMillis() -
                b.resourceList[b.resourceList.length - 1]
                    .lastAdmininistration.timestamp.toMillis();
        });
        var tooltipMap = new Map();
        for (var _i = 0, medicationOrderListGroup_1 = medicationOrderListGroup; _i < medicationOrderListGroup_1.length; _i++) {
            var medOrderSet = medicationOrderListGroup_1[_i];
            // Each MedicationOrderSet represents multiple MedicationOrders
            // for the same medicine.
            for (var _a = 0, _b = medOrderSet.resourceList; _a < _b.length; _a++) {
                var medOrder = _b[_a];
                var labeledSeries = _labeled_series__WEBPACK_IMPORTED_MODULE_2__["LabeledSeries"].fromMedicationOrder(medOrder, dateRange, currYPosition);
                var administrationSeries = labeledSeries[0];
                var endpointSeries = labeledSeries[1];
                data.push(administrationSeries);
                endpoints.push(endpointSeries);
                yAxisMap.set(currYPosition, medOrder.administrationsForOrder.label);
                // Set up maps of the series to the concepts for the custom legend.
                seriesToDisplayGroup.set(endpointSeries, medOrder.rxNormCode.displayGrouping);
                seriesToDisplayGroup.set(administrationSeries, medOrder.rxNormCode.displayGrouping);
                // For this custom tooltip, the key is the series ID, and the value is
                // the medication tooltip that shows the first and last doses for the
                // medication.
                tooltipMap.set(administrationSeries.label, new _graphtypes_tooltips_medication_tooltips__WEBPACK_IMPORTED_MODULE_0__["MedicationTooltip"]().getTooltip(medOrder, sanitizer));
            }
            currYPosition += StepGraphData.Y_AXIS_SPACING;
        }
        // Do not display the units for Medication administration values on the card
        // for MedicationSummary.
        for (var _c = 0, data_1 = data; _c < data_1.length; _c++) {
            var series = data_1[_c];
            series.unit = undefined;
        }
        for (var _d = 0, endpoints_1 = endpoints; _d < endpoints_1.length; _d++) {
            var series = endpoints_1[_d];
            series.unit = undefined;
        }
        return new StepGraphData(data, endpoints, yAxisMap, seriesToDisplayGroup, tooltipMap, 
        // Our tooltip key here is the series ID, so we pass in a
        // custom key function.
        function (seriesObj) {
            return seriesObj.id;
        });
    };
    // The spacing between discrete values on the y-axis.
    StepGraphData.Y_AXIS_SPACING = 10;
    return StepGraphData;
}(_graphdata__WEBPACK_IMPORTED_MODULE_1__["GraphData"]));



/***/ }),

/***/ "./src/app/graphtypes/axis.ts":
/*!************************************!*\
  !*** ./src/app/graphtypes/axis.ts ***!
  \************************************/
/*! exports provided: Axis */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Axis", function() { return Axis; });
/* harmony import */ var _clinicalconcepts_bch_microbio_code__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../clinicalconcepts/bch-microbio-code */ "./src/app/clinicalconcepts/bch-microbio-code.ts");
/* harmony import */ var _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../clinicalconcepts/loinc-code */ "./src/app/clinicalconcepts/loinc-code.ts");
/* harmony import */ var _clinicalconcepts_rx_norm__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../clinicalconcepts/rx-norm */ "./src/app/clinicalconcepts/rx-norm.ts");
/* harmony import */ var _fhir_data_classes_medication_order__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../fhir-data-classes/medication-order */ "./src/app/fhir-data-classes/medication-order.ts");
/* harmony import */ var _graphdatatypes_linegraphdata__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../graphdatatypes/linegraphdata */ "./src/app/graphdatatypes/linegraphdata.ts");
/* harmony import */ var _graphdatatypes_microbiographdata__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../graphdatatypes/microbiographdata */ "./src/app/graphdatatypes/microbiographdata.ts");
/* harmony import */ var _graphdatatypes_stepgraphdata__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../graphdatatypes/stepgraphdata */ "./src/app/graphdatatypes/stepgraphdata.ts");
/* harmony import */ var _graph_graph_component__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./graph/graph.component */ "./src/app/graphtypes/graph/graph.component.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.








/**
 * An axis represents one graph to be rendered. It
 * holds values for the type of graph (step, scatter, line, etc) as well as the
 * actual graph data.
 *
 * One axis might have multiple ResourceCodes associated with it, but all of
 * the same type.
 *
 * This class makes the FHIR calls to grab the associated data for the chart.
 */
var Axis = /** @class */ (function () {
    /**
     * The constructor for this axis.
     * @param fhirService The FhirService used to make the FHIR calls.
     * @param resourceGroup The ResourceGroup to request data for.
     * @param dateRange: The date range to display on the axis.
     * @param label?: The optional y-axis label for this axis.
     */
    function Axis(fhirService, resourceGroup, dateRange, sanitizer, label) {
        var _this = this;
        this.fhirService = fhirService;
        this.sanitizer = sanitizer;
        /*
         * Whether or not the data fetch promise has resolved.
         */
        this.isResolved = false;
        /*
         * Whether to show tick marks for this axis (only changed when results are all
         * qualitative).
         */
        this.showTicks = true;
        // The encounters for the date range.
        this.encounters = [];
        this.dateRange = dateRange;
        this.chartType = resourceGroup.chartType;
        this.displayConcept = resourceGroup.displayGrouping;
        this.resourceGroup = resourceGroup;
        this.label = label;
        this.getDataFromFhir().then(function (res) {
            _this.data = res;
            _this.isResolved = true;
        }, 
        // TODO(b/126186009): Add testing for this code.
        function (rejection) {
            _this.isResolved = true;
            // TODO(b/126227729): Revise this language.
            _this.errorMessage = rejection;
            // 'Invalid data received. Please check the medical record.';
        });
    }
    /**
     * Gets the appropriate GraphData by classifying the resource codes and
     * making the appropriate FHIR calls for data and transformations. If
     * the data is already set in this class, it just returns that data.
     *
     * @returns A GraphData promise that will resolve to the GraphData for
     *    this axis's resourceGroup.
     */
    Axis.prototype.getDataFromFhir = function () {
        var _this = this;
        if (this.data) {
            return Promise.resolve(this.data);
        }
        // Set the encounters for this date range. If the promise fails, the list of
        // encounters is empty.
        this.fhirService.getEncountersForPatient(this.dateRange).then(function (e) {
            e = e.sort(function (a, b) { return a.period.start.toMillis() - b.period.start.toMillis(); });
            _this.encounters = e;
        }, function (reject) { return _this.encounters = []; });
        var resourceCodeList = this.resourceGroup.resourceCodes;
        // Check that all elements of the resourceCodeList are of the same type.
        var allLoinc = resourceCodeList.every(function (code) { return code instanceof _clinicalconcepts_loinc_code__WEBPACK_IMPORTED_MODULE_1__["LOINCCode"]; });
        var allRx = resourceCodeList.every(function (code) { return code instanceof _clinicalconcepts_rx_norm__WEBPACK_IMPORTED_MODULE_2__["RxNormCode"]; });
        var allBCHMicrobio = resourceCodeList.every(function (code) { return code instanceof _clinicalconcepts_bch_microbio_code__WEBPACK_IMPORTED_MODULE_0__["BCHMicrobioCode"]; });
        if (!allLoinc && !allRx && !allBCHMicrobio) {
            throw Error('All resource codes must be of the same type.');
        }
        if (allRx) {
            // Prescriptions can be plotted as a step chart or as a line chart.
            if (this.chartType === _graph_graph_component__WEBPACK_IMPORTED_MODULE_7__["ChartType"].STEP) {
                return this.getStepGraphDataForMedicationSummary(this.resourceGroup);
            }
            else {
                return this.getLineGraphDataForMedicationDetail(this.resourceGroup);
            }
        }
        if (allBCHMicrobio) {
            // Microbiology always shows up as a step chart.
            return this.getStepGraphDataForMB(this.resourceGroup);
        }
        else {
            // In this case it is all LOINC codes.
            // We use LineGraphData for both ChartType.Scatter and
            // ChartType.Line, for plotting LOINC Codes.
            return this.resourceGroup
                .getResourceSet(this.dateRange)
                .then(function (obsSetList) {
                if (obsSetList) {
                    // We only draw the Line charts if all ObservationSets are of
                    // the same type of y-value: continuous or discrete.
                    if (obsSetList.every(function (obsSet) { return obsSet.allQualitative; })) {
                        _this.showTicks = false;
                        return _graphdatatypes_linegraphdata__WEBPACK_IMPORTED_MODULE_4__["LineGraphData"].fromObservationSetListDiscrete(_this.displayConcept.label, obsSetList, _this.sanitizer, _this.encounters);
                    }
                    if (obsSetList.every(function (obsSet) { return !obsSet.allQualitative; })) {
                        return _graphdatatypes_linegraphdata__WEBPACK_IMPORTED_MODULE_4__["LineGraphData"].fromObservationSetList(_this.displayConcept.label, obsSetList, _this.resourceGroup, _this.sanitizer, _this.encounters);
                    }
                    throw Error('ObservationSets must all be continuous ' +
                        'or discrete-valued.');
                }
            }, function (rejection) {
                // Something wrong happened when constructing a LabeledClass
                // object for a code in this resourceGroup.
                throw rejection;
            });
        }
    };
    /**
     * Get the data needed for the medication summary.
     * We first get the MedicationAdministrations corresponding to the RxNorms to
     * display on the page, and group them by order id (representing a
     * prescription). We then get the MedicationOrder for each order id, and group
     * those into MedicationOrderSets, where each MedicationOrderSet represents a
     * set of MedicationOrders for a particular medication.
     * @param rxNorms The RxNorms to be displayed in the StepGraphCard.
     */
    Axis.prototype.getStepGraphDataForMedicationSummary = function (rxNorms) {
        var _this = this;
        return rxNorms.getResourceFromFhir(this.dateRange).then(function (medOrderSets) {
            return _graphdatatypes_stepgraphdata__WEBPACK_IMPORTED_MODULE_6__["StepGraphData"].fromMedicationOrderSetList(medOrderSets.map(function (x) { return x.orders; }), _this.dateRange, _this.sanitizer);
        });
    };
    Axis.prototype.getStepGraphDataForMB = function (bchCodes) {
        var _this = this;
        return bchCodes.getResourceFromFhir(this.dateRange).then(function (diagReports) {
            return _graphdatatypes_microbiographdata__WEBPACK_IMPORTED_MODULE_5__["MicrobioGraphData"].fromDiagnosticReports(diagReports, bchCodes.label, _this.sanitizer);
        });
    };
    /**
     * Issues a FHIR request to get all the meds data for a list of
     * RxNorm codes (medications).
     */
    Axis.prototype.getLineGraphDataForMedicationDetail = function (rxNorms) {
        var _this = this;
        return rxNorms.getResourceFromFhir(this.dateRange)
            .then(function (rxNs) {
            var medOrders = [].concat.apply([], rxNs.map(function (rx) { return rx.orders.resourceList; }));
            return medOrders.map(function (order) { return order.setMedicationAdministrations(_this.fhirService); });
        })
            .then(function (orders) {
            return Promise.all(orders);
        })
            .then(function (orders) {
            return _graphdatatypes_linegraphdata__WEBPACK_IMPORTED_MODULE_4__["LineGraphData"].fromMedicationOrderSet(new _fhir_data_classes_medication_order__WEBPACK_IMPORTED_MODULE_3__["MedicationOrderSet"](orders), _this.dateRange, _this.sanitizer, _this.encounters);
        });
    };
    return Axis;
}());



/***/ }),

/***/ "./src/app/graphtypes/customizable-graph/customizable-graph-annotation.ts":
/*!********************************************************************************!*\
  !*** ./src/app/graphtypes/customizable-graph/customizable-graph-annotation.ts ***!
  \********************************************************************************/
/*! exports provided: CustomizableGraphAnnotation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CustomizableGraphAnnotation", function() { return CustomizableGraphAnnotation; });
/* harmony import */ var color__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! color */ "./node_modules/color/index.js");
/* harmony import */ var color__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(color__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var d3__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! d3 */ "./node_modules/d3/index.js");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.


/*
 * This class makes an annotation for a particular timestamp with custom notes.
 */
var CustomizableGraphAnnotation = /** @class */ (function () {
    function CustomizableGraphAnnotation(timestamp, 
    /** The title that will show up in the annotation. */
    title, 
    /** The description that will show up in the annotation. */
    description, 
    /** The color for this annotation and associated point. */
    color) {
        if (title === void 0) { title = ''; }
        if (description === void 0) { description = ''; }
        if (color === void 0) { color = color__WEBPACK_IMPORTED_MODULE_0__["rgb"]('black'); }
        this.title = title;
        this.description = description;
        this.color = color;
        // The default y-coordinate for the annotation.
        this.defaultYCoordinate = 45;
        // The maximum horizontal overlap for any two annotations.
        this.horizontalOverlap = 20;
        // The maximum vertical overlap for any two annotations.
        this.verticalOverlap = 10;
        // The width of the annotation.
        this.annotationWidth = 100;
        // The default height of the annotation.
        this.annotationHeight = 25;
        // The default padding for the annotation.
        this.defaultPadding = 30;
        this.yAxisXCoord = 90;
        this.timestamp = timestamp;
    }
    CustomizableGraphAnnotation.prototype.addAnnotation = function (chart) {
        var self = this;
        this.showDetails = false;
        var millis = this.timestamp.toMillis();
        var xCoordinate = chart.internal.x(millis) + '';
        // Find the points for where to draw the new annotation & connector,
        // which are on different scales.
        var yCoordinate = this.findBestYCoordinates(xCoordinate);
        var tooltip = chart.internal.selectChart.style('position', 'relative')
            .append('div')
            .attr('class', 'tooltip-whole-' + millis);
        var tooltipContainer = tooltip.append('div').attr('class', 'tooltip-custom-' + millis);
        var tooltipTitleContainer = tooltipContainer.append('div');
        var expandIcon = tooltipTitleContainer.append('i')
            .attr('class', 'material-icons')
            .attr('id', 'expand-' + millis)
            .style('font-size', '18px')
            .html('expand_more');
        var tooltipTitle = tooltipTitleContainer.append('h6')
            .attr('class', 'tooltip-title-custom-' + millis)
            .text(this.title);
        var deleteIcon = tooltipTitleContainer.append('i')
            .attr('class', 'material-icons')
            .attr('id', 'delete-' + millis)
            .style('font-size', '18px')
            .html('clear');
        var tooltipDetails = tooltipContainer.append('div').attr('class', 'tooltip-details-custom-' + millis);
        var tooltipDetailsText = tooltipDetails.append('div')
            .text(this.description)
            .attr('class', 'tooltip-details-text-' + millis);
        var editIcon = tooltipDetails.append('i')
            .attr('class', 'material-icons')
            .attr('id', 'edit-' + millis)
            .style('font-size', '18px')
            .html('edit');
        tooltip.style('left', (Number(xCoordinate) + this.yAxisXCoord) + 'px')
            .style('top', yCoordinate + 'px')
            .style('border-left-color', this.color)
            .style('padding-bottom', (this.defaultPadding + (this.defaultYCoordinate - yCoordinate)) +
            'px');
        tooltipContainer.style('left', '0px')
            .style('bottom', (this.defaultPadding + (this.defaultYCoordinate - yCoordinate)) +
            'px')
            .style('background-color', this.color);
        /**
         * Add action handlers.
         */
        tooltipTitle.on('click', function () {
            // Toggle whether or not the details are shown.
            self.showDetails = !self.showDetails;
            self.showDetailsToggle(millis, self.showDetails, tooltipContainer.node());
        });
        expandIcon.style('cursor', 'pointer');
        expandIcon.on('click', function () {
            // Toggle whether or not the details are shown.
            self.showDetails = !self.showDetails;
            self.showDetailsToggle(millis, self.showDetails, tooltipContainer.node());
        });
        tooltip
            .on('mouseover', function () {
            // Only show icons when hovering over the tooltip, and while
            // the custom timeline is in edit mode. Show the expander icon
            // regardless of edit mode.
            expandIcon.style('visibility', 'visible');
            deleteIcon.classed('showIcon', true);
            editIcon.classed('showIcon', true);
        })
            .on('click', function () {
            // Ensure that the annotation comes to the front when clicking
            // on it.
            // TODO(b/122365189): Bring annotation to front while hovering
            // without disturbing scroll.
            var parent = this.parentNode;
            // TODO(b/123935165): Find a better way to handle the errors.
            try {
                parent.appendChild(this);
            }
            catch (e) {
                console.log(e);
            }
        })
            .on('mouseout', function () {
            deleteIcon.classed('showIcon', false);
            editIcon.classed('showIcon', false);
            expandIcon.style('visibility', 'hidden');
        });
    };
    // Toggles whether or not the full annotation is shown.
    CustomizableGraphAnnotation.prototype.showDetailsToggle = function (millis, toggle, element) {
        var detailsElement = d3__WEBPACK_IMPORTED_MODULE_1__["select"](element).select('.tooltip-details-custom-' + millis);
        var expandElement = d3__WEBPACK_IMPORTED_MODULE_1__["select"](element).select('#expand-' + millis);
        if (toggle) {
            detailsElement.style('display', 'inline-block').raise();
            expandElement.html('expand_less');
        }
        else {
            detailsElement.style('display', 'none');
            expandElement.html('expand_more');
        }
    };
    CustomizableGraphAnnotation.prototype.findBestYCoordinates = function (xCoordinate) {
        var newXCoord = Number(xCoordinate.replace('px', ''));
        var nodes = d3__WEBPACK_IMPORTED_MODULE_1__["selectAll"]('[class*="tooltip-whole"]').nodes();
        var positions = nodes.map(function (element) {
            return {
                top: Number(element.style.top.replace('px', '')),
                left: Number(element.style.left.replace('px', '')),
            };
        });
        var overlappingYs = [];
        // Check if there are any annotations with horizontal overlap.
        for (var _i = 0, positions_1 = positions; _i < positions_1.length; _i++) {
            var position = positions_1[_i];
            var rightPosition = position.left + this.annotationWidth;
            if (newXCoord <= rightPosition &&
                (newXCoord + this.annotationWidth) >= position.left) {
                overlappingYs.push(position.top);
            }
        }
        // Figure out the new y-coordinate for the annotation.
        var defaultTop = this.defaultYCoordinate;
        overlappingYs.sort(function (a, b) {
            return a - b;
        });
        // By default, try putting the new box above all other annotations with
        // horizontal overlap.
        if (overlappingYs.length > 0) {
            var topPosition = overlappingYs[overlappingYs.length - 1];
            defaultTop = topPosition - this.verticalOverlap;
        }
        // Check if there is any position with space available between existing
        // annotations.
        for (var i = 0; i < overlappingYs.length - 1; i++) {
            // Check if there is enough space.
            if (overlappingYs[i + 1] - (overlappingYs[i] + this.annotationWidth) >=
                this.horizontalOverlap) {
                defaultTop = overlappingYs[i];
            }
        }
        return defaultTop;
    };
    return CustomizableGraphAnnotation;
}());



/***/ }),

/***/ "./src/app/graphtypes/customizable-graph/customizable-graph.component.ts":
/*!*******************************************************************************!*\
  !*** ./src/app/graphtypes/customizable-graph/customizable-graph.component.ts ***!
  \*******************************************************************************/
/*! exports provided: CustomizableGraphComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CustomizableGraphComponent", function() { return CustomizableGraphComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_material__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/material */ "./node_modules/@angular/material/esm5/material.es5.js");
/* harmony import */ var _angular_platform_browser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/platform-browser */ "./node_modules/@angular/platform-browser/fesm5/platform-browser.js");
/* harmony import */ var d3__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! d3 */ "./node_modules/d3/index.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! luxon */ "./node_modules/luxon/build/cjs-browser/luxon.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(luxon__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var src_app_cardtypes_customizable_timeline_customizable_timeline_dialog_customizable_timeline_dialog_component__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! src/app/cardtypes/customizable-timeline/customizable-timeline-dialog/customizable-timeline-dialog.component */ "./src/app/cardtypes/customizable-timeline/customizable-timeline-dialog/customizable-timeline-dialog.component.ts");
/* harmony import */ var _graph_graph_component__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../graph/graph.component */ "./src/app/graphtypes/graph/graph.component.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file or at
// https://developers.google.com/open-source/licenses/bsd





// tslint:disable-next-line:max-line-length


var CustomizableGraphComponent = /** @class */ (function (_super) {
    __extends(CustomizableGraphComponent, _super);
    function CustomizableGraphComponent(sanitizer, dialog) {
        var _this = _super.call(this, sanitizer) || this;
        _this.sanitizer = sanitizer;
        _this.dialog = dialog;
        // An event indicating that the points on the CustomizableGraph have changed.
        _this.pointsChanged = new _angular_core__WEBPACK_IMPORTED_MODULE_0__["EventEmitter"]();
        // Whether or not the user is hovering over any point on the chart.
        _this.hoveringOverPoint = false;
        // The width and height of the dialog box that appears when the user clicks on
        // the chart.
        _this.dialogWidth = '450px';
        _this.dialogHeight = '375px';
        return _this;
    }
    CustomizableGraphComponent_1 = CustomizableGraphComponent;
    CustomizableGraphComponent.prototype.ngOnDestroy = function () {
        if (this.dialogRef && this.dialogRef.unsubscribe) {
            // Destroy the dialog ref to prevent memory leaks.
            this.dialogRef.unsubscribe();
        }
    };
    CustomizableGraphComponent.prototype.ngOnChanges = function () {
        this.generateFromScratch();
    };
    CustomizableGraphComponent.prototype.generateFromScratch = function () {
        _super.prototype.generateFromScratch.call(this);
        var self = this;
        var chart = this.chart; // We need the "any" declaration in order to access the
        // internals of the chart without throwing an error.
        if (!chart) {
            return;
        }
        chart.resize({ height: 150 });
        // Show a focus line corresponding to the correct x-value when hovering
        // anywhere on the chart.
        chart.internal.main.on('mousemove', function () {
            if (self.inEditMode) {
                var coordinates = d3__WEBPACK_IMPORTED_MODULE_3__["mouse"](this);
                // Remove all other timestamps
                d3__WEBPACK_IMPORTED_MODULE_3__["select"](chart.element)
                    .select('.c3-xgrid-focus')
                    .selectAll('text')
                    .remove();
                self.showFocusLine(chart, coordinates);
            }
        });
        // Clear gridlines when not hovering over the chart.
        chart.internal.main.on('mouseout', function () {
            // clear all x-axis gridlines.
            chart.xgrids([]);
            // Remove all other timestamps
            d3__WEBPACK_IMPORTED_MODULE_3__["select"](chart.element)
                .select('.c3-xgrid-focus')
                .selectAll('text')
                .remove();
        });
        // Logic to add a point when clicking on the chart.
        chart.internal.main.on('click', function () {
            if (self.inEditMode && !self.hoveringOverPoint) {
                var coordinates = d3__WEBPACK_IMPORTED_MODULE_3__["mouse"](this);
                var parentCoordinates = d3__WEBPACK_IMPORTED_MODULE_3__["mouse"](document.body);
                self.addPoint(coordinates, parentCoordinates);
            }
        });
        // Send the chart to the back, allowing points to be displayed on top of the
        // axis.
        var chartLayer = d3__WEBPACK_IMPORTED_MODULE_3__["select"](chart.element).select('.c3-chart');
        var chartLayerNode = chartLayer.node();
        var chartLayerParentNode = chartLayerNode.parentNode;
        var removedNode = chartLayer.remove();
        chartLayerParentNode.appendChild(removedNode.node());
        chartLayer.attr('clip-path', null);
        // Don't show the y-axis, but still set values so that the width is adjusted
        // & aligned with other charts.
        d3__WEBPACK_IMPORTED_MODULE_3__["select"](chart.element).select('.c3-axis-y').style('visibility', 'hidden');
        // Once the chart is rendered, only display the data points in the current
        // date range. This is due to a C3 bug that plots some points
        // outside of the x-axis/y-axis boundaries upon loading additional data.
        this.loadNewData();
        // Update the annotations displayed for this chart.
        this.updateAnnotations();
    };
    // This function loads the data into the chart without needing the chart to be
    // re-rendered completely. We only load data that is strictly within the date
    // range being displayed on the chart, due to a C3 bug that plots some points
    // outside of the x-axis/y-axis boundaries.
    CustomizableGraphComponent.prototype.loadNewData = function () {
        var columnsToLoad = [['x_'], ['']];
        var entireInterval = luxon__WEBPACK_IMPORTED_MODULE_4__["Interval"].fromDateTimes(this.dateRange.start.toLocal().startOf('day'), this.dateRange.end.toLocal().endOf('day'));
        for (var i = 1; i < this.data.c3DisplayConfiguration.allColumns[0].length; i++) {
            // Only add the data to the array being loaded if it is within the date
            // range.
            if (entireInterval.contains(this.data.c3DisplayConfiguration.allColumns[0][i])) {
                columnsToLoad[0].push(this.data.c3DisplayConfiguration.allColumns[0][i]);
                columnsToLoad[1].push(0);
            }
        }
        this.chart.load({ columns: columnsToLoad });
    };
    // If the selected date already has an annotation, modify the time
    // by + 1 millisecond.
    CustomizableGraphComponent.prototype.updateTime = function (millis) {
        if (this.data.annotations.has(millis)) {
            return this.updateTime(millis + 1);
        }
        return millis;
    };
    // Show a focus line with the timestamps when moving the mouse around the
    // chart.
    CustomizableGraphComponent.prototype.showFocusLine = function (chart, coordinates) {
        var focusEl = d3__WEBPACK_IMPORTED_MODULE_3__["select"](chart.element).select('line.c3-xgrid-focus');
        focusEl.attr('x1', coordinates[0]);
        focusEl.attr('x2', coordinates[0]);
        var timestamp = luxon__WEBPACK_IMPORTED_MODULE_4__["DateTime"].fromJSDate(chart.internal.x.invert(coordinates[0]));
        // See time on hover
        d3__WEBPACK_IMPORTED_MODULE_3__["select"](chart.element)
            .select('g.c3-xgrid-focus')
            .append('text')
            .attr('text-anchor', 'end')
            .attr('transform', 'rotate(-90)')
            .attr('x', 0)
            .attr('y', coordinates[0])
            .attr('dx', -4)
            .attr('dy', -5)
            .style('opacity', 1)
            .text(timestamp.toLocal().toLocaleString() + ' ' +
            timestamp.toLocal().toLocaleString(luxon__WEBPACK_IMPORTED_MODULE_4__["DateTime"].TIME_24_SIMPLE));
    };
    /**
     * Allow for the addition of a point to the CustomizableGraph, via a
     * CustomizableTimelineDialog.
     * (Visible only for testing.)
     */
    CustomizableGraphComponent.prototype.addPoint = function (clickCoordinates, parentCoordinates) {
        var dialogCoordinates = this.findDialogCoordinates(parentCoordinates[0] + 10, parentCoordinates[1] + 10);
        this.dialogRef = this.openDialog(clickCoordinates, dialogCoordinates);
    };
    CustomizableGraphComponent.prototype.openDialog = function (clickCoordinates, dialogCoordinates, editedAnnotation) {
        var _this = this;
        var chart = this.chart;
        var xCoordinate = chart.internal.x.invert(clickCoordinates[0]);
        // Make the dialog show up near where the user clicked.
        var data = editedAnnotation ? {
            title: editedAnnotation.title,
            date: new Date(editedAnnotation.timestamp.toMillis()),
            description: editedAnnotation.description,
            color: editedAnnotation.color,
            dateRange: this.dateRange,
        } :
            {
                date: xCoordinate,
                dateRange: this.dateRange,
            };
        this.dialogRef = this.dialog.open(src_app_cardtypes_customizable_timeline_customizable_timeline_dialog_customizable_timeline_dialog_component__WEBPACK_IMPORTED_MODULE_5__["CustomizableTimelineDialogComponent"], {
            width: this.dialogWidth,
            height: this.dialogHeight,
            position: { top: dialogCoordinates[1] + 'px', left: dialogCoordinates[0] + 'px' },
            data: data
        });
        this.dialogRef.afterClosed().subscribe(function (r) {
            if (r) {
                if (editedAnnotation) {
                    _this.data.removePointFromSeries(luxon__WEBPACK_IMPORTED_MODULE_4__["DateTime"].fromMillis(editedAnnotation.timestamp.toMillis()));
                    _this.removeAnnotation(editedAnnotation.timestamp.toMillis());
                    _this.generateFromScratch();
                }
                var result = r;
                // By default, the user selected date is the original date
                // corresponding to where the user chose to add the point.
                var userSelectedDate = result.timestamp;
                // TODO(b/122371627):  Use UUIDs instead of timestamps to track
                // annotations.
                userSelectedDate =
                    luxon__WEBPACK_IMPORTED_MODULE_4__["DateTime"].fromMillis(_this.updateTime(userSelectedDate.toMillis()));
                result.timestamp = userSelectedDate;
                _this.data.addPointToSeries(0, result);
                // Only display the annotation if the user selected date is within the
                // current date range.
                var entireInterval = luxon__WEBPACK_IMPORTED_MODULE_4__["Interval"].fromDateTimes(_this.dateRange.start.toLocal().startOf('day'), _this.dateRange.end.toLocal().endOf('day'));
                if (entireInterval.contains(userSelectedDate)) {
                    _this.data.annotations.get(userSelectedDate.toMillis())
                        .addAnnotation(chart);
                    // Add listeners for click events on the new annotation.
                    _this.addDeleteEvent(userSelectedDate.toMillis());
                    _this.addEditListener(userSelectedDate.toMillis());
                }
                _this.loadNewData();
                _this.pointsChanged.emit(_this.data);
            }
        });
    };
    // Updates the annotations displayed on the chart after a new point is added
    // or the date range is changed.
    CustomizableGraphComponent.prototype.updateAnnotations = function () {
        // We sort the points by timestamp.
        var timestamps = Array.from(this.data.annotations.keys()).sort();
        // Charted points are always sorted by timestamp.
        var chartedPoints = d3__WEBPACK_IMPORTED_MODULE_3__["select"]('#' + this.chartDivId)
            .select('.c3-circles')
            .selectAll('circle')
            .nodes();
        var entireInterval = luxon__WEBPACK_IMPORTED_MODULE_4__["Interval"].fromDateTimes(this.dateRange.start.toLocal().startOf('day'), this.dateRange.end.toLocal().endOf('day'));
        if (chartedPoints.length > 0) {
            for (var i = 0; i < timestamps.length; i++) {
                var timestamp = timestamps[i];
                var xPosition = d3__WEBPACK_IMPORTED_MODULE_3__["select"](chartedPoints[i]).attr('cx');
                // Only add the annotation if the chart point is displayed given the
                // date range selected.
                if (entireInterval.contains(luxon__WEBPACK_IMPORTED_MODULE_4__["DateTime"].fromMillis(timestamp))) {
                    this.data.annotations.get(timestamp).addAnnotation(this.chart);
                    // Add listeners for click events on the new annotation.
                    this.addDeleteEvent(timestamp);
                    this.addEditListener(timestamp);
                }
            }
        }
    };
    /**
     * Removes an annotation at the given time from the DOM.
     * @param millis The millis for this point to remove.
     */
    CustomizableGraphComponent.prototype.removeAnnotation = function (millis) {
        d3__WEBPACK_IMPORTED_MODULE_3__["select"]('#' + this.chartDivId)
            .select('tooltip-custom-' + millis)
            .remove();
        d3__WEBPACK_IMPORTED_MODULE_3__["select"]('#' + this.chartDivId)
            .select('tooltip-connector-' + millis)
            .remove();
        this.updateAnnotations();
    };
    /**
     * Add a listener for a click event on the delete button of the annotation at
     * the given time.
     * @param millis The millis for this point to remove.
     */
    CustomizableGraphComponent.prototype.addDeleteEvent = function (millis) {
        var self = this;
        var deleteIcon = d3__WEBPACK_IMPORTED_MODULE_3__["select"]('#' + this.chartDivId).select('#delete-' + millis);
        deleteIcon.on('click', function () {
            var time = luxon__WEBPACK_IMPORTED_MODULE_4__["DateTime"].fromMillis(millis);
            self.data.removePointFromSeries(time);
            self.generateFromScratch();
            self.pointsChanged.emit(self.data);
        });
    };
    /**
     * Add a listener for a click event on the edit button of the annotation at
     * the given time.
     * Visible only for testing.
     * @param millis The millis for this point to remove.
     */
    CustomizableGraphComponent.prototype.addEditListener = function (millis) {
        var self = this;
        var editIcon = d3__WEBPACK_IMPORTED_MODULE_3__["select"]('#' + this.chartDivId).select('#edit-' + millis);
        var currAnnotation = this.data.annotations.get(millis);
        editIcon.on('click', function () {
            var parentCoordinates = d3__WEBPACK_IMPORTED_MODULE_3__["mouse"](document.body);
            var dialogCoordinates = self.findDialogCoordinates(parentCoordinates[0] + 10, parentCoordinates[1] + 0);
            self.dialogRef =
                self.openDialog(parentCoordinates, dialogCoordinates, currAnnotation);
        });
    };
    /**
     * Change the coordinates of the dialog's position if the dialog will go past
     * the edges of the screen.
     * @param xCoordinate The x coordinate to change, if necessary.
     * @param yCoordinate The y coordinate to change, if necessary.
     */
    CustomizableGraphComponent.prototype.findDialogCoordinates = function (xCoordinate, yCoordinate) {
        var windowWidth = window.innerWidth;
        var windowHeight = window.innerHeight;
        var dialogWidth = Number(this.dialogWidth.replace('px', ''));
        var dialogHeight = Number(this.dialogHeight.replace('px', ''));
        if ((xCoordinate + dialogWidth) > windowWidth) {
            xCoordinate -= ((xCoordinate + dialogWidth) - windowWidth);
        }
        if ((yCoordinate + dialogHeight) > windowHeight) {
            yCoordinate -= ((yCoordinate + dialogHeight) - windowHeight);
        }
        return [xCoordinate, yCoordinate];
    };
    /**
     * @returns the c3.ChartConfiguration object to generate the c3 chart.
     * @override
     */
    CustomizableGraphComponent.prototype.generateChart = function () {
        this.adjustYAxisConfig();
        this.generateBasicChart();
        this.chartConfiguration.axis.x.height = 50;
        this.chartConfiguration.data.type = 'scatter';
        this.chartConfiguration.zoom = { enabled: false };
        var self = this;
        this.chartConfiguration.data.onmouseover = function (d) {
            self.hoveringOverPoint = true;
        };
        this.chartConfiguration.tooltip = { show: false };
        this.chartConfiguration.transition = { duration: 0 };
        this.chartConfiguration.data.onmouseout = function (d) {
            // Add a timeout to ensure that the user can't add a point immediately
            // after moving away from an existing point.
            setTimeout(function () {
                self.hoveringOverPoint = false;
            }, 500);
        };
        this.chartConfiguration.data.onclick = function (d, element) {
            self.hoveringOverPoint = true;
        };
        this.chartConfiguration.data.color = function (color, d) {
            return self.data.annotations.get(luxon__WEBPACK_IMPORTED_MODULE_4__["DateTime"].fromJSDate(d.x).toMillis())
                .color;
        };
        this.chartConfiguration
            .point = { show: true, r: 5, focus: { expand: { enabled: false } } };
        return this.chartConfiguration;
    };
    CustomizableGraphComponent.prototype.adjustYAxisConfig = function () {
        // Give labels to each series and make a map of x-values to y-values.
        this.yAxisConfig = {
            min: 0,
            max: 5,
            padding: { top: 0, bottom: 0 },
            tick: {
                count: 5,
                format: function (d) {
                    // We add padding to our y-axis tick labels so that all y-axes of the
                    // charts rendered on the page can be aligned.
                    return (d)
                        .toLocaleString('en-us', { minimumFractionDigits: 2, maximumFractionDigits: 2 })
                        .trim()
                        .padStart(12, '\xa0');
                }
            }
        };
    };
    // This is not relevant for the CustomizableGraph, so its implementation for
    // this class is empty.
    CustomizableGraphComponent.prototype.adjustDataDependent = function () { };
    var CustomizableGraphComponent_1;
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Output"])(),
        __metadata("design:type", Object)
    ], CustomizableGraphComponent.prototype, "pointsChanged", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", Boolean)
    ], CustomizableGraphComponent.prototype, "inEditMode", void 0);
    CustomizableGraphComponent = CustomizableGraphComponent_1 = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Component"])({
            selector: 'app-customizable-graph',
            template: __webpack_require__(/*! ../graph/graph.component.html */ "./src/app/graphtypes/graph/graph.component.html"),
            styles: [__webpack_require__(/*! ../../cardtypes/customizable-timeline/customizable-timeline.component.css */ "./src/app/cardtypes/customizable-timeline/customizable-timeline.component.css")],
            providers: [{
                    provide: _graph_graph_component__WEBPACK_IMPORTED_MODULE_6__["GraphComponent"],
                    useExisting: Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["forwardRef"])(function () { return CustomizableGraphComponent_1; })
                }]
        }),
        __metadata("design:paramtypes", [_angular_platform_browser__WEBPACK_IMPORTED_MODULE_2__["DomSanitizer"], _angular_material__WEBPACK_IMPORTED_MODULE_1__["MatDialog"]])
    ], CustomizableGraphComponent);
    return CustomizableGraphComponent;
}(_graph_graph_component__WEBPACK_IMPORTED_MODULE_6__["GraphComponent"]));



/***/ }),

/***/ "./src/app/graphtypes/graph.css":
/*!**************************************!*\
  !*** ./src/app/graphtypes/graph.css ***!
  \**************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "/* All the below styles apply to elements within the graphs. Because these\nare nested inside the components and within C3 divs, we have to prefix the\nstyle names with ::ng-deep.  */\n\n::ng-deep .c3-region {\n  fill: hsl(150, 50%, 50%);\n  stroke: hsl(150, 50%, 70%);;\n  stroke-dasharray: 1px;\n}\n\n::ng-deep .c3 {\n  cursor: default !important;\n}\n\n.c3-tooltip > tbody > tr > th {\n  background-color: rgb(197, 185, 172); /* Boston Warm Gray */\n}\n\n/* This ensures that the step graph lines do not show circles for individual data points, except for the end points of each line segment. */\n\n::ng-deep .stepgraph .c3-circles:not([class *=\"endpoint\"]) {\n  display: none;\n}\n\n/* This is styling for a stepgraphcard's circles on the end points of line segments. */\n\n::ng-deep .stepgraph [class *= \"endpoint\"] {\n  stroke: black;\n  opacity: 1;\n  stroke-width: 3;\n}\n\n::ng-deep .stepgraph .c3-line {\n  stroke-width: 2px;\n}\n\n::ng-deep .stepgraph [class*=\"tooltip\"] {\n  width: 210px;\n}\n\n::ng-deep .c3-axis-y text :not(.c3-axis-y-label) {\n  font-family: \"Roboto\", sans-serif;\n  font-size: 13px;\n}\n\n::ng-deep .c3-axis-x text {\n  font-family: \"Roboto\", sans-serif !important;\n  font-size: 13px;\n}\n\n::ng-deep .noData {\n  opacity: 1 !important;\n}\n\n::ng-deep .c3-ygrid-line text {\n  font-size: 13px !important;\n  fill: black;\n}\n\n/* These colors need to stay consistent with the color options in the dialog for the custom timeline. */\n\n/* Yellow grid line */\n\n::ng-deep .c3-xgrid-line.colorF2A900 line {\n  stroke: #F2A900;\n}\n\n/* Blue grid line */\n\n::ng-deep .c3-xgrid-line.color007396 line {\n  stroke: #007396;\n}\n\n/* Green grid line */\n\n::ng-deep .c3-xgrid-line.color739600 line {\n  stroke: #739600;\n}\n\n/* Pink grid line */\n\n::ng-deep .c3-xgrid-line.colorC6579A line {\n  stroke: #C6579A;\n}\n\n/* Purple grid line */\n\n::ng-deep .c3-xgrid-line.color8C4799 line {\n  stroke: #8C4799;\n}\n\n/* Red grid line */\n\n::ng-deep .c3-xgrid-line.color80225F line {\n  stroke: #80225F;\n}\n\n::ng-deep .encounter-region {\n  fill: rgb(0, 35, 86); /* Primary color */\n  stroke: rgb(0, 35, 86); /* Primary color */\n}\n\n::ng-deep .order-region {\n  fill: rgb(179, 157, 219); /* Secondary color */\n  stroke:  rgb(179, 157, 219); /* Secondary color */\n}\n\n::ng-deep .c3-tooltip td {\n  max-width: 160px;\n}"

/***/ }),

/***/ "./src/app/graphtypes/graph/datetimexaxis.ts":
/*!***************************************************!*\
  !*** ./src/app/graphtypes/graph/datetimexaxis.ts ***!
  \***************************************************/
/*! exports provided: DateTimeXAxis */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DateTimeXAxis", function() { return DateTimeXAxis; });
/* harmony import */ var src_app_date_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! src/app/date_utils */ "./src/app/date_utils.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

var DateTimeXAxis = /** @class */ (function () {
    function DateTimeXAxis(
    /**
     * The date range this x axis configuration should cover.
     */
    dateRange, maxXTicks) {
        if (maxXTicks === void 0) { maxXTicks = 10; }
        this.dateRange = dateRange;
        this.maxXTicks = maxXTicks;
        this.makeXAxis();
    }
    /**
     * If the date range is changed, adjust the x-axis tick marks displayed. This
     * method does not need to be called otherwise, as the x-axis should stay
     * constant unless the date range is changed.
     * @param maxXTicks The maximum number of labeled ticks to display. By
     *     default, any date range lasting shorter than maxXTicks will show tick
     *     marks with labels at each 24-hour mark, and tick marks without labels
     *     at 12-hour marks.
     */
    DateTimeXAxis.prototype.makeXAxis = function () {
        var daysInRange = Object(src_app_date_utils__WEBPACK_IMPORTED_MODULE_0__["getTickMarksForXAxis"])(this.dateRange, true);
        // The ticks with labels displayed.
        var ticksLabels = new Array();
        // All ticks displayed.
        var ticks = new Array();
        if (Math.floor(daysInRange.length / 2) <= this.maxXTicks) {
            // Ticks are separated by 1 day intervals, in which case we show ticks
            // with no labels at the 12-hour mark.
            ticks = daysInRange;
            for (var i = 0; i < daysInRange.length; i += 2) {
                ticksLabels.push(daysInRange[i]);
            }
        }
        else {
            // Ticks are separated by intervals > 1 day, in which case we show ticks
            // with no labels at the day mark.
            var iteration = Math.ceil(daysInRange.length / this.maxXTicks);
            ticksLabels.push(daysInRange[0]);
            var date = daysInRange[0];
            while (date <= this.dateRange.end) {
                date = date.plus({ days: iteration });
                ticksLabels.push(date);
            }
            date = daysInRange[0];
            ticks.push(date);
            while (date <= this.dateRange.end) {
                date = date.plus({ days: 1 });
                ticks.push(date);
            }
        }
        this.xAxisLabels = ticksLabels.map(function (x) { return x.toFormat('MM/dd HH:mm'); });
        this.xAxisConfig = {
            type: 'timeseries',
            min: this.dateRange.start.toLocal().startOf('day').toJSDate(),
            max: this.dateRange.end.toLocal().endOf('day').toJSDate(),
            localtime: true,
            tick: {
                // To reduce ambiguity we include the hour as well.
                format: '%m/%d %H:%M',
                multiline: true,
                fit: true,
                values: ticks.map(function (x) { return Number(x); })
            }
        };
    };
    return DateTimeXAxis;
}());



/***/ }),

/***/ "./src/app/graphtypes/graph/graph.component.html":
/*!*******************************************************!*\
  !*** ./src/app/graphtypes/graph/graph.component.html ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<div id=\"{{chartDivId}}\"></div>\n<table id=\"c3-tooltip\" class=\"c3-tooltip\"></table>\n"

/***/ }),

/***/ "./src/app/graphtypes/graph/graph.component.ts":
/*!*****************************************************!*\
  !*** ./src/app/graphtypes/graph/graph.component.ts ***!
  \*****************************************************/
/*! exports provided: ChartType, Y_AXIS_TICK_MAX, GraphComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChartType", function() { return ChartType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Y_AXIS_TICK_MAX", function() { return Y_AXIS_TICK_MAX; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GraphComponent", function() { return GraphComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var c3__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! c3 */ "./node_modules/c3/c3.js");
/* harmony import */ var c3__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(c3__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var d3__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! d3 */ "./node_modules/d3/index.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! luxon */ "./node_modules/luxon/build/cjs-browser/luxon.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(luxon__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var src_app_graphdatatypes_linegraphdata__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! src/app/graphdatatypes/linegraphdata */ "./src/app/graphdatatypes/linegraphdata.ts");
/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! uuid */ "./node_modules/uuid/index.js");
/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(uuid__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../tooltips/tooltip */ "./src/app/graphtypes/tooltips/tooltip.ts");
/* harmony import */ var _datetimexaxis__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./datetimexaxis */ "./src/app/graphtypes/graph/datetimexaxis.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};








var ChartType;
(function (ChartType) {
    ChartType[ChartType["SCATTER"] = 0] = "SCATTER";
    ChartType[ChartType["LINE"] = 1] = "LINE";
    ChartType[ChartType["STEP"] = 2] = "STEP";
    ChartType[ChartType["MICROBIO"] = 3] = "MICROBIO";
})(ChartType || (ChartType = {}));
var BASE_CHART_HEIGHT_PX = 150;
// The maximum characters for a y-axis tick label.
var Y_AXIS_TICK_MAX = 12;
/**
 * Displays a graph. T is the data type the graph is equipped to display.
 */
var GraphComponent = /** @class */ (function () {
    function GraphComponent(sanitizer) {
        this.sanitizer = sanitizer;
        // What type of chart this is. Line chart by default.
        this.chartType = ChartType.LINE;
        // Maps for making a custom legend. We assume that the custom legend does not
        // change over the lifetime of this rendered graph.
        this.customLegendSet = false;
        // These two variables are different views on the data held in
        // seriesTodisplayGroup. We need to hold them in separate maps for more
        // efficient access during legend interaction.
        this.displayGroupToSeries = new Map();
        // A map containing a color for each series displayed on the graph.
        this.colorsMap = {};
        // Generate a unique ID for this chart.
        var chartId = Object(uuid__WEBPACK_IMPORTED_MODULE_5__["v4"])();
        // Replace the dashes in the UUID to meet HTML requirements.
        var re = /\-/gi;
        this.chartDivId = 'chart' + chartId.replace(re, '');
    }
    /*
     * Returns whether or not there are any data points in the series that fall
     * inside the date range provided.
     * @param series The LabeledSeries to find data points in the date range.
     * @param dateRange The date range in which to see if there are any data
     *     points.
     */
    GraphComponent.dataPointsInRange = function (series, dateRange) {
        var entireRange = luxon__WEBPACK_IMPORTED_MODULE_3__["Interval"].fromDateTimes(dateRange.start.toLocal().startOf('day'), dateRange.end.toLocal().endOf('day'));
        for (var _i = 0, series_1 = series; _i < series_1.length; _i++) {
            var s = series_1[_i];
            for (var _a = 0, _b = s.xValues; _a < _b.length; _a++) {
                var x = _b[_a];
                if (entireRange.contains(x)) {
                    return true;
                }
            }
        }
        return false;
    };
    // The chart can't find the element to bind to until after the view is
    // initialized so we need to regenerate the chart here.
    GraphComponent.prototype.ngAfterViewInit = function () {
        this.generateFromScratch();
    };
    // Any time the bound data changes, we need to adjust the configurations of
    // the chart. If there is not yet a chart configuration, we generate the chart
    // from scratch.
    GraphComponent.prototype.ngOnChanges = function (changes) {
        // Only change what needs to be changed.
        if (this.chartConfiguration) {
            if (changes.data) {
                this.dataChanged();
            }
            if (changes.dateRange) {
                this.xAxis = new _datetimexaxis__WEBPACK_IMPORTED_MODULE_7__["DateTimeXAxis"](this.dateRange);
            }
            if (changes.eventlines) {
                this.updateEventlines();
            }
            this.chart = c3__WEBPACK_IMPORTED_MODULE_1__["generate"](this.chartConfiguration);
            this.adjustStyle();
        }
        else {
            this.generateFromScratch();
        }
    };
    // If there is not yet a chart or chart configuration, configure and generate
    // the chart to display.
    GraphComponent.prototype.generateFromScratch = function () {
        if (this.data && this.dateRange) {
            this.generateChart();
            this.chart = c3__WEBPACK_IMPORTED_MODULE_1__["generate"](this.chartConfiguration);
            this.adjustStyle();
        }
    };
    // Called if the data to be displayed on the chart is changed.
    GraphComponent.prototype.dataChanged = function () {
        // Y axis configuration depends on the data values.
        this.adjustYAxisConfig();
        // The colors displayed depends on the data values.
        this.adjustColorMap();
        // Update the data points displayed on the chart.
        this.updateData();
        // Adjust the y-axis ticks and wrapping for the chart, also dependent on the
        // data values.
        this.adjustDataDependent();
    };
    // Called after some, or all, parts of the chart are changed, to ensure that
    // the style stays.
    GraphComponent.prototype.adjustStyle = function () {
        this.showNoData();
        this.wrapYAxisLabels();
    };
    // Add an overlay indicating that there are no data points in the date
    // range.
    GraphComponent.prototype.showNoData = function () {
        if (this.noDataPointsInDateRange) {
            var emptyContainer = d3__WEBPACK_IMPORTED_MODULE_2__["select"]('#' + this.chartDivId).select('.c3-text.c3-empty');
            emptyContainer.text('No data for ' + this.dateRange.start.toLocaleString() + '-' +
                this.dateRange.end.toLocaleString());
            emptyContainer.attr('class', 'c3-text c3-empty noData');
            // We set the opacity of the y-axis ticks of empty charts to 0 after
            // setting the tick values. We do this instead of not displaying the
            // y-axis altogether to ensure that the left padding of the chart is
            // aligned with all other charts.
            var yAxisTicks = d3__WEBPACK_IMPORTED_MODULE_2__["select"]('#' + this.chartDivId)
                .selectAll('.c3-axis-y')
                .selectAll('.tick')
                .style('opacity', 0);
        }
    };
    /**
     * Sets up a generalized c3.ChartConfig for the data passed in. See the
     * type definition at:
     * https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/c3/index.d.ts
     * @param maxXTicks: The maximum number of tick-marks to include on the x-axis
     */
    GraphComponent.prototype.generateBasicChart = function (maxXTicks) {
        if (maxXTicks === void 0) { maxXTicks = 10; }
        this.xAxis = new _datetimexaxis__WEBPACK_IMPORTED_MODULE_7__["DateTimeXAxis"](this.dateRange);
        this.adjustColorMap();
        this.chartTypeString = 'line';
        if (this.chartType === ChartType.SCATTER) {
            this.chartTypeString = 'scatter';
        }
        else if (this.chartType !== ChartType.LINE) {
            throw Error('Unsupported chart type: ' + this.chartType);
        }
        // Show the y-axis label on the chart.
        this.yAxisConfig['label'] = {
            text: (this.axisLabel ? this.axisLabel : ''),
            position: 'outer-middle'
        };
        var gridlines = this.eventlines ? this.eventlines : [];
        var self = this;
        var chartConfiguration = {
            bindto: '#' + this.chartDivId,
            size: { height: BASE_CHART_HEIGHT_PX },
            data: {
                columns: this.data.c3DisplayConfiguration.allColumns,
                xs: this.data.c3DisplayConfiguration.columnMap,
                type: this.chartTypeString,
                colors: this.colorsMap,
            },
            regions: this.data.xRegions,
            axis: { x: this.xAxis.xAxisConfig, y: this.yAxisConfig },
            legend: { show: false },
            line: { connectNull: false },
            onrendered: function () {
                self.boldDates();
                self.adjustStyle();
                self.fixOpacity();
                self.onRendered(this);
            },
            grid: { x: { lines: gridlines } },
            tooltip: this.setTooltip()
        };
        this.setCustomLegend(this.data.c3DisplayConfiguration.ySeriesLabelToDisplayGroup);
        this.chartConfiguration = chartConfiguration;
    };
    // If only the data is updated, there is no need to re-configure the chart
    // configurations that stay constant. Instead, just rework the
    // ChartConfiguration's data field.
    GraphComponent.prototype.updateData = function () {
        this.chartConfiguration.data = {
            columns: this.data.c3DisplayConfiguration.allColumns,
            xs: this.data.c3DisplayConfiguration.columnMap,
            type: this.chartTypeString,
            colors: this.colorsMap,
        };
    };
    // Update any event lines from any CustomTimeline that should be shown on the
    // chart.
    GraphComponent.prototype.updateEventlines = function () {
        var gridlines = this.eventlines ? this.eventlines : [];
        this.chartConfiguration.grid.x = { lines: gridlines };
    };
    // Adjust the color map for the data belonging to the chart.
    GraphComponent.prototype.adjustColorMap = function () {
        for (var _i = 0, _a = Object.keys(this.data.c3DisplayConfiguration.columnMap); _i < _a.length; _i++) {
            var key = _a[_i];
            if (this.data.c3DisplayConfiguration.ySeriesLabelToDisplayGroup.get(key)) {
                var lookupColor = this.data.c3DisplayConfiguration.ySeriesLabelToDisplayGroup.get(key)
                    .fill;
                this.colorsMap[key] = lookupColor.toString();
            }
        }
    };
    /**
     * Sets the tooltip for the graph.
     * If the class has a tooltipMap set, then we look up the tooltip from that
     * map. If there's no tooltipMap, then we return a simple formatted tooltip
     * of just the string representing the data plus the appropriate units for
     * a linegraph, or just the unedited value if it's a different kind of graph.
     */
    GraphComponent.prototype.setTooltip = function () {
        var _this = this;
        var self = this;
        if (this.data && this.data.tooltipMap) {
            return {
                contents: function (pointData, defaultTitleFormat, defaultValueFormat, color) {
                    // pointData will hold every point for the x-value you're hovering
                    // on. We squish together all those data points preemptively in
                    // our tooltip creation so that we just find the index of the
                    // tooltip based on the first point's x-value.
                    var value = pointData[0];
                    var timestampKey = luxon__WEBPACK_IMPORTED_MODULE_3__["DateTime"].fromJSDate(value.x).toMillis().toString();
                    // Our data class may provide a tooltip key function that will
                    // get the correct identifier from the data point. If it does,
                    // we'll use that, but by default, the key is the timestamp
                    // of the data point.
                    var keyToUse = _this.data.tooltipKeyFn ?
                        _this.data.tooltipKeyFn(value) :
                        timestampKey;
                    // If something bad happens and we don't have a tooltip for the
                    // key, return an empty string so that there will just be no
                    // tooltip.
                    if (!_this.data.tooltipMap.has(keyToUse)) {
                        return new _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_6__["StandardTooltip"](pointData, color, self.data instanceof src_app_graphdatatypes_linegraphdata__WEBPACK_IMPORTED_MODULE_4__["LineGraphData"] ? self.data.unit : '')
                            .getTooltip(undefined, _this.sanitizer);
                    }
                    return _this.data.tooltipMap.get(keyToUse);
                }
            };
        }
        else {
            return {
                format: {
                    value: function (value, ratio, id, index) {
                        if (self.data instanceof src_app_graphdatatypes_linegraphdata__WEBPACK_IMPORTED_MODULE_4__["LineGraphData"]) {
                            return (d3__WEBPACK_IMPORTED_MODULE_2__["format"](',.' + self.data.precision + 'f')(value) + ' ' +
                                self.data.unit);
                        }
                        return value;
                    }
                }
            };
        }
    };
    /**
     * Adds a shaded region on the chart across all x values, between the two
     * y values specified by yBounds.
     * @param basicChart The chart to add the region to
     * @param yBounds The y-bounds of the region to display
     */
    GraphComponent.prototype.addYRegionOnChart = function (basicChart, yBounds) {
        if (!basicChart.axis.y.tick) {
            basicChart.axis.y['tick'] = {};
        }
        basicChart.axis.y.tick['values'] = yBounds;
        if (!basicChart['regions']) {
            basicChart['regions'] = [];
        }
        basicChart['regions'].push({ axis: 'y', start: yBounds[0], end: yBounds[1] });
        return basicChart;
    };
    /**
     * Sets a custom legend.
     * To simplify rendering logic, we assume that we only set up a custom legend
     * once over the lifetime of this graph.
     *
     * @param customLegendMap If you want a custom legend grouping multiple series
     *   together, pass a map with keys of
     *   series names and values of the ClinicalConcepts they should correspond
     *   to in a legend.
     */
    GraphComponent.prototype.setCustomLegend = function (seriesToDisplayGroup) {
        if (!this.customLegendSet) {
            for (var _i = 0, _a = Array.from(seriesToDisplayGroup.entries()); _i < _a.length; _i++) {
                var _b = _a[_i], seriesLbl = _b[0], displayGroup = _b[1];
                if (!this.displayGroupToSeries.has(displayGroup)) {
                    this.displayGroupToSeries.set(displayGroup, new Array(seriesLbl));
                }
                else {
                    var appendedArray = this.displayGroupToSeries.get(displayGroup).concat(seriesLbl);
                    this.displayGroupToSeries.set(displayGroup, appendedArray);
                }
            }
            this.customLegendSet = true;
        }
    };
    GraphComponent.prototype.focusOnDisplayGroup = function (displayGroup) {
        this.chart.focus(this.displayGroupToSeries.get(displayGroup));
    };
    GraphComponent.prototype.resetChart = function (displayGroup) {
        this.chart.revert();
    };
    /**
     * Inserts wrapped y-axis tick labels.
     * TODO(b/123229731): Include this method in chart.onRendered
     */
    GraphComponent.prototype.wrapYAxisLabels = function () {
        if (this.yAxisTickDisplayValues) {
            var currIndex_1 = 0;
            var self_1 = this;
            d3__WEBPACK_IMPORTED_MODULE_2__["select"]('#' + this.chartDivId)
                .selectAll('.c3-axis-y')
                .selectAll('.tick text')
                .each(function () {
                // Get the text element.
                var text = d3__WEBPACK_IMPORTED_MODULE_2__["select"](this);
                // Break up the label by spaces.
                var words = self_1.yAxisTickDisplayValues[currIndex_1].split(/\s+/).reverse();
                var word;
                var line = [];
                var lineHeight = 10;
                // startDy is an attribute indicating how much to shift the first
                // line of the label by in the y direction. The standard dy for a
                // tick text is 3. Figure out the optimal starting dy such that half
                // of the words are displayed above the tick, and half below.
                var dyInterval = 6;
                var startDy = 3 - (Math.floor(words.length / 2) * dyInterval);
                // Insert the initial tspan.
                var tspan = text.text(null).append('tspan').attr('x', -9).attr('dy', startDy);
                while (word = words.pop()) {
                    line.push(word);
                    tspan.text(line.join(' '));
                    // Add another tspan (another line) if the label is too long.
                    // We don't break up single words that are too long.
                    if (tspan.text().length > Y_AXIS_TICK_MAX &&
                        tspan.text().includes(' ')) {
                        // Add another line.
                        line.pop();
                        tspan.text(line.join(' '));
                        line = [word];
                        tspan =
                            text.append('tspan').attr('x', -9).attr('dy', lineHeight);
                    }
                }
                // Add the remaining parts of the label to the tspan's text.
                if (line.length > 0) {
                    tspan.text(line.join(' '));
                }
                currIndex_1++;
            });
        }
    };
    /**
     * Called every time the graph is rendered. If subclass graphs want to do
     * something special upon rendering, they can override this function.
     */
    GraphComponent.prototype.onRendered = function (graphObject) { };
    /**
     * Bolds the date portion of each x-axis tick label, and removes unnecessary
     * labels.
     */
    GraphComponent.prototype.boldDates = function () {
        if (this.chart) {
            var self_2 = this;
            d3__WEBPACK_IMPORTED_MODULE_2__["select"]('#' + this.chartDivId)
                .selectAll('.c3-axis-x')
                .selectAll('.tick text')
                .each(function () {
                // We get x (the x position), dy (how much to shift vertically), and
                // dx (how much to shift horiztontally) of the tspan inside text
                var dy = d3__WEBPACK_IMPORTED_MODULE_2__["select"](this).select('tspan').attr('dy');
                var dx = d3__WEBPACK_IMPORTED_MODULE_2__["select"](this).select('tspan').attr('dx');
                var x = d3__WEBPACK_IMPORTED_MODULE_2__["select"](this).select('tspan').attr('x');
                var textSplit = d3__WEBPACK_IMPORTED_MODULE_2__["select"](this).text().split(' ');
                var text = d3__WEBPACK_IMPORTED_MODULE_2__["select"](this).text();
                var tspan = d3__WEBPACK_IMPORTED_MODULE_2__["select"](this)
                    .text(null)
                    .append('tspan')
                    .attr('x', x)
                    .attr('dx', dx)
                    .attr('dy', dy)
                    .style('font-weight', 'bolder');
                // Only add the tick label text if it was meant to be
                // displayed.
                if (self_2.xAxis.xAxisLabels.length > 0 &&
                    self_2.xAxis.xAxisLabels.includes(text)) {
                    tspan.text(textSplit[0]); // Set the 'bold' tspan's content as the date.
                    d3__WEBPACK_IMPORTED_MODULE_2__["select"](this).append('tspan').text(' ' + textSplit[1]); // Add an additional tspan for the time.
                }
            });
        }
    };
    GraphComponent.prototype.fixOpacity = function () {
        d3__WEBPACK_IMPORTED_MODULE_2__["select"]('#' + this.chartDivId).selectAll('.c3-circle').each(function (d) {
            if (d3__WEBPACK_IMPORTED_MODULE_2__["select"](this).style('opacity') === '0.5') {
                d3__WEBPACK_IMPORTED_MODULE_2__["select"](this).style('opacity', 1);
            }
        });
    };
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", Array)
    ], GraphComponent.prototype, "eventlines", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", luxon__WEBPACK_IMPORTED_MODULE_3__["Interval"])
    ], GraphComponent.prototype, "dateRange", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", Object)
    ], GraphComponent.prototype, "data", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", String)
    ], GraphComponent.prototype, "axisLabel", void 0);
    return GraphComponent;
}());



/***/ }),

/***/ "./src/app/graphtypes/linegraph/linegraph.component.ts":
/*!*************************************************************!*\
  !*** ./src/app/graphtypes/linegraph/linegraph.component.ts ***!
  \*************************************************************/
/*! exports provided: LineGraphComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LineGraphComponent", function() { return LineGraphComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_platform_browser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/platform-browser */ "./node_modules/@angular/platform-browser/fesm5/platform-browser.js");
/* harmony import */ var d3__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! d3 */ "./node_modules/d3/index.js");
/* harmony import */ var _graph_graph_component__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../graph/graph.component */ "./src/app/graphtypes/graph/graph.component.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};




var LineGraphComponent = /** @class */ (function (_super) {
    __extends(LineGraphComponent, _super);
    function LineGraphComponent(sanitizer) {
        var _this = _super.call(this, sanitizer) || this;
        _this.sanitizer = sanitizer;
        return _this;
    }
    LineGraphComponent_1 = LineGraphComponent;
    /**
     * @override
     */
    LineGraphComponent.prototype.generateChart = function () {
        this.adjustYAxisConfig();
        this.generateBasicChart();
        this.adjustDataDependent();
        // Ensure that a line is not drawn through points with "null" values.
        this.chartConfiguration.line = { connectNull: false };
    };
    /**
     * Adjusts the y-axis configuration for the chart.
     */
    LineGraphComponent.prototype.adjustYAxisConfig = function () {
        var _this = this;
        // Give labels to each series and make a map of x-values to y-values.
        var min;
        var max;
        if (this.data.yAxisDisplayBounds[0] > this.data.yAxisDisplayBounds[1]) {
            // No min or max set due to no data.
            min = 0;
            max = 10;
        }
        else {
            min = this.data.yAxisDisplayBounds[0];
            max = this.data.yAxisDisplayBounds[1];
        }
        this.yAxisConfig = {
            min: min,
            max: max,
            padding: { top: 20, bottom: 20 },
            tick: {
                count: 5,
                format: function (d) {
                    // We add padding to our y-axis tick labels so that all y-axes of the
                    // charts rendered on the page can be aligned.
                    return (d)
                        .toLocaleString('en-us', {
                        minimumFractionDigits: _this.data.precision,
                        maximumFractionDigits: _this.data.precision
                    })
                        .trim()
                        .padStart(_graph_graph_component__WEBPACK_IMPORTED_MODULE_3__["Y_AXIS_TICK_MAX"], '\xa0');
                }
            },
        };
    };
    /**
     * Adjusts the data-dependent fields of the chart's configuration.
     */
    LineGraphComponent.prototype.adjustDataDependent = function () {
        var _this = this;
        // Some things are only valid if there are y-axis normal bounds. We
        // also only show normal bounds if there's one data series on the
        // axis.
        // These customizations are based on this.data, which is a type specific for
        // LineGraphData, and could not be generalized in the abstract GraphCard
        // class.
        if (this.data.series.length > 0) {
            var yBounds = this.data.series[0].yNormalBounds;
            if (this.data.series.length === 1 && yBounds) {
                this.chartConfiguration =
                    this.addYRegionOnChart(this.chartConfiguration, yBounds);
            }
        }
        // Check if there are any data points in the time range.
        this.noDataPointsInDateRange =
            !_graph_graph_component__WEBPACK_IMPORTED_MODULE_3__["GraphComponent"].dataPointsInRange(this.data.series, this.dateRange);
        // If tick values aren't set, calculate the values.
        if (!this.chartConfiguration.axis.y.tick.values) {
            this.chartConfiguration.axis.y.tick.values = this.findYAxisValues(this.data.yAxisDisplayBounds[0], this.data.yAxisDisplayBounds[1]);
        }
        if (this.chartConfiguration.axis.y.tick.values.length === 0) {
            // The dataset is empty. We show padded tick marks to align the y axis
            // with the rest of the charts' axes.
            for (var i = 0; i < 5; i++) {
                this.chartConfiguration.axis.y.tick.values.push(i);
            }
        }
        var yValues = this.chartConfiguration.axis.y.tick.values;
        var needToWrap = yValues.some(function (value) { return value.toString().length > _graph_graph_component__WEBPACK_IMPORTED_MODULE_3__["Y_AXIS_TICK_MAX"]; });
        // Due to some weird c3 rendering, we need extra padding for tick marks less
        // than 2 characters long.
        var needExtraPadding = yValues.every(function (value) { return value.toString().length < 2; });
        // Replace the tick label's initially displayed values to padded empty
        // strings so that the axis is aligned. We only do this if we need to wrap
        // axis labels in the first place.
        var extraPadding = 4;
        var padding = needToWrap ?
            _graph_graph_component__WEBPACK_IMPORTED_MODULE_3__["Y_AXIS_TICK_MAX"] :
            (needExtraPadding ? _graph_graph_component__WEBPACK_IMPORTED_MODULE_3__["Y_AXIS_TICK_MAX"] + extraPadding : undefined);
        if (padding) {
            this.chartConfiguration.axis.y.tick.format = function (d) {
                return ''.trim().padStart(padding, '\xa0');
            };
            this.yAxisTickDisplayValues =
                yValues.map(function (value) { return value.toLocaleString('en-us', {
                    minimumFractionDigits: _this.data.precision,
                    maximumFractionDigits: _this.data.precision
                }); });
        }
    };
    // Manually find y axis tick values based on the min and max display bounds.
    LineGraphComponent.prototype.findYAxisValues = function (min, max) {
        // Evenly space out 5 numbers between the min and max (display bounds).
        var difference = max - min;
        var spacing = difference / 4;
        var values = [];
        for (var curr = min; curr <= max; curr += spacing) {
            values.push(curr);
        }
        return values;
    };
    LineGraphComponent.prototype.onRendered = function () {
        if (!this.showTicks) {
            d3__WEBPACK_IMPORTED_MODULE_2__["select"]('#' + this.chartDivId)
                .selectAll('.c3-axis-y .tick')
                .style('display', 'none');
        }
    };
    var LineGraphComponent_1;
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Input"])(),
        __metadata("design:type", Boolean)
    ], LineGraphComponent.prototype, "showTicks", void 0);
    LineGraphComponent = LineGraphComponent_1 = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Component"])({
            selector: 'app-linegraph',
            template: __webpack_require__(/*! ../graph/graph.component.html */ "./src/app/graphtypes/graph/graph.component.html"),
            styles: [__webpack_require__(/*! ../graph.css */ "./src/app/graphtypes/graph.css")],
            providers: [
                { provide: _graph_graph_component__WEBPACK_IMPORTED_MODULE_3__["GraphComponent"], useExisting: Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["forwardRef"])(function () { return LineGraphComponent_1; }) }
            ]
        }),
        __metadata("design:paramtypes", [_angular_platform_browser__WEBPACK_IMPORTED_MODULE_1__["DomSanitizer"]])
    ], LineGraphComponent);
    return LineGraphComponent;
}(_graph_graph_component__WEBPACK_IMPORTED_MODULE_3__["GraphComponent"]));



/***/ }),

/***/ "./src/app/graphtypes/microbio-graph/microbio-graph.component.ts":
/*!***********************************************************************!*\
  !*** ./src/app/graphtypes/microbio-graph/microbio-graph.component.ts ***!
  \***********************************************************************/
/*! exports provided: MicrobioGraphComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MicrobioGraphComponent", function() { return MicrobioGraphComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_platform_browser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/platform-browser */ "./node_modules/@angular/platform-browser/fesm5/platform-browser.js");
/* harmony import */ var src_app_clinicalconcepts_display_grouping__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! src/app/clinicalconcepts/display-grouping */ "./src/app/clinicalconcepts/display-grouping.ts");
/* harmony import */ var src_app_fhir_data_classes_diagnostic_report__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! src/app/fhir-data-classes/diagnostic-report */ "./src/app/fhir-data-classes/diagnostic-report.ts");
/* harmony import */ var src_app_fhir_data_classes_observation_interpretation_valueset__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! src/app/fhir-data-classes/observation-interpretation-valueset */ "./src/app/fhir-data-classes/observation-interpretation-valueset.ts");
/* harmony import */ var _graph_graph_component__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../graph/graph.component */ "./src/app/graphtypes/graph/graph.component.ts");
/* harmony import */ var _stepgraph_stepgraph_component__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../stepgraph/stepgraph.component */ "./src/app/graphtypes/stepgraph/stepgraph.component.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};







var MicrobioGraphComponent = /** @class */ (function (_super) {
    __extends(MicrobioGraphComponent, _super);
    function MicrobioGraphComponent(sanitizer) {
        return _super.call(this, sanitizer) || this;
    }
    MicrobioGraphComponent_1 = MicrobioGraphComponent;
    /**
     * @override
     */
    MicrobioGraphComponent.prototype.generateChart = function () {
        _super.prototype.generateChart.call(this);
        this.chartConfiguration.data.type = 'scatter';
        this.chartConfiguration.point = { r: 5 };
    };
    /**
     * Every time the graph is rendered, go back and find all the preliminary
     * points and make sure their fill is transparent and there is a border
     * around it.
     */
    MicrobioGraphComponent.prototype.onRendered = function (graphObject) {
        // Apply colors. This will be handled better when we work on the legends.
        var posCircles = graphObject.getCircles()
            .filter(function (d) {
            return d.id.includes(src_app_fhir_data_classes_observation_interpretation_valueset__WEBPACK_IMPORTED_MODULE_4__["CHECK_RESULT_CODE"]);
        })
            .style('fill', src_app_clinicalconcepts_display_grouping__WEBPACK_IMPORTED_MODULE_2__["posFinalMB"].fill.toString());
        var negCircles = graphObject.getCircles()
            .filter(function (d) {
            return !d.id.includes(src_app_fhir_data_classes_observation_interpretation_valueset__WEBPACK_IMPORTED_MODULE_4__["CHECK_RESULT_CODE"]);
        })
            .style('fill', src_app_clinicalconcepts_display_grouping__WEBPACK_IMPORTED_MODULE_2__["negFinalMB"].fill.toString());
        // Make prelim circles transparent-filled.
        var prelimCircles = graphObject.getCircles()
            .filter(function (d) {
            return d.id.includes(src_app_fhir_data_classes_diagnostic_report__WEBPACK_IMPORTED_MODULE_3__["DiagnosticReportStatus"].Preliminary.toString());
        })
            .style('fill', 'transparent')
            .style('stroke-width', '2px');
        prelimCircles
            .filter(function (d) {
            return d.id.includes(src_app_fhir_data_classes_observation_interpretation_valueset__WEBPACK_IMPORTED_MODULE_4__["CHECK_RESULT_CODE"]);
        })
            .style('stroke', src_app_clinicalconcepts_display_grouping__WEBPACK_IMPORTED_MODULE_2__["posPrelimMB"].outline.toString());
        prelimCircles
            .filter(function (d) {
            return !d.id.includes(src_app_fhir_data_classes_observation_interpretation_valueset__WEBPACK_IMPORTED_MODULE_4__["CHECK_RESULT_CODE"]);
        })
            .style('stroke', src_app_clinicalconcepts_display_grouping__WEBPACK_IMPORTED_MODULE_2__["negPrelimMB"].outline.toString());
    };
    var MicrobioGraphComponent_1;
    MicrobioGraphComponent = MicrobioGraphComponent_1 = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Component"])({
            selector: 'app-microbio-graph',
            template: __webpack_require__(/*! ../graph/graph.component.html */ "./src/app/graphtypes/graph/graph.component.html"),
            styles: [__webpack_require__(/*! ../graph.css */ "./src/app/graphtypes/graph.css")],
            providers: [{
                    provide: _graph_graph_component__WEBPACK_IMPORTED_MODULE_5__["GraphComponent"],
                    useExisting: Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["forwardRef"])(function () { return MicrobioGraphComponent_1; })
                }]
        }),
        __metadata("design:paramtypes", [_angular_platform_browser__WEBPACK_IMPORTED_MODULE_1__["DomSanitizer"]])
    ], MicrobioGraphComponent);
    return MicrobioGraphComponent;
}(_stepgraph_stepgraph_component__WEBPACK_IMPORTED_MODULE_6__["StepGraphComponent"]));



/***/ }),

/***/ "./src/app/graphtypes/scatterplot/scatterplot.component.ts":
/*!*****************************************************************!*\
  !*** ./src/app/graphtypes/scatterplot/scatterplot.component.ts ***!
  \*****************************************************************/
/*! exports provided: ScatterplotComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ScatterplotComponent", function() { return ScatterplotComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_platform_browser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/platform-browser */ "./node_modules/@angular/platform-browser/fesm5/platform-browser.js");
/* harmony import */ var _graph_graph_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../graph/graph.component */ "./src/app/graphtypes/graph/graph.component.ts");
/* harmony import */ var _linegraph_linegraph_component__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../linegraph/linegraph.component */ "./src/app/graphtypes/linegraph/linegraph.component.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};





var ScatterplotComponent = /** @class */ (function (_super) {
    __extends(ScatterplotComponent, _super);
    function ScatterplotComponent(sanitizer) {
        var _this = _super.call(this, sanitizer) || this;
        _this.chartType = _graph_graph_component__WEBPACK_IMPORTED_MODULE_2__["ChartType"].SCATTER;
        return _this;
    }
    ScatterplotComponent_1 = ScatterplotComponent;
    var ScatterplotComponent_1;
    ScatterplotComponent = ScatterplotComponent_1 = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Component"])({
            selector: 'app-scatterplot',
            template: __webpack_require__(/*! ../graph/graph.component.html */ "./src/app/graphtypes/graph/graph.component.html"),
            styles: [__webpack_require__(/*! ../graph.css */ "./src/app/graphtypes/graph.css")],
            providers: [{
                    provide: _graph_graph_component__WEBPACK_IMPORTED_MODULE_2__["GraphComponent"],
                    useExisting: Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["forwardRef"])(function () { return ScatterplotComponent_1; })
                }]
        }),
        __metadata("design:paramtypes", [_angular_platform_browser__WEBPACK_IMPORTED_MODULE_1__["DomSanitizer"]])
    ], ScatterplotComponent);
    return ScatterplotComponent;
}(_linegraph_linegraph_component__WEBPACK_IMPORTED_MODULE_3__["LineGraphComponent"]));



/***/ }),

/***/ "./src/app/graphtypes/stepgraph/stepgraph.component.ts":
/*!*************************************************************!*\
  !*** ./src/app/graphtypes/stepgraph/stepgraph.component.ts ***!
  \*************************************************************/
/*! exports provided: StepGraphComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "StepGraphComponent", function() { return StepGraphComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_platform_browser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/platform-browser */ "./node_modules/@angular/platform-browser/fesm5/platform-browser.js");
/* harmony import */ var color__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! color */ "./node_modules/color/index.js");
/* harmony import */ var color__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(color__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var src_app_theme_bch_colors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! src/app/theme/bch_colors */ "./src/app/theme/bch_colors.ts");
/* harmony import */ var _graph_graph_component__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../graph/graph.component */ "./src/app/graphtypes/graph/graph.component.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};





var StepGraphComponent = /** @class */ (function (_super) {
    __extends(StepGraphComponent, _super);
    function StepGraphComponent(sanitizer) {
        var _this = _super.call(this, sanitizer) || this;
        _this.sanitizer = sanitizer;
        _this.types = {};
        return _this;
    }
    StepGraphComponent_1 = StepGraphComponent;
    /**
     * @override
     */
    StepGraphComponent.prototype.generateChart = function () {
        this.adjustYAxisConfig();
        this.generateBasicChart();
        this.adjustDataDependent();
        if (!this.noDataPointsInDateRange) {
            this.chartConfiguration.grid.y = { show: true };
        }
    };
    /**
     * Adjusts the y-axis configuration for the chart.
     */
    StepGraphComponent.prototype.adjustYAxisConfig = function () {
        var _this = this;
        // Give labels to each series and make a map of
        // x-values to y-values.
        // Populate the stepgraphcard with data according to c3 format.
        for (var _i = 0, _a = this.data.series; _i < _a.length; _i++) {
            var series = _a[_i];
            var label = series.label;
            if (series.concept) {
                this.colorsMap[label] = series.concept.fill;
            }
            else {
                this.colorsMap[label] = Object(src_app_theme_bch_colors__WEBPACK_IMPORTED_MODULE_3__["getDataColors"])()[0];
            }
        }
        for (var _b = 0, _c = this.data.endpointSeries; _b < _c.length; _b++) {
            var endpointSeries = _c[_b];
            var endpointSeriesId = endpointSeries.label;
            this.data.c3DisplayConfiguration.allColumns.push(new Array('x_' + endpointSeriesId)
                .concat(endpointSeries.xValues));
            this.data.c3DisplayConfiguration.allColumns.push(new Array(endpointSeriesId)
                .concat(endpointSeries.yValues));
            this.data.c3DisplayConfiguration.columnMap[endpointSeriesId] =
                'x_' + endpointSeriesId;
            this.types[endpointSeriesId] = 'scatter';
            this.colorsMap[endpointSeriesId] = color__WEBPACK_IMPORTED_MODULE_2__["rgb"](0, 0, 0);
        }
        // The y-axis configuration for this chart maps each tick on the y-axis,
        // initially numbers, to discrete labels representing each Medication's
        // label, and sets the tick values to be those labels.
        var yValues = Array.from(this.data.yAxisMap.keys());
        // We need a slightly larger padding for step charts to be aligned with all
        // other charts.
        var stepGraphYAxisTickMax = 15;
        this.yAxisTickDisplayValues =
            yValues.map(function (value) { return _this.data.yAxisMap.get(value); });
        if (this.data.yAxisMap.size === 0) {
            this.data.yAxisMap.set(10, '');
        }
        this.yAxisConfig = {
            // We add the min and max so that when series are hidden by being clicked
            // on, the y axis does not change and the hidden medications' tick marks
            // still appear
            min: 10,
            max: yValues.sort()[yValues.length - 1],
            padding: { top: 20, bottom: 20 },
            tick: {
                // We add padding to our y-axis tick labels so that all y-axes of the
                // charts rendered on the page can be aligned.
                // We use an empty string placeholder for each label, so that the axis
                // does not get shifted over.
                format: function (d) {
                    return ''.trim().padStart(stepGraphYAxisTickMax, '\xa0');
                },
                values: Array.from(this.data.yAxisMap.keys()),
            },
        };
    };
    /**
     * Adjusts the data-dependent fields of the chart's configuration.
     */
    StepGraphComponent.prototype.adjustDataDependent = function () {
        // Check if there are any data points in the time range.
        this.noDataPointsInDateRange =
            !_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["GraphComponent"].dataPointsInRange(this.data.series, this.dateRange) &&
                !_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["GraphComponent"].dataPointsInRange(this.data.endpointSeries, this.dateRange);
        // Don't draw lines between endpoints.
        this.chartConfiguration.data.types = this.types;
    };
    var StepGraphComponent_1;
    StepGraphComponent = StepGraphComponent_1 = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Component"])({
            selector: 'app-stepgraph',
            template: __webpack_require__(/*! ../graph/graph.component.html */ "./src/app/graphtypes/graph/graph.component.html"),
            styles: [__webpack_require__(/*! ../graph.css */ "./src/app/graphtypes/graph.css")],
            providers: [
                { provide: _graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["GraphComponent"], useExisting: Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["forwardRef"])(function () { return StepGraphComponent_1; }) }
            ]
        }),
        __metadata("design:paramtypes", [_angular_platform_browser__WEBPACK_IMPORTED_MODULE_1__["DomSanitizer"]])
    ], StepGraphComponent);
    return StepGraphComponent;
}(_graph_graph_component__WEBPACK_IMPORTED_MODULE_4__["GraphComponent"]));



/***/ }),

/***/ "./src/app/graphtypes/tooltips/medication-tooltips.ts":
/*!************************************************************!*\
  !*** ./src/app/graphtypes/tooltips/medication-tooltips.ts ***!
  \************************************************************/
/*! exports provided: MedicationTooltip, MedicationAdministrationTooltip */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MedicationTooltip", function() { return MedicationTooltip; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MedicationAdministrationTooltip", function() { return MedicationAdministrationTooltip; });
/* harmony import */ var d3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! d3 */ "./node_modules/d3/index.js");
/* harmony import */ var _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../tooltips/tooltip */ "./src/app/graphtypes/tooltips/tooltip.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();


/**
 * Makes a tooltip for a medication order that lists the order's first and last
 * doses in a table.
 */
var MedicationTooltip = /** @class */ (function (_super) {
    __extends(MedicationTooltip, _super);
    function MedicationTooltip() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    MedicationTooltip.prototype.getTooltip = function (order, sanitizer) {
        var medication = order.label;
        var firstDose = _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].formatTimestamp(order.firstAdministration.timestamp);
        var lastDose = _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].formatTimestamp(order.lastAdmininistration.timestamp);
        var dosageInstruction = order.dosageInstruction;
        var table = _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].createNewTable();
        _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].addHeader(medication, table, sanitizer);
        _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].addRow(table, ['First Dose', firstDose], sanitizer);
        _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].addRow(table, ['Last Dose', lastDose], sanitizer);
        _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].addRow(table, ['Dosage Instructions', dosageInstruction], sanitizer);
        return table.outerHTML;
    };
    return MedicationTooltip;
}(_tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"]));

/**
 * Makes a tooltip for a medication administration that shows its dose
 * as well as the time since the last dose.
 */
var MedicationAdministrationTooltip = /** @class */ (function (_super) {
    __extends(MedicationAdministrationTooltip, _super);
    function MedicationAdministrationTooltip() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    MedicationAdministrationTooltip.prototype.getTooltip = function (administrations, sanitizer) {
        var timestamp = administrations[0].medAdministration.timestamp;
        var table = _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].createNewTable();
        for (var _i = 0, administrations_1 = administrations; _i < administrations_1.length; _i++) {
            var administration = administrations_1[_i];
            _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].addHeader(_tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].formatTimestamp(timestamp) + ': Dose ' +
                administration.doseInOrder + ' of ' +
                administration.medAdministration.rxNormCode.label, table, sanitizer, 3);
            _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].addRow(table, ['', 'Time', 'Dose'], sanitizer);
            _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].addRow(table, [
                'This dose',
                _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].formatTimestamp(administration.medAdministration.timestamp),
                this.formatDosage(administration.medAdministration)
            ], sanitizer);
            if (administration.previousDose) {
                var timestampDifference = administration.medAdministration.timestamp.diff(administration.previousDose.medAdministration.timestamp);
                var doseDiffText = _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].formatTimestamp(administration.previousDose.medAdministration.timestamp) +
                    '<br>(' + timestampDifference.toFormat('h:m') + ' after dose ' +
                    administration.previousDose.doseInOrder + ')';
                _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].addRow(table, [
                    'Previous dose', doseDiffText,
                    this.formatDosage(administration.previousDose.medAdministration)
                ], sanitizer);
            }
        }
        return table.outerHTML;
    };
    MedicationAdministrationTooltip.prototype.formatDosage = function (administration) {
        return d3__WEBPACK_IMPORTED_MODULE_0__["format"](',')(administration.dosage.quantity) + ' ' +
            administration.dosage.unit;
    };
    return MedicationAdministrationTooltip;
}(_tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"]));



/***/ }),

/***/ "./src/app/graphtypes/tooltips/microbio-tooltips.ts":
/*!**********************************************************!*\
  !*** ./src/app/graphtypes/tooltips/microbio-tooltips.ts ***!
  \**********************************************************/
/*! exports provided: MicrobioTooltip */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MicrobioTooltip", function() { return MicrobioTooltip; });
/* harmony import */ var src_app_fhir_data_classes_diagnostic_report__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! src/app/fhir-data-classes/diagnostic-report */ "./src/app/fhir-data-classes/diagnostic-report.ts");
/* harmony import */ var _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../tooltips/tooltip */ "./src/app/graphtypes/tooltips/tooltip.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();


/*
 * This class makes a tooltip for a DiagnosticReport that applies to all points
 * charted from the same report. It lists the time of the report, the report
 * status, as well as all results contained in the report.
 */
var MicrobioTooltip = /** @class */ (function (_super) {
    __extends(MicrobioTooltip, _super);
    function MicrobioTooltip() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    MicrobioTooltip.prototype.getTooltip = function (annotatedReport, sanitizer) {
        var status = src_app_fhir_data_classes_diagnostic_report__WEBPACK_IMPORTED_MODULE_0__["DiagnosticReportStatus"][annotatedReport.report.status];
        var results = annotatedReport.report.results;
        var timestamp = annotatedReport.timestamp;
        var table = _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].createNewTable();
        _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].addTimeHeader(timestamp, table, sanitizer);
        _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].addRow(table, ['Status', status], sanitizer);
        var spacerRow = table.insertRow();
        spacerRow.insertCell();
        _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].addHeader('Results Contained', table, sanitizer);
        for (var _i = 0, results_1 = results; _i < results_1.length; _i++) {
            var result = results_1[_i];
            _tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"].addRow(table, [result.display, result.interpretation.display], sanitizer);
        }
        return table.outerHTML;
    };
    return MicrobioTooltip;
}(_tooltips_tooltip__WEBPACK_IMPORTED_MODULE_1__["Tooltip"]));



/***/ }),

/***/ "./src/app/graphtypes/tooltips/observation-tooltips.ts":
/*!*************************************************************!*\
  !*** ./src/app/graphtypes/tooltips/observation-tooltips.ts ***!
  \*************************************************************/
/*! exports provided: DiscreteObservationTooltip, GenericAnnotatedObservationTooltip */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DiscreteObservationTooltip", function() { return DiscreteObservationTooltip; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GenericAnnotatedObservationTooltip", function() { return GenericAnnotatedObservationTooltip; });
/* harmony import */ var _tooltip__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./tooltip */ "./src/app/graphtypes/tooltips/tooltip.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();

/*
 * This class makes a tooltip for a list of Observations containing discrete, or
 * qualitative, values rather than quantitative results. The list of
 * Observations should all have the same timestamp.
 */
var DiscreteObservationTooltip = /** @class */ (function (_super) {
    __extends(DiscreteObservationTooltip, _super);
    function DiscreteObservationTooltip() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DiscreteObservationTooltip.prototype.getTooltip = function (observations, sanitizer) {
        var table = _tooltip__WEBPACK_IMPORTED_MODULE_0__["Tooltip"].createNewTable();
        _tooltip__WEBPACK_IMPORTED_MODULE_0__["Tooltip"].addTimeHeader(observations[0].timestamp, table, sanitizer);
        for (var _i = 0, observations_1 = observations; _i < observations_1.length; _i++) {
            var obs = observations_1[_i];
            _tooltip__WEBPACK_IMPORTED_MODULE_0__["Tooltip"].addRow(table, [obs.label, obs.result], sanitizer);
        }
        return table.outerHTML;
    };
    return DiscreteObservationTooltip;
}(_tooltip__WEBPACK_IMPORTED_MODULE_0__["Tooltip"]));

/**
 * Makes a generic tooltip for an AnnotatedObservation with rows for each of
 * its annotation values.
 */
var GenericAnnotatedObservationTooltip = /** @class */ (function (_super) {
    __extends(GenericAnnotatedObservationTooltip, _super);
    function GenericAnnotatedObservationTooltip(addTimestampRow, color) {
        var _this = _super.call(this) || this;
        _this.addTimestampRow = addTimestampRow;
        _this.color = color;
        return _this;
    }
    /**
     * Returns the HTML for a generic tooltip.
     * @param observation The AnnotatedObservation used to generate the tooltip
     * @param sanitizer A DOM sanitizer
     * @returns If the observation has annotations, a HTML table with the
     *     annotation values. If there are no annotations, will return undefined.
     */
    GenericAnnotatedObservationTooltip.prototype.getTooltip = function (observation, sanitizer) {
        if (observation.annotationValues.length === 0) {
            return undefined;
        }
        var table = _tooltip__WEBPACK_IMPORTED_MODULE_0__["Tooltip"].createNewTable();
        if (this.addTimestampRow) {
            _tooltip__WEBPACK_IMPORTED_MODULE_0__["Tooltip"].addTimeHeader(observation.observation.timestamp, table, sanitizer);
        }
        _tooltip__WEBPACK_IMPORTED_MODULE_0__["Tooltip"].addRow(table, [
            observation.label,
            observation.observation.value.value + ' ' +
                observation.observation.unit
        ], sanitizer, this.color);
        for (var _i = 0, _a = observation.annotationValues; _i < _a.length; _i++) {
            var annotation = _a[_i];
            _tooltip__WEBPACK_IMPORTED_MODULE_0__["Tooltip"].addRow(table, annotation, sanitizer);
        }
        return table.outerHTML;
    };
    return GenericAnnotatedObservationTooltip;
}(_tooltip__WEBPACK_IMPORTED_MODULE_0__["Tooltip"]));



/***/ }),

/***/ "./src/app/graphtypes/tooltips/tooltip.ts":
/*!************************************************!*\
  !*** ./src/app/graphtypes/tooltips/tooltip.ts ***!
  \************************************************/
/*! exports provided: Tooltip, StandardTooltip */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Tooltip", function() { return Tooltip; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "StandardTooltip", function() { return StandardTooltip; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! luxon */ "./node_modules/luxon/build/cjs-browser/luxon.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(luxon__WEBPACK_IMPORTED_MODULE_1__);
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();


/*
 * This base class contains useful helper methods used while making a custom
 * tooltip for a c3 chart, including adding a row to the table, resetting the
 * table, and adding a header.
 *
 * This is functionally a static class, but Typescript doesn't allow for
 * abstract static functions. We make all tooltip classes inherit from Tooltip
 * so that they must implement the getTooltip function.
 *
 * @param T The type of data that the tooltip is derived from.
 */
var Tooltip = /** @class */ (function () {
    function Tooltip() {
    }
    Tooltip.createNewTable = function () {
        var table = document.createElement('table');
        table.setAttribute('class', 'c3-tooltip');
        return table;
    };
    Tooltip.addTimeHeader = function (timestamp, table, sanitizer, colSpan) {
        if (colSpan === void 0) { colSpan = 2; }
        Tooltip.addHeader(Tooltip.formatTimestamp(timestamp), table, sanitizer, colSpan);
    };
    Tooltip.formatTimestamp = function (timestamp) {
        return timestamp.toLocaleString() + ' ' +
            timestamp.toLocal().toLocaleString(luxon__WEBPACK_IMPORTED_MODULE_1__["DateTime"].TIME_24_SIMPLE);
    };
    Tooltip.addHeader = function (content, table, sanitizer, colSpan) {
        if (colSpan === void 0) { colSpan = 2; }
        // Header row
        var row = table.insertRow();
        var headerCell = document.createElement('th');
        row.appendChild(headerCell);
        headerCell.colSpan = colSpan;
        headerCell.innerHTML = sanitizer.sanitize(_angular_core__WEBPACK_IMPORTED_MODULE_0__["SecurityContext"].HTML, content);
    };
    Tooltip.addRow = function (table, cellText, sanitizer, color) {
        var row = table.insertRow();
        for (var i = 0; i < cellText.length; i++) {
            var cell1 = row.insertCell();
            if (i === 0) {
                cell1.className = 'name';
                if (color) {
                    cell1.appendChild(Tooltip.makeColorSwatch(color));
                    var div = document.createElement('div');
                    div.setAttribute('style', 'display: inline-block;');
                    div.innerHTML = sanitizer.sanitize(_angular_core__WEBPACK_IMPORTED_MODULE_0__["SecurityContext"].HTML, cellText[i]);
                    cell1.appendChild(div);
                    continue;
                }
            }
            else {
                cell1.className = 'value';
            }
            cell1.innerHTML = sanitizer.sanitize(_angular_core__WEBPACK_IMPORTED_MODULE_0__["SecurityContext"].HTML, cellText[i]);
        }
    };
    Tooltip.makeColorSwatch = function (color) {
        var colorSpan = document.createElement('span');
        colorSpan.setAttribute('style', 'background-color: ' + color.toString() +
            '; display: inline-block; height: 10px; width: 10px;');
        return colorSpan;
    };
    return Tooltip;
}());

/**
 * This is a generic tooltip for a data point on the graph. It just takes in
 * the data points C3 provides to the tooltip function, then returns a table
 * with a header of the timestamp and a row for each included point.
 * The left hand side of each row is the series label. The right hand side of
 * each row is the y-value.
 */
var StandardTooltip = /** @class */ (function (_super) {
    __extends(StandardTooltip, _super);
    function StandardTooltip(dataPoints, color, unit) {
        if (unit === void 0) { unit = ''; }
        var _this = _super.call(this) || this;
        _this.dataPoints = dataPoints;
        _this.color = color;
        _this.unit = unit;
        return _this;
    }
    StandardTooltip.prototype.getTooltip = function (unused, sanitizer) {
        var table = Tooltip.createNewTable();
        Tooltip.addTimeHeader(luxon__WEBPACK_IMPORTED_MODULE_1__["DateTime"].fromJSDate(new Date(this.dataPoints[0].x)), table, sanitizer);
        for (var _i = 0, _a = this.dataPoints; _i < _a.length; _i++) {
            var pt = _a[_i];
            Tooltip.addRow(table, [pt.name, pt.value + ' ' + this.unit], sanitizer, this.color(pt));
        }
        return table.outerHTML;
    };
    return StandardTooltip;
}(Tooltip));



/***/ }),

/***/ "./src/app/help-dialog/help-dialog.component.css":
/*!*******************************************************!*\
  !*** ./src/app/help-dialog/help-dialog.component.css ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = ".stepContent {\n  margin-bottom: 30px;\n  margin-top: 10px;\n  font-size: 20px;\n}\n\n::ng-deep .mat-horizontal-content-container {\n  padding-bottom: 0px !important;\n}\n\n.stepperButtons {\n  float: right;\n}\n\n.stepperButtons button {\n  margin-right: 5px;\n}\n\n::ng-deep .mat-dialog-container {\n  max-height: -webkit-fill-available !important;\n}\n\nimg {\n  width: 100%;\n}\n\n.divider {\n  margin-bottom: 20px;\n  margin-top: 10px;\n  border-top-width: 5px !important;\n}"

/***/ }),

/***/ "./src/app/help-dialog/help-dialog.component.html":
/*!********************************************************!*\
  !*** ./src/app/help-dialog/help-dialog.component.html ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<div style=\"float: right;\" mat-dialog-actions>\n  <button mat-icon-button (click)=\"onExit()\">\n    <mat-icon color=\"primary\">close</mat-icon>\n  </button>\n</div>\n<mat-horizontal-stepper [linear]=\"false\" #stepper>\n  <!-- keep icons as numbers during edit-->\n  <ng-template matStepperIcon=\"edit\" let-index=\"index\">\n    {{index +1}}\n  </ng-template>\n  <mat-step label=\"Intro\">\n    <div class=\"stepContent\">\n      MedTimeLine intro screen\n    </div>\n    <div class=\"stepperButtons\">\n      <button mat-stroked-button matStepperNext>Next</button>\n    </div>\n  </mat-step>\n\n  <mat-step label=\"Changing the dates\">\n    <div class=\"stepContent\">\n      <div>\n        <div>\n          Change the dates of the data displayed on the chart using datepickers.\n        </div>\n        <img src=\"assets/images/datepicker1.png\">\n      </div>\n      <mat-divider class=\"divider\"></mat-divider>\n      <div>\n        <div>\n          Click on the datepicker icon to open a calendar.\n        </div>\n        <img src=\"assets/images/datepicker2.gif\">\n      </div>\n      <mat-divider class=\"divider\"></mat-divider>\n    </div>\n    <div class=\"stepperButtons\">\n      <button mat-stroked-button matStepperPrevious>Back</button>\n      <button mat-stroked-button matStepperNext>Next</button>\n    </div>\n  </mat-step>\n\n  <mat-step label=\"Custom TimeLine\">\n    <div class=\"stepContent\">\n      <div>\n        The Timeline feature allows you to enter custom events.\n      </div>\n      <div>\n        <div>\n          Click anywhere on the timeline to add an event.\n        </div>\n        <img src=\"assets/images/customTimeline1.gif\">\n      </div>\n      <mat-divider class=\"divider\"></mat-divider>\n      <div>\n        <div>\n          By default, descriptions for events are hidden. Click on the expander to reveal the description.\n        </div>\n        <img src=\"assets/images/customTimeline2.gif\">\n      </div>\n      <mat-divider class=\"divider\"></mat-divider>\n      <div>\n        <div>\n          Click on the pencil icon to edit the event.\n        </div>\n        <img src=\"assets/images/customTimeline3.gif\">\n      </div>\n      <mat-divider class=\"divider\"></mat-divider>\n      <div>\n        <div>\n          Click on the trashcan icon to delete the event.\n        </div>\n        <img src=\"assets/images/customTimeline4.gif\">\n      </div>\n      <mat-divider class=\"divider\"></mat-divider>\n    </div>\n    <div class=\"stepperButtons\">\n      <button mat-stroked-button matStepperPrevious>Back</button>\n      <button mat-stroked-button matStepperNext>Next</button>\n    </div>\n  </mat-step>\n\n  <mat-step label=\"Charts\">\n    <div class=\"stepContent\">\n      <div>\n        <div>\n          For charts with legends, hover over a series to highlight that series on the chart. Click on a series to hide\n          it from the chart.\n        </div>\n        <img src=\"assets/images/chartUpClose1.gif\">\n      </div>\n      <mat-divider class=\"divider\"></mat-divider>\n      <div>\n        <div>\n          The green highlighted area on some charts represents a \"normal range\" indicated in the standard.\n        </div>\n        <img src=\"assets/images/chartUpClose2.png\">\n      </div>\n      <mat-divider class=\"divider\"></mat-divider>\n    </div>\n    <div class=\"stepperButtons\">\n      <button mat-stroked-button matStepperPrevious>Back</button>\n      <button mat-stroked-button matStepperNext>Next</button>\n    </div>\n  </mat-step>\n\n  <mat-step label=\"Card Container\">\n    <div class=\"stepContent\">\n      <div>\n        The card container displays all charts selected.\n      </div>\n      <div>\n        <div>\n          Click and drag a chart to rearrange on the page.\n        </div>\n        <img src=\"assets/images/cardContainer1.gif\">\n      </div>\n      <mat-divider class=\"divider\"></mat-divider>\n      <div>\n        <div>\n          Click on the trashcan icon to remove a card from the page. Press \"Undo\" at the bottom of the page to restore.\n        </div>\n        <img src=\"assets/images/cardContainer2.gif\">\n      </div>\n      <mat-divider class=\"divider\"></mat-divider>\n      <div>\n        <div>\n          You can add cards to the top of the page using the toolbar.\n        </div>\n        <img src=\"assets/images/cardContainer3.gif\">\n      </div>\n      <mat-divider class=\"divider\"></mat-divider>\n    </div>\n    <div class=\"stepperButtons\">\n      <button mat-stroked-button matStepperPrevious>Back</button>\n      <button mat-stroked-button matStepperNext>Next</button>\n    </div>\n  </mat-step>\n\n  <mat-step label=\"Save Snapshot\">\n    <div class=\"stepContent\">\n      <div>\n        <div>\n          The \"Save Snapshot\" button allows you to save a static image of the current page to the patient record.\n        </div>\n        <img src=\"assets/images/saveSnapshot.gif\">\n      </div>\n    </div>\n    <div class=\"stepperButtons\">\n      <button mat-stroked-button matStepperPrevious>Back</button>\n      <button mat-stroked-button (click)=\"onExit()\">Close</button>\n    </div>\n  </mat-step>\n</mat-horizontal-stepper>"

/***/ }),

/***/ "./src/app/help-dialog/help-dialog.component.ts":
/*!******************************************************!*\
  !*** ./src/app/help-dialog/help-dialog.component.ts ***!
  \******************************************************/
/*! exports provided: HelpDialogComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HelpDialogComponent", function() { return HelpDialogComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_material__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/material */ "./node_modules/@angular/material/esm5/material.es5.js");
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};


var HelpDialogComponent = /** @class */ (function () {
    function HelpDialogComponent(dialogRef) {
        this.dialogRef = dialogRef;
    }
    HelpDialogComponent.prototype.onExit = function () {
        this.dialogRef.close();
    };
    HelpDialogComponent = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Component"])({
            selector: 'app-help-dialog',
            template: __webpack_require__(/*! ./help-dialog.component.html */ "./src/app/help-dialog/help-dialog.component.html"),
            styles: [__webpack_require__(/*! ./help-dialog.component.css */ "./src/app/help-dialog/help-dialog.component.css")]
        })
        /**
         * This class holds the logic and template for a tutorial stepper dialog.
         * TODO(b/122670756): Change wording and pictures in the tutorial.
         */
        ,
        __metadata("design:paramtypes", [_angular_material__WEBPACK_IMPORTED_MODULE_1__["MatDialogRef"]])
    ], HelpDialogComponent);
    return HelpDialogComponent;
}());



/***/ }),

/***/ "./src/app/mock-fhir.service.ts":
/*!**************************************!*\
  !*** ./src/app/mock-fhir.service.ts ***!
  \**************************************/
/*! exports provided: MockFhirService */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MockFhirService", function() { return MockFhirService; });
/* harmony import */ var _angular_common_http__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/common/http */ "./node_modules/@angular/common/fesm5/http.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var src_constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! src/constants */ "./src/constants.ts");
/* harmony import */ var _environments_environment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../environments/environment */ "./src/environments/environment.ts");
/* harmony import */ var _fhir_data_classes_diagnostic_report__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./fhir-data-classes/diagnostic-report */ "./src/app/fhir-data-classes/diagnostic-report.ts");
/* harmony import */ var _fhir_data_classes_encounter__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./fhir-data-classes/encounter */ "./src/app/fhir-data-classes/encounter.ts");
/* harmony import */ var _fhir_data_classes_medication_administration__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./fhir-data-classes/medication-administration */ "./src/app/fhir-data-classes/medication-administration.ts");
/* harmony import */ var _fhir_data_classes_medication_order__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./fhir-data-classes/medication-order */ "./src/app/fhir-data-classes/medication-order.ts");
/* harmony import */ var _fhir_data_classes_observation__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./fhir-data-classes/observation */ "./src/app/fhir-data-classes/observation.ts");
/* harmony import */ var _fhir_service__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./fhir.service */ "./src/app/fhir.service.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};










var MockFhirService = /** @class */ (function (_super) {
    __extends(MockFhirService, _super);
    function MockFhirService(http) {
        var _this = _super.call(this) || this;
        _this.http = http;
        _this.assetPath = './assets/' + _environments_environment__WEBPACK_IMPORTED_MODULE_3__["environment"].mockDataFolder + '/';
        _this.allFilePaths = _environments_environment__WEBPACK_IMPORTED_MODULE_3__["environment"].mockDataFiles.map(function (x) { return _this.assetPath + x + '.json'; });
        _this.loincMap = new Map();
        _this.medicationAdministrationMapByCode = new Map();
        _this.medicationAdministrationMapByOrderId = new Map();
        _this.medicationOrderMap = new Map();
        _this.diagnosticReportMap = new Map();
        _this.encounters = new Array();
        _this.allDataPromise = _this.mapAllData();
        return _this;
    }
    MockFhirService.prototype.constructResourceMap = function (json, mapToUpdate, constructorFn, getCodesFn) {
        try {
            var obj = constructorFn(json.resource);
            var uniqueCodes = Array.from(new Set(getCodesFn(obj)));
            for (var _i = 0, uniqueCodes_1 = uniqueCodes; _i < uniqueCodes_1.length; _i++) {
                var code = uniqueCodes_1[_i];
                var existing = mapToUpdate.get(code);
                if (!existing) {
                    existing = [];
                }
                existing.push(obj);
                mapToUpdate.set(code, existing);
            }
        }
        catch (err) {
            // tslint:disable-next-line:no-console
            console.debug(err);
        }
    };
    MockFhirService.prototype.mapAllData = function () {
        var _this = this;
        return Promise.all(this.allFilePaths.map(function (filePath) {
            return _this.http.get(filePath).toPromise().then(function (data) {
                for (var _i = 0, _a = data.entry; _i < _a.length; _i++) {
                    var json = _a[_i];
                    var resourceType = json.resource.resourceType;
                    if (resourceType === src_constants__WEBPACK_IMPORTED_MODULE_2__["FhirResourceType"].Observation) {
                        _this.constructResourceMap(json, _this.loincMap, function (x) { return new _fhir_data_classes_observation__WEBPACK_IMPORTED_MODULE_8__["Observation"](x); }, function (obs) { return obs.codes; });
                    }
                    if (resourceType === src_constants__WEBPACK_IMPORTED_MODULE_2__["FhirResourceType"].MedicationAdministration) {
                        _this.constructResourceMap(json, _this.medicationAdministrationMapByCode, function (d) { return new _fhir_data_classes_medication_administration__WEBPACK_IMPORTED_MODULE_6__["MedicationAdministration"](d); }, function (admin) { return [admin.rxNormCode]; });
                        _this.constructResourceMap(json, _this.medicationAdministrationMapByOrderId, function (d) { return new _fhir_data_classes_medication_administration__WEBPACK_IMPORTED_MODULE_6__["MedicationAdministration"](d); }, function (admin) { return [admin.medicationOrderId]; });
                    }
                    if (resourceType === src_constants__WEBPACK_IMPORTED_MODULE_2__["FhirResourceType"].MedicationOrder) {
                        _this.constructResourceMap(json, _this.medicationOrderMap, function (d) { return new _fhir_data_classes_medication_order__WEBPACK_IMPORTED_MODULE_7__["MedicationOrder"](d); }, function (order) { return [order.orderId]; });
                    }
                    if (resourceType === src_constants__WEBPACK_IMPORTED_MODULE_2__["FhirResourceType"].Encounter) {
                        var encounter = new _fhir_data_classes_encounter__WEBPACK_IMPORTED_MODULE_5__["Encounter"](json.resource);
                        _this.encounters.push(encounter);
                    }
                    if (resourceType === src_constants__WEBPACK_IMPORTED_MODULE_2__["FhirResourceType"].DiagnosticReport) {
                        _this.constructResourceMap(json, _this.diagnosticReportMap, function (d) { return new _fhir_data_classes_diagnostic_report__WEBPACK_IMPORTED_MODULE_4__["DiagnosticReport"](d); }, function (report) {
                            return report.results.map(function (x) { return x.codes; })
                                .reduce(function (prev, curr) {
                                return prev.concat(curr);
                            }, []);
                        });
                    }
                }
            });
        }));
    };
    /**
     * Gets observations from a specified date range with a specific LOINC code.
     * @param code The LOINC code for which to get observations.
     * @param dateRange The time interval observations should fall between.
     * @param limitCount If set, the number of observations that should be
     *     queried for
     */
    MockFhirService.prototype.getObservationsWithCode = function (code, dateRange, limitCount) {
        var _this = this;
        return this.allDataPromise.then(function (map) {
            return _this.getObservations(_this.loincMap, code, dateRange, limitCount);
        });
    };
    MockFhirService.prototype.getObservations = function (map, code, dateRange, limitCount) {
        if (limitCount === void 0) { limitCount = 0; }
        return map.has(code) ?
            map.get(code)
                .filter(function (obs) { return dateRange.contains(obs.timestamp); })
                .filter(function (obs) { return obs.status !== _fhir_data_classes_observation__WEBPACK_IMPORTED_MODULE_8__["ObservationStatus"].EnteredInError; })
                .slice(0, limitCount ? limitCount : undefined) :
            [];
    };
    /**
     * Gets medication data from a specified date range with a specific Rx code
     * @param code The RxNormCode codes for which to get observations.
     * @param dateRange The time interval observations should fall between.
     * @param limitCount Unused in this implementation, as this is just a
     *     time-saving feature for HTTP calls.
     */
    MockFhirService.prototype.getMedicationAdministrationsWithCode = function (code, dateRange, limitCount) {
        var _this = this;
        return this.allDataPromise.then(function (x) { return _this.medicationAdministrationMapByCode.has(code) ?
            _this.medicationAdministrationMapByCode.get(code)
                .filter(function (obs) { return dateRange.contains(obs.timestamp); })
                .slice(0, limitCount ? limitCount : undefined) :
            []; });
    };
    /**
     * Returns arbitrary orders for current mock medications.
     * @param id The id to pull the order from.
     * TODO(b/117438708): Add more mock medication orders to JSON files for
     * different medications requested.
     */
    MockFhirService.prototype.getMedicationOrderWithId = function (id) {
        var _this = this;
        return this.allDataPromise.then(function (x) { return _this.medicationOrderMap.has(id) ?
            _this.medicationOrderMap.get(id)[0] :
            undefined; });
    };
    /**
     * Gets administrations for specified order id.
     * @param id The id to pull the order from.
     */
    MockFhirService.prototype.getMedicationAdministrationsWithOrder = function (id) {
        var _this = this;
        return this.allDataPromise.then(function (x) { return _this.medicationAdministrationMapByOrderId.get(id); });
    };
    /**
     * Gets the encounters for the patient for any encounter that falls in the
     * given date range.
     * @param dateRange Return all encounters that covered any time in this
     *   date range.
     */
    MockFhirService.prototype.getEncountersForPatient = function (dateRange) {
        var _this = this;
        return this.allDataPromise.then(function (x) { return _this.encounters.filter(function (encounter) { return dateRange.intersection(encounter.period) !== null; }); });
    };
    /**
     * Prints the current HTML of the graphs rendered to the console.
     * @param html The inner HTML to keep in the Document.
     * @param date The date the note was written for.
     */
    MockFhirService.prototype.saveStaticNote = function (html, date) {
        console.log('Save to note button clicked for mock data for date: ' + date);
        console.log(html);
    };
    /**
     * Gets the DiagnosticReports for the patient for any report that falls in
     * the given date range, whose contained Observations are in the codeGroup
     * provided.
     * @param codeGroup The CodeGroup to retrieve DiagnosticReports for.
     * @param dateRange Return all DiagnosticReports that covered any time in
     *     this date range.
     */
    MockFhirService.prototype.getDiagnosticReports = function (codeGroup, dateRange, limitCount) {
        var _this = this;
        return this.allDataPromise.then(function (x) {
            var reports = new Array();
            for (var _i = 0, _a = codeGroup.resourceCodes; _i < _a.length; _i++) {
                var code = _a[_i];
                if (_this.diagnosticReportMap.has(code)) {
                    reports = reports.concat(_this.diagnosticReportMap.get(code));
                }
            }
            reports
                .filter(function (report) { return report.specimens.map(function (s) { return s.type; })
                .find(function (specimen) { return specimen === codeGroup.label; }) !==
                undefined; })
                .slice(0, limitCount ? limitCount : undefined);
            return reports;
        });
    };
    MockFhirService = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])(),
        __metadata("design:paramtypes", [_angular_common_http__WEBPACK_IMPORTED_MODULE_0__["HttpClient"]])
    ], MockFhirService);
    return MockFhirService;
}(_fhir_service__WEBPACK_IMPORTED_MODULE_9__["FhirService"]));



/***/ }),

/***/ "./src/app/setup-data.service.ts":
/*!***************************************!*\
  !*** ./src/app/setup-data.service.ts ***!
  \***************************************/
/*! exports provided: SetupDataService */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SetupDataService", function() { return SetupDataService; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};

var SetupDataService = /** @class */ (function () {
    // This class is a service that communicates the user-selected concepts on the
    // configuration page (SetupComponent) to CardContainerComponent.
    function SetupDataService() {
    }
    SetupDataService = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Injectable"])({ providedIn: 'root' })
        // This class is a service that communicates the user-selected concepts on the
        // configuration page (SetupComponent) to CardContainerComponent.
    ], SetupDataService);
    return SetupDataService;
}());



/***/ }),

/***/ "./src/app/setup/setup.component.css":
/*!*******************************************!*\
  !*** ./src/app/setup/setup.component.css ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = ".title {\n  font-family: 'Quicksand', sans-serif;\n}\n\n.mat-stroked-button {\n  font-family: 'Quicksand', sans-serif;\n}\n\n.mat-raised-button {\n  font-family: 'Quicksand', sans-serif;\n}\n\n.actions {\n  margin-left: auto;\n  padding: 20px;\n}\n\nbutton {\n  margin-right: 10px;\n}\n\n.description {\n  font-family: 'Quicksand', sans-serif;\n}\n\n.mat-dialog-title {\n  margin-bottom: 0px;\n}\n\n.category {\n  font-family: 'Quicksand', sans-serif;\n  margin-top: 10px;\n}\n\nmat-icon {\n  padding-top: 20px;\n  vertical-align: bottom;\n}\n\n.mainSetup {\n  width: 100%;\n  padding-top: 20px;\n  padding-left: 40px;\n  color: white;\n  height: 100%;\n  background-color:#002356; /* PRIMARY_COLOR */\n}\n\n::ng-deep app-setup .mat-form-field-empty.mat-form-field-label {\n  color: white;\n}\n\n::ng-deep app-setup .mat-form-field-label {\n  color:white !important;\n}\n\n::ng-deep app-setup .mat-form-field-underline {\n  background-color: white !important;\n}\n\n::ng-deep app-setup .mat-form-field.mat-focused .mat-form-field-ripple {\n  background-color: white !important;\n}\n\n::ng-deep app-setup .mat-form-field-underline {\n  background-color: white !important;\n}\n\napp-setup .mat-input-placeholder {\n  color: white;\n}\n\n.mat-toolbar {\n  background-color: #00002d; /* PRIMARY_COLOR, dark variant */\n}\n\n::ng-deep  app-setup .mat-form-field-wrapper {\n  color: white;\n}\n\n::ng-deep app-setup .mat-checkbox-frame {\n  border-color: white;\n}\n\n.noResults {\n  font-family: \"Roboto\", sans-serif;\n}"

/***/ }),

/***/ "./src/app/setup/setup.component.html":
/*!********************************************!*\
  !*** ./src/app/setup/setup.component.html ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<mat-toolbar color=\"primary\" class=\"toolbar\">\n  <h1 class=\"title\">Select Initial Configuration</h1>\n  <div class=\"actions\">\n    <button mat-raised-button (click)=\"onContinue()\" cdkFocusInitial id=\"continue\">\n      Continue\n    </button>\n  </div>\n</mat-toolbar>\n<div *ngIf=\"useDebugger\">\n  <app-debugger></app-debugger>\n</div>\n<div class=\"mainSetup\">\n  <div class=\"checkboxActions\">\n    <button mat-raised-button (click)=\"selectAll()\" id=\"continue\">\n      Select All\n    </button>\n    <button mat-raised-button (click)=\"clearAll()\" id=\"continue\">\n      Clear Selection\n    </button>\n  </div>\n  <form class=\"conceptForm\">\n    <mat-form-field class=\"conceptFormField\">\n      <input matInput placeholder=\"Search for a concept\" aria-label=\"Search for a concept\" [formControl]=\"conceptCtrl\">\n      <mat-icon matPrefix>search</mat-icon>\n    </mat-form-field>\n    <div *ngFor=\"let entry of displayGroupingOptions | async\">\n      <div class=\"category\" [style.color]=\"entry[0].fill.hsl().string()\">\n        {{entry[0].label}}\n      </div>\n      <div *ngFor=\"let element of entry[1].sort(sortResources)\">\n        <mat-checkbox [(ngModel)]=\"checkedConcepts[element.label]\" [ngModelOptions]=\"{standalone: true}\">\n          {{element.label}}\n        </mat-checkbox>\n      </div>\n    </div>\n    <div *ngIf=\"(displayGroupingOptions | async).length === 0\" class=\"noResults\">\n      No results found\n    </div>\n  </form>\n</div>\n"

/***/ }),

/***/ "./src/app/setup/setup.component.ts":
/*!******************************************!*\
  !*** ./src/app/setup/setup.component.ts ***!
  \******************************************/
/*! exports provided: SetupComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SetupComponent", function() { return SetupComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_forms__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/forms */ "./node_modules/@angular/forms/fesm5/forms.js");
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/router */ "./node_modules/@angular/router/fesm5/router.js");
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs/operators */ "./node_modules/rxjs/_esm5/operators/index.js");
/* harmony import */ var _environments_environment__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../environments/environment */ "./src/environments/environment.ts");
/* harmony import */ var _clinicalconcepts_resource_code_manager__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../clinicalconcepts/resource-code-manager */ "./src/app/clinicalconcepts/resource-code-manager.ts");
/* harmony import */ var _setup_data_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../setup-data.service */ "./src/app/setup-data.service.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};







var SetupComponent = /** @class */ (function () {
    function SetupComponent(resourceCodeManager, route, router, setupDataService) {
        this.route = route;
        this.router = router;
        this.setupDataService = setupDataService;
        this.allConcepts = [];
        this.checkedConcepts = new Map();
        this.chosenConcepts = [];
        this.useDebugger = _environments_environment__WEBPACK_IMPORTED_MODULE_4__["environment"].useDebugger;
        /**
         * This FormControl monitors changes in the user input typed in the
         * autocomplete.
         */
        this.conceptCtrl = new _angular_forms__WEBPACK_IMPORTED_MODULE_1__["FormControl"]();
        this.sortResources = (function (a, b) {
            return a.label.localeCompare(b.label);
        });
        var displayGroups = resourceCodeManager.getDisplayGroupMapping();
        /* Load in the concepts to display, flattening them all into a
         * single-depth array. */
        this.allConcepts = Array.from(displayGroups.values())
            .reduce(function (acc, val) { return acc.concat(val); }, []);
        this.displayGroupings = Array.from(displayGroups.entries());
        for (var _i = 0, _a = this.allConcepts; _i < _a.length; _i++) {
            var concept = _a[_i];
            this.checkedConcepts[concept.label] = false;
            var showByDefault = concept.resourceCodeGroups.some(function (x) { return x.showByDefault; });
            if (showByDefault) {
                this.checkedConcepts[concept.label] = true;
            }
        }
        console.warn(_environments_environment__WEBPACK_IMPORTED_MODULE_4__["environment"].useDebugger);
    }
    SetupComponent.prototype.ngOnInit = function () {
        var _this = this;
        // Watch for changes to the user input on the autocomplete panel.
        this.displayGroupingOptions = this.conceptCtrl.valueChanges.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["startWith"])(''), // The autocomplete input starts with nothing typed in.
        Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(function (concept) { return concept ? _this.filter(concept) :
            _this.displayGroupings.slice(); }));
    };
    SetupComponent.prototype.ngOnDestroy = function () {
        this.setupDataService.selectedConcepts = this.chosenConcepts;
    };
    /**
     * The user wishes to continue to the main screen of MedTimeLine, with all
     * charts selected.
     */
    SetupComponent.prototype.onContinue = function () {
        for (var _i = 0, _a = this.allConcepts; _i < _a.length; _i++) {
            var concept = _a[_i];
            if (this.checkedConcepts[concept.label]) {
                this.chosenConcepts.push(concept);
            }
        }
        this.router.navigate(['/main'], { skipLocationChange: true });
    };
    /**
     * The user wishes to select all concepts.
     */
    SetupComponent.prototype.selectAll = function () {
        for (var _i = 0, _a = this.allConcepts; _i < _a.length; _i++) {
            var concept = _a[_i];
            this.checkedConcepts[concept.label] = true;
        }
    };
    /**
     * The user wishes to clear all select concepts.
     */
    SetupComponent.prototype.clearAll = function () {
        for (var _i = 0, _a = this.allConcepts; _i < _a.length; _i++) {
            var concept = _a[_i];
            this.checkedConcepts[concept.label] = false;
        }
    };
    /**
     * Filter the concepts shown on the autocomplete menu.
     */
    SetupComponent.prototype.filter = function (concept) {
        return this.displayGroupings
            .filter(function (entry) { return entry[1].some(function (codes) { return codes.label.toLowerCase().indexOf(concept.toLowerCase()) === 0; }); })
            .map(function (entry) {
            var displayGrouping = entry[0];
            var resourceCodesFiltered = entry[1].filter(function (codes) { return codes.label.toLowerCase().indexOf(concept.toLowerCase()) === 0; });
            return [displayGrouping, resourceCodesFiltered];
        });
    };
    SetupComponent = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Component"])({
            selector: 'app-setup',
            template: __webpack_require__(/*! ./setup.component.html */ "./src/app/setup/setup.component.html"),
            styles: [__webpack_require__(/*! ./setup.component.css */ "./src/app/setup/setup.component.css")]
        })
        // This class contains the intial configuration options for the MedTimeLine.
        // Users can choose which concepts to display, or pick the default
        // configuration.
        ,
        __metadata("design:paramtypes", [_clinicalconcepts_resource_code_manager__WEBPACK_IMPORTED_MODULE_5__["ResourceCodeManager"], _angular_router__WEBPACK_IMPORTED_MODULE_2__["ActivatedRoute"],
            _angular_router__WEBPACK_IMPORTED_MODULE_2__["Router"], _setup_data_service__WEBPACK_IMPORTED_MODULE_6__["SetupDataService"]])
    ], SetupComponent);
    return SetupComponent;
}());



/***/ }),

/***/ "./src/app/smart-on-fhir-client.ts":
/*!*****************************************!*\
  !*** ./src/app/smart-on-fhir-client.ts ***!
  \*****************************************/
/*! exports provided: SMART_ON_FHIR_CLIENT */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SMART_ON_FHIR_CLIENT", function() { return SMART_ON_FHIR_CLIENT; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

var SMART_ON_FHIR_CLIENT = new _angular_core__WEBPACK_IMPORTED_MODULE_0__["InjectionToken"]('SmartOnFhirClient');


/***/ }),

/***/ "./src/app/theme/bch_colors.ts":
/*!*************************************!*\
  !*** ./src/app/theme/bch_colors.ts ***!
  \*************************************/
/*! exports provided: PRIMARY_COLOR, SECONDARY_COLOR, MATERIAL_GREEN, MATERIAL_YELLOW, MATERIAL_TEAL, MATERIAL_ORANGE, BOSTON_BLUE, BOSTON_SKY, BOSTON_YELLOW, BOSTON_GREEN, BOSTON_INDIGO, BOSTON_BAY, BOSTON_PINK, BOSTON_LAVENDER, BOSTON_PURPLE, BOSTON_MORNING, BOSTON_MEADOW, BOSTON_WARM_GRAY, BOSTON_RED, SELECTED, getDataColors */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PRIMARY_COLOR", function() { return PRIMARY_COLOR; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SECONDARY_COLOR", function() { return SECONDARY_COLOR; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MATERIAL_GREEN", function() { return MATERIAL_GREEN; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MATERIAL_YELLOW", function() { return MATERIAL_YELLOW; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MATERIAL_TEAL", function() { return MATERIAL_TEAL; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MATERIAL_ORANGE", function() { return MATERIAL_ORANGE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BOSTON_BLUE", function() { return BOSTON_BLUE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BOSTON_SKY", function() { return BOSTON_SKY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BOSTON_YELLOW", function() { return BOSTON_YELLOW; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BOSTON_GREEN", function() { return BOSTON_GREEN; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BOSTON_INDIGO", function() { return BOSTON_INDIGO; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BOSTON_BAY", function() { return BOSTON_BAY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BOSTON_PINK", function() { return BOSTON_PINK; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BOSTON_LAVENDER", function() { return BOSTON_LAVENDER; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BOSTON_PURPLE", function() { return BOSTON_PURPLE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BOSTON_MORNING", function() { return BOSTON_MORNING; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BOSTON_MEADOW", function() { return BOSTON_MEADOW; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BOSTON_WARM_GRAY", function() { return BOSTON_WARM_GRAY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BOSTON_RED", function() { return BOSTON_RED; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SELECTED", function() { return SELECTED; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getDataColors", function() { return getDataColors; });
/* harmony import */ var color__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! color */ "./node_modules/color/index.js");
/* harmony import */ var color__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(color__WEBPACK_IMPORTED_MODULE_0__);
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

/**
 * Encodings of the colors for BCH branding.
 * http://www.childrenshospital.org/legal/brand-style-guidelines
 */
// Material Colors
var PRIMARY_COLOR = color__WEBPACK_IMPORTED_MODULE_0__["rgb"](0, 35, 86);
var SECONDARY_COLOR = color__WEBPACK_IMPORTED_MODULE_0__["rgb"](179, 157, 219);
var MATERIAL_GREEN = color__WEBPACK_IMPORTED_MODULE_0__["rgb"](102, 187, 106);
var MATERIAL_YELLOW = color__WEBPACK_IMPORTED_MODULE_0__["rgb"](253, 216, 53);
var MATERIAL_TEAL = color__WEBPACK_IMPORTED_MODULE_0__["rgb"](38, 166, 154);
var MATERIAL_ORANGE = color__WEBPACK_IMPORTED_MODULE_0__["rgb"](255, 112, 67);
// Core brand colors
var BOSTON_BLUE = color__WEBPACK_IMPORTED_MODULE_0__["rgb"](0, 48, 135);
var BOSTON_SKY = color__WEBPACK_IMPORTED_MODULE_0__["rgb"](65, 182, 230);
// Brand colors
var BOSTON_YELLOW = color__WEBPACK_IMPORTED_MODULE_0__["rgb"](242, 169, 0);
var BOSTON_GREEN = color__WEBPACK_IMPORTED_MODULE_0__["rgb"](115, 150, 0);
var BOSTON_INDIGO = color__WEBPACK_IMPORTED_MODULE_0__["rgb"](0, 115, 150);
var BOSTON_BAY = color__WEBPACK_IMPORTED_MODULE_0__["rgb"](110, 124, 160);
var BOSTON_PINK = color__WEBPACK_IMPORTED_MODULE_0__["rgb"](198, 87, 154);
var BOSTON_LAVENDER = color__WEBPACK_IMPORTED_MODULE_0__["rgb"](140, 71, 153);
var BOSTON_PURPLE = color__WEBPACK_IMPORTED_MODULE_0__["rgb"](128, 34, 95);
// Complimentary brand colors
var BOSTON_MORNING = color__WEBPACK_IMPORTED_MODULE_0__["rgb"](251, 219, 101);
var BOSTON_MEADOW = color__WEBPACK_IMPORTED_MODULE_0__["rgb"](164, 214, 94);
var BOSTON_WARM_GRAY = color__WEBPACK_IMPORTED_MODULE_0__["rgb"](197, 185, 172);
// Auxiliary color (only used for emergency, blood, or stop)
var BOSTON_RED = color__WEBPACK_IMPORTED_MODULE_0__["rgb"](246, 50, 62);
// Color to indicate a selected item.
// Material-light version of secondary color.
var SELECTED = color__WEBPACK_IMPORTED_MODULE_0__('#d9ceed');
// Rules for which text colors can be used for which backgrounds
var DO_NOT_USE_WHITE_TYPE = [BOSTON_YELLOW, BOSTON_MORNING, color__WEBPACK_IMPORTED_MODULE_0__["WHITE"]];
var DO_NOT_USE_BLACK_TYPE = [BOSTON_BLUE, BOSTON_PURPLE];
var CAN_USE_BOSTON_BLUE_TYPE = [BOSTON_SKY, color__WEBPACK_IMPORTED_MODULE_0__["WHITE"], BOSTON_MORNING, BOSTON_MEADOW, BOSTON_WARM_GRAY];
var CAN_USE_BOSTON_SKY_TYPE = [BOSTON_BLUE];
/**
 * Returns all the colors that are acceptable for data points to be plotted in.
 */
function getDataColors() {
    return [
        BOSTON_BLUE, BOSTON_YELLOW, BOSTON_GREEN, BOSTON_PINK, BOSTON_PURPLE,
        BOSTON_INDIGO
    ];
}


/***/ }),

/***/ "./src/app/timeline-controller/timeline-controller.component.css":
/*!***********************************************************************!*\
  !*** ./src/app/timeline-controller/timeline-controller.component.css ***!
  \***********************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = ".datePicker {\n  background-color: white;\n  padding-top: 20px;\n}\n\n.mat-form-field {\n  width: 40%;\n  margin-right: 5%;\n  margin-left: 5%;\n}\n\n::ng-deep .mat-h2 {\n  margin-bottom: 0px !important;\n}\n\n/* Remove extra padding below the button. */\n\n::ng-deep .mat-mini-fab .mat-button-wrapper {\n  padding: 0px !important;\n}\n\n::ng-deep .mat-h2 {\n  margin-bottom: 0px !important;\n}\n\n::ng-deep td.available{\n  color: black;\n}\n\n::ng-deep td.notInEncounter {\n  color: grey !important;\n  opacity: .5;\n  text-decoration: line-through;\n}\n\n::ng-deep td.inEncounter {\n  color: rgb(0, 35, 86) !important;\n  background-color: #e5f3ec;\n}\n\n::ng-deep td.active.available.inEncounter {\n  color: white !important;\n}\n\ninput {\n  font-family: 'Quicksand', sans-serif;\n}\n\n/* Change colors of ngx-datepicker to match custom material theme */\n\n::ng-deep .ranges button.active {\n  background-color: rgb(0, 35, 86) !important; /* Primary color */\n}\n\n::ng-deep .md-drppicker .btn {\n  background-color: rgb(0, 35, 86) !important; /* Primary color */\n}\n\n::ng-deep td.active.available {\n  background-color: rgb(0, 35, 86) !important; /* Primary color */\n}\n\n.errorIcon {\n  width: 40px;\n  height: 40px;\n  line-height: 40px;\n  cursor: default;\n}"

/***/ }),

/***/ "./src/app/timeline-controller/timeline-controller.component.html":
/*!************************************************************************!*\
  !*** ./src/app/timeline-controller/timeline-controller.component.html ***!
  \************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<div class=\"datePicker\" fxLayout=\"row\" fxLayoutGap=\"10px\" class=\"mat-h2\">\n  <input type=\"button\" class=\"mat-raised-button\" ngxDaterangepickerMd [(ngModel)]=\"selected\"\n    [minDate]=\"earliestAvailableDate\" [maxDate]=\"latestAvailableDate\" [linkedCalendars]=\"true\"\n    [isCustomDate]=\"addCustomClass\" (datesUpdated)=\"datesUpdated($event)\" [ranges]=\"ranges\" [alwaysShowCalendars]=\"true\"\n    [keepCalendarOpeningWithRange]=\"true\" matTooltip=\"Change date range\" />\n  <mat-icon *ngIf=\"encounterError\" class=\"errorIcon\"\n    matTooltip=\"Unable to retrieve hospital visit dates for this patient. You can select any time period in the past six months.\">\n    warning</mat-icon>\n</div>"

/***/ }),

/***/ "./src/app/timeline-controller/timeline-controller.component.ts":
/*!**********************************************************************!*\
  !*** ./src/app/timeline-controller/timeline-controller.component.ts ***!
  \**********************************************************************/
/*! exports provided: TimelineControllerComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TimelineControllerComponent", function() { return TimelineControllerComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! luxon */ "./node_modules/luxon/build/cjs-browser/luxon.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(luxon__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var ngx_daterangepicker_material__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ngx-daterangepicker-material */ "./node_modules/ngx-daterangepicker-material/esm5/ngx-daterangepicker-material.js");
/* harmony import */ var src_constants__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! src/constants */ "./src/constants.ts");
/* harmony import */ var _date_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../date_utils */ "./src/app/date_utils.ts");
/* harmony import */ var _fhir_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../fhir.service */ "./src/app/fhir.service.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};







/**
 * Date range picker for selecting the time span to show in all the charts.
 *
 * There is a lot of messy date conversion in this class. The problem is that
 * we use luxon DateTime for our date handling across this application, but the
 * date range picker only works with Moment.js datetimes. The only format both
 * classes have converters for is JSDate, so we pass dates through that
 * several places.
 */
var TimelineControllerComponent = /** @class */ (function () {
    function TimelineControllerComponent(renderer, fhirService) {
        var _this = this;
        this.renderer = renderer;
        this.fhirService = fhirService;
        this.changeDateRange = new _angular_core__WEBPACK_IMPORTED_MODULE_0__["EventEmitter"]();
        /**
         * Holds all the ISO strings for days covered by all the patient encounters
         * above. Used to gray out datepicker options that are not part of
         * a patient's encounter.
         */
        this.daysCoveredByAnEncounter = new Set();
        /** Bounds the dates that may be selected. */
        this.earliestAvailableDate = moment__WEBPACK_IMPORTED_MODULE_2__["utc"](src_constants__WEBPACK_IMPORTED_MODULE_4__["APP_TIMESPAN"].start.toJSDate());
        this.latestAvailableDate = moment__WEBPACK_IMPORTED_MODULE_2__["utc"](src_constants__WEBPACK_IMPORTED_MODULE_4__["APP_TIMESPAN"].end.toJSDate());
        /** Selected timespan is past seven days by default. */
        this.defaultDateRange = {
            startDate: moment__WEBPACK_IMPORTED_MODULE_2__["utc"](luxon__WEBPACK_IMPORTED_MODULE_1__["DateTime"].utc().minus(luxon__WEBPACK_IMPORTED_MODULE_1__["Duration"].fromObject({ days: 7 })).toJSDate()),
            endDate: moment__WEBPACK_IMPORTED_MODULE_2__["utc"](luxon__WEBPACK_IMPORTED_MODULE_1__["DateTime"].utc())
        };
        /** The list of encounters to display as available ranges to select. */
        this.ranges = {};
        /**
         * Whether there was any error in retrieving the encounters for this patient.
         */
        this.encounterError = false;
        // Clearly differentiate between dates inside and outside of encounters.
        this.addCustomClass = function (m) {
            return _this.daysCoveredByAnEncounter.has(m.toISOString().slice(0, 10)) ?
                'inEncounter' :
                'notInEncounter';
        };
    }
    TimelineControllerComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.fhirService.getEncountersForPatient(src_constants__WEBPACK_IMPORTED_MODULE_4__["APP_TIMESPAN"])
            .then(function (encounters) {
            _this.encounterError = false;
            if (encounters.length > 0) {
                // Encounters come in local time.
                encounters = encounters.sort(function (a, b) {
                    return a.period.start.toMillis() - b.period.start.toMillis();
                });
                var latestEncounter = encounters[encounters.length - 1].period;
                // Make the default selection the latest encounter. It's safe to
                // not pin this to a date boundary since there should be no data
                // points that fall outside the time range of the encounter.
                // We set the time of the dates of the encounter to be 00:00.
                _this.datesUpdated({
                    startDate: moment__WEBPACK_IMPORTED_MODULE_2__(latestEncounter.start.startOf('day').toUTC().toJSDate()),
                    endDate: moment__WEBPACK_IMPORTED_MODULE_2__["utc"](latestEncounter.end.startOf('day').toUTC().toJSDate())
                });
                // Set the minimum date to select to be the beginning of the
                // earliest encounter that had days that fell inside the app
                // timespan, in UTC.
                _this.earliestAvailableDate =
                    moment__WEBPACK_IMPORTED_MODULE_2__(encounters[0]
                        .period.start.startOf('day')
                        .toUTC()
                        .toJSDate());
                // We have to store everything as an ISO string because if we
                // store as objects the set membership check doesn't work.
                _this.daysCoveredByAnEncounter = new Set(Object(_date_utils__WEBPACK_IMPORTED_MODULE_5__["getDaysForIntervalSet"])(encounters.map(function (x) { return x.period; }))
                    .map(function (x) { return x.toISO().slice(0, 10); }));
                // We manually update the ranges stored in the daterangepicker
                // so that the list of encounters is displayed.
                // We store these in local time to prevent errors with
                // displaying a date different than the dates of the encounter.
                // While being communicated with charts, the interval will be
                // converted to UTC.
                for (var _i = 0, encounters_1 = encounters; _i < encounters_1.length; _i++) {
                    var encounter = encounters_1[_i];
                    var start = moment__WEBPACK_IMPORTED_MODULE_2__(encounter.period.start.startOf('day').toJSDate());
                    var end = moment__WEBPACK_IMPORTED_MODULE_2__(encounter.period.end.startOf('day').toJSDate());
                    var label = start.format('MM/DD/YYYY') + '-' +
                        end.format('MM/DD/YYYY');
                    _this.pickerDirective.ranges[label] = [start, end];
                    _this.pickerDirective.picker.ranges[label] = [start, end];
                    _this.ranges[label] = [start, end];
                    _this.pickerDirective.picker.rangesArray.push(label);
                }
            }
            else {
                _this.datesUpdated(_this.defaultDateRange);
            }
        }, function (reject) {
            // points that fall outside the time range of the encounter.
            _this.datesUpdated(_this.defaultDateRange);
            _this.encounterError = true;
        });
    };
    /**
     * Emits the date range picked in the date picker as an event.
     * @param range The date range selected in the picker.
     */
    TimelineControllerComponent.prototype.datesUpdated = function (rangeIn) {
        if (!rangeIn.startDate || !rangeIn.endDate || !this.selected) {
            return;
        }
        if (rangeIn.startDate.isBefore(rangeIn.endDate)) {
            this.selected = rangeIn;
            // Convert to UTC time.
            var interval = luxon__WEBPACK_IMPORTED_MODULE_1__["Interval"].fromDateTimes(luxon__WEBPACK_IMPORTED_MODULE_1__["DateTime"].fromJSDate(rangeIn.startDate.toDate())
                .startOf('day')
                .toUTC(), luxon__WEBPACK_IMPORTED_MODULE_1__["DateTime"].fromJSDate(rangeIn.endDate.toDate()).endOf('day').toUTC());
            this.changeDateRange.emit(interval);
        }
    };
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Output"])(),
        __metadata("design:type", Object)
    ], TimelineControllerComponent.prototype, "changeDateRange", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ViewChild"])(ngx_daterangepicker_material__WEBPACK_IMPORTED_MODULE_3__["DaterangepickerDirective"]),
        __metadata("design:type", ngx_daterangepicker_material__WEBPACK_IMPORTED_MODULE_3__["DaterangepickerDirective"])
    ], TimelineControllerComponent.prototype, "pickerDirective", void 0);
    TimelineControllerComponent = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Component"])({
            selector: 'app-timeline-controller',
            template: __webpack_require__(/*! ./timeline-controller.component.html */ "./src/app/timeline-controller/timeline-controller.component.html"),
            styles: [__webpack_require__(/*! ./timeline-controller.component.css */ "./src/app/timeline-controller/timeline-controller.component.css")]
        }),
        __metadata("design:paramtypes", [_angular_core__WEBPACK_IMPORTED_MODULE_0__["Renderer2"], _fhir_service__WEBPACK_IMPORTED_MODULE_6__["FhirService"]])
    ], TimelineControllerComponent);
    return TimelineControllerComponent;
}());



/***/ }),

/***/ "./src/app/timeline-toolbar/timeline-toolbar.component.html":
/*!******************************************************************!*\
  !*** ./src/app/timeline-toolbar/timeline-toolbar.component.html ***!
  \******************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<div style=\"float: right; margin-right: 15px\" fxLayout=\"row\">\n  <div *ngIf=\"showMockDataMessage\">This is synthesized data used for demo purposes only.</div>\n  <button mat-icon-button matTooltip=\"Launch Tutorial\">\n    <mat-icon class=\"toolbarButton\" (click)=\"openHelpDialog()\">help_outline</mat-icon>\n  </button>\n  <button mat-icon-button matTooltip=\"Save a static image of this page to a PowerChart clinical note\">\n    <mat-icon class=\"toolbarButton\" (click)=\"snapshot()\">\n      save\n    </mat-icon>\n  </button>\n</div>\n"

/***/ }),

/***/ "./src/app/timeline-toolbar/timeline-toolbar.component.ts":
/*!****************************************************************!*\
  !*** ./src/app/timeline-toolbar/timeline-toolbar.component.ts ***!
  \****************************************************************/
/*! exports provided: TimelineToolbarComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TimelineToolbarComponent", function() { return TimelineToolbarComponent; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_material__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/material */ "./node_modules/@angular/material/esm5/material.es5.js");
/* harmony import */ var _environments_environment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../environments/environment */ "./src/environments/environment.ts");
/* harmony import */ var _clinicalconcepts_resource_code_manager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../clinicalconcepts/resource-code-manager */ "./src/app/clinicalconcepts/resource-code-manager.ts");
/* harmony import */ var _help_dialog_help_dialog_component__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../help-dialog/help-dialog.component */ "./src/app/help-dialog/help-dialog.component.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};





var TimelineToolbarComponent = /** @class */ (function () {
    function TimelineToolbarComponent(resourceCodeManager, dialog) {
        this.dialog = dialog;
        this.showMockDataMessage = _environments_environment__WEBPACK_IMPORTED_MODULE_2__["environment"].useMockServer;
        this.saveSnapshot = new _angular_core__WEBPACK_IMPORTED_MODULE_0__["EventEmitter"]();
        this.addTextbox = new _angular_core__WEBPACK_IMPORTED_MODULE_0__["EventEmitter"]();
        var displayGroups = resourceCodeManager.getDisplayGroupMapping();
        this.displayGroupings = Array.from(displayGroups.entries());
    }
    // Emits an event indicating to CardContainer to save a snapshot of the page.
    TimelineToolbarComponent.prototype.snapshot = function () {
        this.saveSnapshot.emit();
    };
    // Emits an event indicating to CardContainer to add a blank textbox at the
    // top of the page.
    TimelineToolbarComponent.prototype.textbox = function () {
        this.addTextbox.emit();
    };
    TimelineToolbarComponent.prototype.openHelpDialog = function () {
        var dialogRef = this.dialog.open(_help_dialog_help_dialog_component__WEBPACK_IMPORTED_MODULE_4__["HelpDialogComponent"]);
    };
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Output"])(),
        __metadata("design:type", Object)
    ], TimelineToolbarComponent.prototype, "saveSnapshot", void 0);
    __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Output"])(),
        __metadata("design:type", Object)
    ], TimelineToolbarComponent.prototype, "addTextbox", void 0);
    TimelineToolbarComponent = __decorate([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["Component"])({
            selector: 'app-timeline-toolbar',
            template: __webpack_require__(/*! ./timeline-toolbar.component.html */ "./src/app/timeline-toolbar/timeline-toolbar.component.html"),
        }),
        __metadata("design:paramtypes", [_clinicalconcepts_resource_code_manager__WEBPACK_IMPORTED_MODULE_3__["ResourceCodeManager"], _angular_material__WEBPACK_IMPORTED_MODULE_1__["MatDialog"]])
    ], TimelineToolbarComponent);
    return TimelineToolbarComponent;
}());



/***/ }),

/***/ "./src/app/unit_utils.ts":
/*!*******************************!*\
  !*** ./src/app/unit_utils.ts ***!
  \*******************************/
/*! exports provided: fixUnitAbbreviations */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "fixUnitAbbreviations", function() { return fixUnitAbbreviations; });
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
/**
 * This function replaces abbrevations and symbols in a unit string to comply
 * with EHRA guidelines.
 * @param unit The unit string to fix abbreviations of.
 */
function fixUnitAbbreviations(unit) {
    if (unit) {
        return unit.replace('uL', 'microL')
            .replace('µ', 'micro')
            .replace('DegC', 'Deg C');
    }
    return undefined;
}


/***/ }),

/***/ "./src/constants.ts":
/*!**************************!*\
  !*** ./src/constants.ts ***!
  \**************************/
/*! exports provided: APP_TIMESPAN, FhirResourceType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "APP_TIMESPAN", function() { return APP_TIMESPAN; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FhirResourceType", function() { return FhirResourceType; });
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! luxon */ "./node_modules/luxon/build/cjs-browser/luxon.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(luxon__WEBPACK_IMPORTED_MODULE_0__);
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

/** The period of time this app will search for patient encounters in.  */
var APP_TIMESPAN = luxon__WEBPACK_IMPORTED_MODULE_0__["Interval"].fromDateTimes(luxon__WEBPACK_IMPORTED_MODULE_0__["DateTime"].utc().minus(luxon__WEBPACK_IMPORTED_MODULE_0__["Duration"].fromObject({ months: 6 })), luxon__WEBPACK_IMPORTED_MODULE_0__["DateTime"].utc());
/** Constants used for FHIR resource types. */
var FhirResourceType;
(function (FhirResourceType) {
    FhirResourceType["Encounter"] = "Encounter";
    FhirResourceType["Observation"] = "Observation";
    FhirResourceType["MedicationAdministration"] = "MedicationAdministration";
    FhirResourceType["MedicationOrder"] = "MedicationOrder";
    FhirResourceType["DocumentReference"] = "DocumentReference";
    FhirResourceType["Patient"] = "Patient";
    FhirResourceType["Specimen"] = "Specimen";
    FhirResourceType["Medication"] = "Medication";
    FhirResourceType["DiagnosticReport"] = "DiagnosticReport";
})(FhirResourceType || (FhirResourceType = {}));


/***/ }),

/***/ "./src/environments/environment.ts":
/*!*****************************************!*\
  !*** ./src/environments/environment.ts ***!
  \*****************************************/
/*! exports provided: environment */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "environment", function() { return environment; });
/* harmony import */ var zone_js_dist_zone_error__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zone.js/dist/zone-error */ "./node_modules/zone.js/dist/zone-error.js");
/* harmony import */ var zone_js_dist_zone_error__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(zone_js_dist_zone_error__WEBPACK_IMPORTED_MODULE_0__);
// This file can be replaced during build by using the `fileReplacements` array.
// `ng build ---prod` replaces `environment.ts` with `environment.prod.ts`.
// The list of file replacements can be found in `angular.json`.
var environment = {
    production: false,
    useMockServer: true,
    mockDataFolder: 'demo_data/test_bmedtimeA',
    mockDataFiles: [
        'test_bmedtimeA_encounters', 'test_bmedtimeA_med_order',
        'test_bmedtimeA_med_st', 'test_bmedtimeA_obs_labs',
        'test_bmedtimeA_obs_vitals'
    ],
    useDebugger: false,
};
/*
 * In development mode, to ignore zone related error stack frames such as
 * `zone.run`, `zoneDelegate.invokeTask` for easier debugging, you can
 * import the following file, but please comment it out in production mode
 * because it will have performance impact when throw error
 */
 // Included with Angular CLI.


/***/ }),

/***/ "./src/main.ts":
/*!*********************!*\
  !*** ./src/main.ts ***!
  \*********************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_platform_browser_dynamic__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/platform-browser-dynamic */ "./node_modules/@angular/platform-browser-dynamic/fesm5/platform-browser-dynamic.js");
/* harmony import */ var _app_app_module__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./app/app.module */ "./src/app/app.module.ts");
/* harmony import */ var _environments_environment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./environments/environment */ "./src/environments/environment.ts");
// Copyright 2018 Verily Life Sciences Inc.
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.




if (_environments_environment__WEBPACK_IMPORTED_MODULE_3__["environment"].production) {
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["enableProdMode"])();
}
Object(_angular_platform_browser_dynamic__WEBPACK_IMPORTED_MODULE_1__["platformBrowserDynamic"])().bootstrapModule(_app_app_module__WEBPACK_IMPORTED_MODULE_2__["AppModule"]).catch(function (err) { return console.log(err); });


/***/ }),

/***/ 0:
/*!***************************!*\
  !*** multi ./src/main.ts ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(/*! /usr/local/google/home/laurendukes/xaxis/bch/medtimeline/src/main.ts */"./src/main.ts");


/***/ })

},[[0,"runtime","vendor"]]]);
//# sourceMappingURL=main.js.map